<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CompositionLocal æ·±åº¦è§£æï¼šCompose ä¸­çš„éšå¼ä¾èµ–ä¼ é€’ - Fidroid</title>
    <meta name="description" content="æ·±å…¥ç†è§£ CompositionLocal çš„å·¥ä½œåŸç†ï¼ŒæŒæ¡ staticCompositionLocalOf å’Œ compositionLocalOf çš„ä½¿ç”¨åœºæ™¯ï¼Œæ„å»ºè‡ªå®šä¹‰ä¸»é¢˜ç³»ç»Ÿã€‚">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            line-height: 1.8;
            color: #e5e7eb;
            background: #020617;
        }
        .navbar {
            background: rgba(15,23,42,0.98);
            backdrop-filter: blur(10px);
            position: fixed;
            top: 0;
            width: 100%;
            z-index: 1000;
        }
        .nav-container {
            max-width: 900px;
            margin: 0 auto;
            padding: 1rem 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .logo {
            font-size: 1.5rem;
            font-weight: bold;
            color: #38bdf8;
            text-decoration: none;
            letter-spacing: 0.08em;
            text-transform: uppercase;
        }
        .back-link { color: #9ca3af; text-decoration: none; font-size: 0.9rem; }
        .back-link:hover { color: #38bdf8; }

        .article-header {
            padding: 120px 20px 60px;
            background: radial-gradient(circle at top left, #a855f7 0, transparent 50%),
                        radial-gradient(circle at bottom right, #06b6d4 0, transparent 55%),
                        #020617;
            text-align: center;
        }
        .article-header h1 {
            max-width: 800px;
            margin: 0 auto 1rem;
            font-size: 2.5rem;
            font-weight: 800;
            letter-spacing: -0.03em;
            color: #fff;
        }
        .article-meta { color: #9ca3af; font-size: 0.9rem; margin-bottom: 1.5rem; }
        .article-tags { display: flex; justify-content: center; flex-wrap: wrap; gap: 0.5rem; }
        .article-tag {
            padding: 0.25rem 0.75rem;
            border-radius: 999px;
            font-size: 0.75rem;
            background: rgba(15,23,42,0.85);
            border: 1px solid rgba(168,85,247,0.4);
            color: #c084fc;
        }

        .article-content {
            max-width: 800px;
            margin: 0 auto;
            padding: 60px 20px 80px;
        }
        .article-content h2 {
            font-size: 1.6rem;
            margin: 2.5rem 0 1rem;
            color: #f9fafb;
            border-left: 4px solid #a855f7;
            padding-left: 1rem;
        }
        .article-content h3 { font-size: 1.25rem; margin: 2rem 0 0.75rem; color: #e5e7eb; }
        .article-content p { margin-bottom: 1.25rem; color: #d1d5db; }
        .article-content ul, .article-content ol { margin: 1rem 0 1.5rem 1.5rem; color: #d1d5db; }
        .article-content li { margin-bottom: 0.5rem; }
        .article-content strong { color: #f9fafb; }
        .article-content a { color: #38bdf8; text-decoration: underline; }

        pre {
            background: #0f172a;
            border: 1px solid rgba(168,85,247,0.3);
            border-radius: 12px;
            padding: 1.25rem;
            overflow-x: auto;
            margin: 1.5rem 0;
            font-size: 0.85rem;
            line-height: 1.6;
        }
        code { font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, monospace; color: #e5e7eb; }
        .code-keyword { color: #c084fc; }
        .code-func { color: #38bdf8; }
        .code-type { color: #4ade80; }
        .code-string { color: #fb7185; }
        .code-comment { color: #6b7280; font-style: italic; }
        .code-number { color: #fbbf24; }

        .callout {
            background: rgba(168,85,247,0.1);
            border: 1px solid rgba(168,85,247,0.3);
            border-radius: 12px;
            padding: 1.25rem 1.5rem;
            margin: 1.5rem 0;
        }
        .callout-title { font-weight: 600; color: #c084fc; margin-bottom: 0.5rem; }
        .callout p { margin-bottom: 0; color: #d1d5db; }

        .comparison-table { width: 100%; border-collapse: collapse; margin: 1.5rem 0; font-size: 0.9rem; }
        .comparison-table th, .comparison-table td { border: 1px solid rgba(148,163,184,0.3); padding: 0.75rem 1rem; text-align: left; }
        .comparison-table th { background: rgba(15,23,42,0.8); color: #f9fafb; }
        .comparison-table td { color: #d1d5db; }

        .footer {
            background: #020617;
            border-top: 1px solid #111827;
            padding: 2rem;
            text-align: center;
            color: #6b7280;
        }
        .footer a { color: #38bdf8; text-decoration: none; }
    </style>
</head>
<body>
    <nav class="navbar">
        <div class="nav-container">
            <a href="../index.html" class="logo">Fidroid</a>
            <a href="../index.html#articles" class="back-link">â† è¿”å›åšå®¢åˆ—è¡¨</a>
        </div>
    </nav>

    <header class="article-header">
        <h1>CompositionLocal æ·±åº¦è§£æï¼šCompose ä¸­çš„éšå¼ä¾èµ–ä¼ é€’</h1>
        <p class="article-meta">2024-05-10 Â· 24 min Â· ä¾èµ–æ³¨å…¥</p>
        <div class="article-tags">
            <span class="article-tag">CompositionLocal</span>
            <span class="article-tag">ä¾èµ–æ³¨å…¥</span>
            <span class="article-tag">Theme</span>
            <span class="article-tag">Provider</span>
        </div>
    </header>

    <article class="article-content">
        <p>åœ¨ Compose ä¸­ï¼Œæ•°æ®é€šå¸¸é€šè¿‡å‚æ•°æ˜¾å¼ä¼ é€’ã€‚ä½†æœ‰äº›æ•°æ®ï¼ˆå¦‚ä¸»é¢˜ã€è¯­è¨€ç¯å¢ƒã€å¯¼èˆªæ§åˆ¶å™¨ï¼‰éœ€è¦åœ¨æ•´ä¸ªç»„ä»¶æ ‘ä¸­å…±äº«ï¼Œé€å±‚ä¼ é€’ä¼šéå¸¸ç¹çã€‚<code>CompositionLocal</code> æä¾›äº†ä¸€ç§éšå¼ä¼ é€’æ•°æ®çš„æœºåˆ¶ï¼Œè®©æ·±å±‚ç»„ä»¶å¯ä»¥ç›´æ¥è®¿é—®ç¥–å…ˆæä¾›çš„æ•°æ®ã€‚</p>

        <h2>ä¸€ã€ä»€ä¹ˆæ˜¯ CompositionLocalï¼Ÿ</h2>
        <p><code>CompositionLocal</code> æ˜¯ Compose ä¸­çš„<strong>éšå¼æ•°æ®ä¼ é€’æœºåˆ¶</strong>ï¼Œç±»ä¼¼äº React çš„ Context æˆ–ä¾èµ–æ³¨å…¥æ¡†æ¶çš„ä½œç”¨åŸŸã€‚</p>

<pre><code><span class="code-comment">// ä¸ä½¿ç”¨ CompositionLocalï¼šéœ€è¦å±‚å±‚ä¼ é€’</span>
<span class="code-keyword">@Composable</span>
<span class="code-keyword">fun</span> <span class="code-func">App</span>(theme: <span class="code-type">AppTheme</span>) {
    <span class="code-func">Screen</span>(theme = theme)
}

<span class="code-keyword">@Composable</span>
<span class="code-keyword">fun</span> <span class="code-func">Screen</span>(theme: <span class="code-type">AppTheme</span>) {
    <span class="code-func">Card</span>(theme = theme)
}

<span class="code-keyword">@Composable</span>
<span class="code-keyword">fun</span> <span class="code-func">Card</span>(theme: <span class="code-type">AppTheme</span>) {
    <span class="code-func">Text</span>(color = theme.textColor, ...)  <span class="code-comment">// ç»ˆäºç”¨åˆ°äº†ï¼</span>
}

<span class="code-comment">// ä½¿ç”¨ CompositionLocalï¼šç›´æ¥è·å–</span>
<span class="code-keyword">@Composable</span>
<span class="code-keyword">fun</span> <span class="code-func">Card</span>() {
    <span class="code-keyword">val</span> theme = LocalAppTheme.current
    <span class="code-func">Text</span>(color = theme.textColor, ...)
}</code></pre>

        <h2>äºŒã€å†…ç½®çš„ CompositionLocal</h2>
        <p>Compose æä¾›äº†è®¸å¤šå†…ç½®çš„ CompositionLocalï¼š</p>

        <table class="comparison-table">
            <thead>
                <tr>
                    <th>CompositionLocal</th>
                    <th>ç±»å‹</th>
                    <th>ç”¨é€”</th>
                </tr>
            </thead>
            <tbody>
                <tr><td><code>LocalContext</code></td><td>Context</td><td>Android Context</td></tr>
                <tr><td><code>LocalConfiguration</code></td><td>Configuration</td><td>è®¾å¤‡é…ç½®</td></tr>
                <tr><td><code>LocalDensity</code></td><td>Density</td><td>åƒç´ å¯†åº¦ï¼Œdp/px è½¬æ¢</td></tr>
                <tr><td><code>LocalLayoutDirection</code></td><td>LayoutDirection</td><td>å¸ƒå±€æ–¹å‘ï¼ˆLTR/RTLï¼‰</td></tr>
                <tr><td><code>LocalLifecycleOwner</code></td><td>LifecycleOwner</td><td>ç”Ÿå‘½å‘¨æœŸæ‰€æœ‰è€…</td></tr>
                <tr><td><code>LocalContentColor</code></td><td>Color</td><td>å½“å‰å†…å®¹é¢œè‰²</td></tr>
            </tbody>
        </table>

        <h3>ä½¿ç”¨å†…ç½® CompositionLocal</h3>

<pre><code><span class="code-keyword">@Composable</span>
<span class="code-keyword">fun</span> <span class="code-func">DeviceInfo</span>() {
    <span class="code-keyword">val</span> context = LocalContext.current
    <span class="code-keyword">val</span> configuration = LocalConfiguration.current
    <span class="code-keyword">val</span> density = LocalDensity.current

    <span class="code-func">Column</span> {
        <span class="code-func">Text</span>(<span class="code-string">"å±å¹•å®½åº¦: ${configuration.screenWidthDp}dp"</span>)
        <span class="code-func">Text</span>(<span class="code-string">"åƒç´ å¯†åº¦: ${density.density}"</span>)
        
        <span class="code-comment">// dp è½¬ px</span>
        <span class="code-keyword">val</span> paddingPx = <span class="code-func">with</span>(density) { <span class="code-number">16</span>.dp.<span class="code-func">toPx</span>() }
        <span class="code-func">Text</span>(<span class="code-string">"16dp = ${paddingPx}px"</span>)
    }
}</code></pre>

        <h2>ä¸‰ã€åˆ›å»ºè‡ªå®šä¹‰ CompositionLocal</h2>

        <h3>staticCompositionLocalOf vs compositionLocalOf</h3>
        <p>Compose æä¾›ä¸¤ç§åˆ›å»ºæ–¹å¼ï¼š</p>

<pre><code><span class="code-comment">// 1. staticCompositionLocalOfï¼šå€¼å¾ˆå°‘å˜åŒ–æ—¶ä½¿ç”¨</span>
<span class="code-comment">// å€¼å˜åŒ–æ—¶ï¼Œæ•´ä¸ªä½¿ç”¨è¯¥å€¼çš„å­æ ‘éƒ½ä¼šé‡ç»„</span>
<span class="code-keyword">val</span> LocalAppConfig = <span class="code-func">staticCompositionLocalOf</span>&lt;<span class="code-type">AppConfig</span>&gt; {
    <span class="code-func">error</span>(<span class="code-string">"No AppConfig provided"</span>)
}

<span class="code-comment">// 2. compositionLocalOfï¼šå€¼å¯èƒ½é¢‘ç¹å˜åŒ–æ—¶ä½¿ç”¨</span>
<span class="code-comment">// å€¼å˜åŒ–æ—¶ï¼Œåªæœ‰è¯»å–è¯¥å€¼çš„ Composable é‡ç»„</span>
<span class="code-keyword">val</span> LocalUserPreferences = <span class="code-func">compositionLocalOf</span>&lt;<span class="code-type">UserPreferences</span>&gt; {
    <span class="code-func">UserPreferences</span>()  <span class="code-comment">// é»˜è®¤å€¼</span>
}</code></pre>

        <div class="callout">
            <p class="callout-title">ğŸ’¡ å¦‚ä½•é€‰æ‹©ï¼Ÿ</p>
            <p><strong>staticCompositionLocalOf</strong>ï¼šä¸»é¢˜ã€é…ç½®ç­‰å¾ˆå°‘å˜åŒ–çš„æ•°æ®<br>
            <strong>compositionLocalOf</strong>ï¼šç”¨æˆ·åå¥½ã€åŠ¨æ€è®¾ç½®ç­‰å¯èƒ½å˜åŒ–çš„æ•°æ®</p>
        </div>

        <h3>å®Œæ•´ç¤ºä¾‹ï¼šè‡ªå®šä¹‰ä¸»é¢˜ç³»ç»Ÿ</h3>

<pre><code><span class="code-comment">// 1. å®šä¹‰æ•°æ®ç±»</span>
<span class="code-keyword">@Immutable</span>
<span class="code-keyword">data class</span> <span class="code-type">CustomColors</span>(
    <span class="code-keyword">val</span> primary: <span class="code-type">Color</span>,
    <span class="code-keyword">val</span> secondary: <span class="code-type">Color</span>,
    <span class="code-keyword">val</span> background: <span class="code-type">Color</span>,
    <span class="code-keyword">val</span> onBackground: <span class="code-type">Color</span>
)

<span class="code-comment">// 2. åˆ›å»º CompositionLocal</span>
<span class="code-keyword">val</span> LocalCustomColors = <span class="code-func">staticCompositionLocalOf</span>&lt;<span class="code-type">CustomColors</span>&gt; {
    <span class="code-func">error</span>(<span class="code-string">"No CustomColors provided"</span>)
}

<span class="code-comment">// 3. åˆ›å»ºä¾¿æ·è®¿é—®å¯¹è±¡</span>
<span class="code-keyword">object</span> <span class="code-type">CustomTheme</span> {
    <span class="code-keyword">val</span> colors: <span class="code-type">CustomColors</span>
        <span class="code-keyword">@Composable</span>
        <span class="code-keyword">@ReadOnlyComposable</span>
        <span class="code-keyword">get</span>() = LocalCustomColors.current
}

<span class="code-comment">// 4. åˆ›å»ºä¸»é¢˜ Provider</span>
<span class="code-keyword">@Composable</span>
<span class="code-keyword">fun</span> <span class="code-func">CustomTheme</span>(
    darkTheme: <span class="code-type">Boolean</span> = <span class="code-func">isSystemInDarkTheme</span>(),
    content: <span class="code-keyword">@Composable</span> () -> <span class="code-type">Unit</span>
) {
    <span class="code-keyword">val</span> colors = <span class="code-keyword">if</span> (darkTheme) darkColors <span class="code-keyword">else</span> lightColors

    <span class="code-func">CompositionLocalProvider</span>(
        LocalCustomColors <span class="code-keyword">provides</span> colors
    ) {
        <span class="code-func">content</span>()
    }
}

<span class="code-comment">// 5. ä½¿ç”¨è‡ªå®šä¹‰ä¸»é¢˜</span>
<span class="code-keyword">@Composable</span>
<span class="code-keyword">fun</span> <span class="code-func">ThemedCard</span>(title: <span class="code-type">String</span>) {
    <span class="code-func">Card</span>(backgroundColor = CustomTheme.colors.surface) {
        <span class="code-func">Text</span>(
            text = title,
            color = CustomTheme.colors.onBackground
        )
    }
}</code></pre>

        <h2>å››ã€CompositionLocalProvider çš„ä½¿ç”¨</h2>

        <h3>åµŒå¥—è¦†ç›–</h3>
        <p>å†…å±‚ Provider å¯ä»¥è¦†ç›–å¤–å±‚çš„å€¼ï¼š</p>

<pre><code><span class="code-keyword">@Composable</span>
<span class="code-keyword">fun</span> <span class="code-func">NestedProviders</span>() {
    <span class="code-func">CompositionLocalProvider</span>(LocalContentColor <span class="code-keyword">provides</span> <span class="code-type">Color</span>.Black) {
        <span class="code-func">Text</span>(<span class="code-string">"é»‘è‰²æ–‡å­—"</span>)  <span class="code-comment">// é»‘è‰²</span>
        
        <span class="code-func">CompositionLocalProvider</span>(LocalContentColor <span class="code-keyword">provides</span> <span class="code-type">Color</span>.Red) {
            <span class="code-func">Text</span>(<span class="code-string">"çº¢è‰²æ–‡å­—"</span>)  <span class="code-comment">// çº¢è‰²ï¼ˆè¦†ç›–å¤–å±‚ï¼‰</span>
        }
        
        <span class="code-func">Text</span>(<span class="code-string">"è¿˜æ˜¯é»‘è‰²"</span>)  <span class="code-comment">// é»‘è‰²</span>
    }
}</code></pre>

        <h2>äº”ã€æ€§èƒ½è€ƒé‡</h2>

        <h3>staticCompositionLocalOf çš„é‡ç»„èŒƒå›´</h3>

<pre><code><span class="code-keyword">val</span> LocalCounter = <span class="code-func">staticCompositionLocalOf</span> { <span class="code-number">0</span> }

<span class="code-keyword">@Composable</span>
<span class="code-keyword">fun</span> <span class="code-func">Parent</span>() {
    <span class="code-keyword">var</span> counter <span class="code-keyword">by</span> <span class="code-func">remember</span> { <span class="code-func">mutableStateOf</span>(<span class="code-number">0</span>) }

    <span class="code-func">CompositionLocalProvider</span>(LocalCounter <span class="code-keyword">provides</span> counter) {
        <span class="code-comment">// counter å˜åŒ–æ—¶ï¼Œæ•´ä¸ª Child å­æ ‘éƒ½ä¼šé‡ç»„ï¼</span>
        <span class="code-func">Child</span>()
    }
}</code></pre>

        <h3>compositionLocalOf çš„ç²¾ç¡®é‡ç»„</h3>

<pre><code><span class="code-keyword">val</span> LocalCounter = <span class="code-func">compositionLocalOf</span> { <span class="code-number">0</span> }

<span class="code-keyword">@Composable</span>
<span class="code-keyword">fun</span> <span class="code-func">Child</span>() {
    <span class="code-comment">// ä¸è¯»å– LocalCounterï¼Œä¸ä¼šé‡ç»„</span>
    <span class="code-func">ExpensiveComponent</span>()
    
    <span class="code-comment">// åªæœ‰è¿™é‡Œé‡ç»„</span>
    <span class="code-func">CounterDisplay</span>()
}

<span class="code-keyword">@Composable</span>
<span class="code-keyword">fun</span> <span class="code-func">CounterDisplay</span>() {
    <span class="code-func">Text</span>(<span class="code-string">"Counter: ${LocalCounter.current}"</span>)  <span class="code-comment">// åªæœ‰è¿™ä¸ªé‡ç»„</span>
}</code></pre>

        <h2>å…­ã€å¸¸è§ä½¿ç”¨åœºæ™¯</h2>

        <h3>1. å¯¼èˆªæ§åˆ¶å™¨</h3>

<pre><code><span class="code-keyword">val</span> LocalNavController = <span class="code-func">staticCompositionLocalOf</span>&lt;<span class="code-type">NavHostController</span>&gt; {
    <span class="code-func">error</span>(<span class="code-string">"No NavController provided"</span>)
}

<span class="code-keyword">@Composable</span>
<span class="code-keyword">fun</span> <span class="code-func">DeepNestedButton</span>() {
    <span class="code-keyword">val</span> navController = LocalNavController.current
    
    <span class="code-func">Button</span>(onClick = { navController.<span class="code-func">navigate</span>(<span class="code-string">"detail/123"</span>) }) {
        <span class="code-func">Text</span>(<span class="code-string">"æŸ¥çœ‹è¯¦æƒ…"</span>)
    }
}</code></pre>

        <h3>2. ç”¨æˆ·ä¼šè¯</h3>

<pre><code><span class="code-keyword">@Immutable</span>
<span class="code-keyword">data class</span> <span class="code-type">UserSession</span>(
    <span class="code-keyword">val</span> userId: <span class="code-type">String</span>?,
    <span class="code-keyword">val</span> isLoggedIn: <span class="code-type">Boolean</span>,
    <span class="code-keyword">val</span> permissions: <span class="code-type">Set</span>&lt;<span class="code-type">Permission</span>&gt;
)

<span class="code-keyword">val</span> LocalUserSession = <span class="code-func">compositionLocalOf</span> {
    <span class="code-func">UserSession</span>(<span class="code-keyword">null</span>, <span class="code-keyword">false</span>, <span class="code-func">emptySet</span>())
}</code></pre>

        <h2>ä¸ƒã€CompositionLocal vs å…¶ä»–æ–¹æ¡ˆ</h2>

        <table class="comparison-table">
            <thead>
                <tr>
                    <th>æ–¹æ¡ˆ</th>
                    <th>é€‚ç”¨åœºæ™¯</th>
                    <th>ä¼˜ç‚¹</th>
                    <th>ç¼ºç‚¹</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><strong>å‚æ•°ä¼ é€’</strong></td>
                    <td>å°‘é‡å±‚çº§ã€æ˜ç¡®ä¾èµ–</td>
                    <td>æ˜¾å¼ã€æ˜“è¿½è¸ª</td>
                    <td>å±‚çº§å¤šæ—¶ç¹ç</td>
                </tr>
                <tr>
                    <td><strong>CompositionLocal</strong></td>
                    <td>è·¨å¤šå±‚çº§çš„å…±äº«æ•°æ®</td>
                    <td>ç®€æ´ã€è‡ªåŠ¨ä¼ é€’</td>
                    <td>éšå¼ä¾èµ–ã€éš¾è¿½è¸ª</td>
                </tr>
                <tr>
                    <td><strong>ViewModel</strong></td>
                    <td>å±å¹•çº§çŠ¶æ€ã€ä¸šåŠ¡é€»è¾‘</td>
                    <td>ç”Ÿå‘½å‘¨æœŸæ„ŸçŸ¥</td>
                    <td>éœ€è¦ Hilt ç­‰ DI</td>
                </tr>
            </tbody>
        </table>

        <h2>å…«ã€å¸¸è§é™·é˜±</h2>

        <h3>1. å¿˜è®°æä¾› Provider</h3>

<pre><code><span class="code-comment">// âŒ æ²¡æœ‰é»˜è®¤å€¼ï¼Œä¹Ÿæ²¡æœ‰ Providerï¼Œè¿è¡Œæ—¶å´©æºƒ</span>
<span class="code-keyword">val</span> LocalData = <span class="code-func">staticCompositionLocalOf</span>&lt;<span class="code-type">Data</span>&gt; {
    <span class="code-func">error</span>(<span class="code-string">"No Data provided"</span>)
}

<span class="code-keyword">@Composable</span>
<span class="code-keyword">fun</span> <span class="code-func">Child</span>() {
    <span class="code-keyword">val</span> data = LocalData.current  <span class="code-comment">// ğŸ’¥ å´©æºƒï¼</span>
}

<span class="code-comment">// âœ… ç¡®ä¿æœ‰ Provider</span>
<span class="code-keyword">@Composable</span>
<span class="code-keyword">fun</span> <span class="code-func">App</span>() {
    <span class="code-func">CompositionLocalProvider</span>(LocalData <span class="code-keyword">provides</span> <span class="code-func">Data</span>()) {
        <span class="code-func">Child</span>()
    }
}</code></pre>

        <h3>2. è¿‡åº¦ä½¿ç”¨ CompositionLocal</h3>

<pre><code><span class="code-comment">// âŒ æ‰€æœ‰æ•°æ®éƒ½ç”¨ CompositionLocal</span>
<span class="code-keyword">val</span> LocalUserName = <span class="code-func">compositionLocalOf</span> { <span class="code-string">""</span> }
<span class="code-keyword">val</span> LocalUserAge = <span class="code-func">compositionLocalOf</span> { <span class="code-number">0</span> }

<span class="code-comment">// âœ… ç»„åˆæˆä¸€ä¸ªæ•°æ®ç±»</span>
<span class="code-keyword">@Immutable</span>
<span class="code-keyword">data class</span> <span class="code-type">User</span>(<span class="code-keyword">val</span> name: <span class="code-type">String</span>, <span class="code-keyword">val</span> age: <span class="code-type">Int</span>)
<span class="code-keyword">val</span> LocalUser = <span class="code-func">compositionLocalOf</span>&lt;<span class="code-type">User</span>?&gt; { <span class="code-keyword">null</span> }</code></pre>

        <h2>æ€»ç»“</h2>
        <p>CompositionLocal çš„æ ¸å¿ƒè¦ç‚¹ï¼š</p>
        <ul>
            <li><strong>ç”¨é€”</strong>ï¼šè·¨ç»„ä»¶æ ‘ä¼ é€’å…±äº«æ•°æ®ï¼Œé¿å…å±‚å±‚ä¼ å‚</li>
            <li><strong>staticCompositionLocalOf</strong>ï¼šå€¼å¾ˆå°‘å˜åŒ–ï¼Œå¦‚ä¸»é¢˜ã€é…ç½®</li>
            <li><strong>compositionLocalOf</strong>ï¼šå€¼å¯èƒ½å˜åŒ–ï¼Œéœ€è¦ç²¾ç¡®é‡ç»„æ§åˆ¶</li>
            <li><strong>CompositionLocalProvider</strong>ï¼šæä¾›å€¼ï¼Œæ”¯æŒåµŒå¥—è¦†ç›–</li>
            <li><strong>æ€§èƒ½</strong>ï¼šæ³¨æ„é€‰æ‹©åˆé€‚çš„ç±»å‹ï¼Œé¿å…ä¸å¿…è¦çš„é‡ç»„</li>
            <li><strong>é€‚åº¦ä½¿ç”¨</strong>ï¼šåªç”¨äºçœŸæ­£éœ€è¦è·¨å±‚çº§å…±äº«çš„æ•°æ®</li>
        </ul>
    </article>

    <footer class="footer">
        <p>&copy; 2024 Fidroid. <a href="../index.html">è¿”å›é¦–é¡µ</a></p>
    </footer>
</body>
</html>



