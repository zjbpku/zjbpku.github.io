<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RemoteCompose å®Œæ•´ä½¿ç”¨æŒ‡å—ï¼šä»å…¥é—¨åˆ°å®æˆ˜ - Fidroid</title>
    <meta name="description" content="è¶…è¯¦ç»†çš„ RemoteCompose ä½¿ç”¨æ•™ç¨‹ï¼Œæ¶µç›–ç¯å¢ƒé…ç½®ã€API è¯¦è§£ã€æ–‡æ¡£åˆ›å»ºã€æ’­æ”¾å™¨ä½¿ç”¨ã€äº¤äº’å¤„ç†ã€å®Œæ•´ç¤ºä¾‹é¡¹ç›®ç­‰ï¼ŒåŠ©ä½ å¿«é€ŸæŒæ¡ RemoteCompose å¼€å‘ã€‚">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            line-height: 1.8;
            color: #e5e7eb;
            background: #020617;
        }
        .navbar {
            background: rgba(15,23,42,0.98);
            backdrop-filter: blur(10px);
            position: fixed;
            top: 0;
            width: 100%;
            z-index: 1000;
        }
        .nav-container {
            max-width: 900px;
            margin: 0 auto;
            padding: 1rem 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .logo {
            font-size: 1.5rem;
            font-weight: bold;
            color: #38bdf8;
            text-decoration: none;
            letter-spacing: 0.08em;
            text-transform: uppercase;
        }
        .back-link { color: #9ca3af; text-decoration: none; font-size: 0.9rem; }
        .back-link:hover { color: #38bdf8; }

        .article-header {
            padding: 120px 20px 60px;
            background: radial-gradient(circle at top left, #06b6d4 0, transparent 50%),
                        radial-gradient(circle at bottom right, #f59e0b 0, transparent 55%),
                        #020617;
            text-align: center;
        }
        .article-header h1 {
            max-width: 800px;
            margin: 0 auto 1rem;
            font-size: 2.5rem;
            font-weight: 800;
            letter-spacing: -0.03em;
            color: #fff;
        }
        .article-meta { color: #9ca3af; font-size: 0.9rem; margin-bottom: 1.5rem; }
        .article-tags { display: flex; justify-content: center; flex-wrap: wrap; gap: 0.5rem; }
        .article-tag {
            padding: 0.25rem 0.75rem;
            border-radius: 999px;
            font-size: 0.75rem;
            background: rgba(15,23,42,0.85);
            border: 1px solid rgba(6,182,212,0.4);
            color: #67e8f9;
        }

        .article-content {
            max-width: 900px;
            margin: 0 auto;
            padding: 60px 20px 80px;
        }
        .article-content h2 {
            font-size: 1.6rem;
            margin: 2.5rem 0 1rem;
            color: #f9fafb;
            border-left: 4px solid #06b6d4;
            padding-left: 1rem;
        }
        .article-content h3 { font-size: 1.25rem; margin: 2rem 0 0.75rem; color: #e5e7eb; }
        .article-content h4 { font-size: 1.1rem; margin: 1.5rem 0 0.75rem; color: #d1d5db; }
        .article-content p { margin-bottom: 1.25rem; color: #d1d5db; }
        .article-content ul, .article-content ol { margin: 1rem 0 1.5rem 1.5rem; color: #d1d5db; }
        .article-content li { margin-bottom: 0.5rem; }
        .article-content strong { color: #f9fafb; }
        .article-content a { color: #38bdf8; text-decoration: underline; }

        pre {
            background: #0f172a;
            border: 1px solid rgba(6,182,212,0.3);
            border-radius: 12px;
            padding: 1.25rem;
            overflow-x: auto;
            margin: 1.5rem 0;
            font-size: 0.85rem;
            line-height: 1.6;
        }
        code { font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, monospace; color: #e5e7eb; }
        .code-keyword { color: #c084fc; }
        .code-func { color: #38bdf8; }
        .code-type { color: #4ade80; }
        .code-string { color: #fbbf24; }
        .code-comment { color: #6b7280; }
        .code-annotation { color: #f472b6; }

        .tip-box {
            background: rgba(6,182,212,0.1);
            border: 1px solid rgba(6,182,212,0.3);
            border-radius: 12px;
            padding: 1.25rem;
            margin: 1.5rem 0;
        }
        .tip-box.success {
            background: rgba(34,197,94,0.1);
            border-color: rgba(34,197,94,0.3);
        }
        .tip-box.warning {
            background: rgba(245,158,11,0.1);
            border-color: rgba(245,158,11,0.3);
        }
        .tip-box.error {
            background: rgba(239,68,68,0.1);
            border-color: rgba(239,68,68,0.3);
        }
        .tip-title { font-weight: 600; color: #67e8f9; margin-bottom: 0.5rem; }
        .success .tip-title { color: #4ade80; }
        .warning .tip-title { color: #fcd34d; }
        .error .tip-title { color: #fca5a5; }

        .diagram-box {
            background: #0f172a;
            border: 1px solid rgba(6,182,212,0.3);
            border-radius: 12px;
            padding: 1.5rem;
            margin: 1.5rem 0;
            font-family: ui-monospace, monospace;
            font-size: 0.8rem;
            line-height: 1.5;
            overflow-x: auto;
            white-space: pre;
            color: #9ca3af;
        }
        .diagram-highlight { color: #4ade80; }
        .diagram-accent { color: #38bdf8; }
        .diagram-warning { color: #fbbf24; }

        .step-number {
            display: inline-block;
            width: 32px;
            height: 32px;
            line-height: 32px;
            text-align: center;
            background: #06b6d4;
            color: #fff;
            border-radius: 50%;
            font-weight: bold;
            margin-right: 12px;
            vertical-align: middle;
        }

        .footer {
            background: #0f172a;
            padding: 3rem 20px;
            text-align: center;
            border-top: 1px solid rgba(6,182,212,0.2);
        }
        .footer p { color: #6b7280; font-size: 0.9rem; }
    </style>
</head>
<body>
    <nav class="navbar">
        <div class="nav-container">
            <a href="../index.html" class="logo">Fidroid</a>
            <a href="../index.html#articles" class="back-link">â† è¿”å›æ–‡ç« åˆ—è¡¨</a>
        </div>
    </nav>

    <header class="article-header">
        <h1>RemoteCompose å®Œæ•´ä½¿ç”¨æŒ‡å—ï¼šä»å…¥é—¨åˆ°å®æˆ˜</h1>
        <div class="article-meta">ğŸ“… 2024-07-10 Â· â± 45 min Â· ğŸ“š å®æˆ˜æ•™ç¨‹</div>
        <div class="article-tags">
            <span class="article-tag">RemoteCompose</span>
            <span class="article-tag">å®æˆ˜æ•™ç¨‹</span>
            <span class="article-tag">Server-Driven UI</span>
            <span class="article-tag">AndroidX</span>
        </div>
    </header>

    <article class="article-content">
        <p>æœ¬æ–‡æ˜¯ä¸€ä»½è¶…è¯¦ç»†çš„ RemoteCompose ä½¿ç”¨æŒ‡å—ï¼Œå°†å¸¦ä½ ä»é›¶å¼€å§‹ï¼Œé€æ­¥æŒæ¡ RemoteCompose çš„å¼€å‘ã€‚æˆ‘ä»¬å°†é€šè¿‡å®Œæ•´çš„ç¤ºä¾‹é¡¹ç›®ï¼Œæ·±å…¥ç†è§£æ–‡æ¡£åˆ›å»ºã€æ’­æ”¾å™¨ä½¿ç”¨ã€äº¤äº’å¤„ç†ç­‰æ ¸å¿ƒåŠŸèƒ½ã€‚</p>

        <h2>ç›®å½•</h2>
        <ol>
            <li><a href="#section-1">ç¯å¢ƒé…ç½®ä¸ä¾èµ–</a></li>
            <li><a href="#section-2">æ ¸å¿ƒæ¦‚å¿µç†è§£</a></li>
            <li><a href="#section-3">åˆ›å»ºç¬¬ä¸€ä¸ªæ–‡æ¡£</a></li>
            <li><a href="#section-4">æ’­æ”¾å™¨ä½¿ç”¨</a></li>
            <li><a href="#section-5">å¤„ç†äº¤äº’äº‹ä»¶</a></li>
            <li><a href="#section-6">å®Œæ•´ç¤ºä¾‹é¡¹ç›®</a></li>
            <li><a href="#section-7">æœ€ä½³å®è·µ</a></li>
            <li><a href="#section-8">å¸¸è§é—®é¢˜</a></li>
        </ol>

        <h2 id="section-1">I. ç¯å¢ƒé…ç½®ä¸ä¾èµ–</h2>

        <h3>1.1 é¡¹ç›®è¦æ±‚</h3>

        <ul>
            <li><strong>Android Studio</strong>ï¼šArctic Fox (2020.3.1) æˆ–æ›´é«˜ç‰ˆæœ¬</li>
            <li><strong>Kotlin</strong>ï¼š1.5.10 æˆ–æ›´é«˜ç‰ˆæœ¬</li>
            <li><strong>æœ€ä½ SDK</strong>ï¼šAPI 21 (Android 5.0)</li>
            <li><strong>ç›®æ ‡ SDK</strong>ï¼šAPI 33 æˆ–æ›´é«˜</li>
            <li><strong>Gradle</strong>ï¼š7.0 æˆ–æ›´é«˜ç‰ˆæœ¬</li>
        </ul>

        <h3>1.2 æ·»åŠ ä¾èµ–</h3>

        <p>åœ¨é¡¹ç›®çš„ <code>build.gradle.kts</code> (Module çº§åˆ«) ä¸­æ·»åŠ ä»¥ä¸‹ä¾èµ–ï¼š</p>

        <pre><code><span class="code-comment">// build.gradle.kts (Module: app)</span>

<span class="code-keyword">plugins</span> {
    id(<span class="code-string">"com.android.application"</span>)
    id(<span class="code-string">"org.jetbrains.kotlin.android"</span>)
    id(<span class="code-string">"org.jetbrains.kotlin.plugin.compose"</span>)
}

android {
    compileSdk = <span class="code-string">34</span>
    
    defaultConfig {
        applicationId = <span class="code-string">"com.example.remotecompose"</span>
        minSdk = <span class="code-string">21</span>
        targetSdk = <span class="code-string">34</span>
    }
    
    buildFeatures {
        compose = <span class="code-string">true</span>
    }
    
    composeOptions {
        kotlinCompilerExtensionVersion = <span class="code-string">"1.5.3"</span>
    }
}

<span class="code-keyword">dependencies</span> {
    <span class="code-comment">// Compose BOM (ç»Ÿä¸€ç‰ˆæœ¬ç®¡ç†)</span>
    <span class="code-keyword">val</span> composeBom = platform(<span class="code-string">"androidx.compose:compose-bom:2024.01.00"</span>)
    <span class="code-func">implementation</span>(composeBom)
    
    <span class="code-comment">// Compose åŸºç¡€åº“</span>
    <span class="code-func">implementation</span>(<span class="code-string">"androidx.compose.ui:ui"</span>)
    <span class="code-func">implementation</span>(<span class="code-string">"androidx.compose.material3:material3"</span>)
    <span class="code-func">implementation</span>(<span class="code-string">"androidx.activity:activity-compose:1.8.2"</span>)
    
    <span class="code-comment">// RemoteCompose æ ¸å¿ƒåº“</span>
    <span class="code-func">implementation</span>(<span class="code-string">"androidx.compose.remote:core:1.0.0-alpha01"</span>)
    
    <span class="code-comment">// RemoteCompose å‘é€ç«¯ (ç”¨äºåˆ›å»ºæ–‡æ¡£)</span>
    <span class="code-func">implementation</span>(<span class="code-string">"androidx.compose.remote:sender:1.0.0-alpha01"</span>)
    
    <span class="code-comment">// RemoteCompose æ’­æ”¾å™¨ (Compose åç«¯)</span>
    <span class="code-func">implementation</span>(<span class="code-string">"androidx.compose.remote:player-compose:1.0.0-alpha01"</span>)
    
    <span class="code-comment">// RemoteCompose æ’­æ”¾å™¨ (View åç«¯ï¼Œå¯é€‰)</span>
    <span class="code-comment">// implementation("androidx.compose.remote:player-view:1.0.0-alpha01")</span>
    
    <span class="code-comment">// Layout æ¨¡å— (å¯é€‰ï¼Œç”¨äºç»„ä»¶æ ‘)</span>
    <span class="code-comment">// implementation("androidx.compose.remote:layout:1.0.0-alpha01")</span>
    
    <span class="code-comment">// ç½‘ç»œåº“ (ç”¨äºä»æœåŠ¡å™¨è·å–æ–‡æ¡£)</span>
    <span class="code-func">implementation</span>(<span class="code-string">"com.squareup.retrofit2:retrofit:2.9.0"</span>)
    <span class="code-func">implementation</span>(<span class="code-string">"com.squareup.retrofit2:converter-gson:2.9.0"</span>)
    <span class="code-func">implementation</span>(<span class="code-string">"com.squareup.okhttp3:okhttp:4.12.0"</span>)
    
    <span class="code-comment">// åç¨‹</span>
    <span class="code-func">implementation</span>(<span class="code-string">"org.jetbrains.kotlinx:kotlinx-coroutines-android:1.7.3"</span>)
    
    <span class="code-comment">// ViewModel</span>
    <span class="code-func">implementation</span>(<span class="code-string">"androidx.lifecycle:lifecycle-viewmodel-compose:2.7.0"</span>)
}</code></pre>

        <div class="tip-box warning">
            <div class="tip-title">âš ï¸ ç‰ˆæœ¬è¯´æ˜</div>
            <p>RemoteCompose ç›®å‰å¤„äº Alpha é˜¶æ®µï¼Œç‰ˆæœ¬å·å¯èƒ½ä¼šé¢‘ç¹å˜åŒ–ã€‚è¯·è®¿é—® <a href="https://developer.android.com/jetpack/androidx/releases/compose" target="_blank">AndroidX Release Notes</a> è·å–æœ€æ–°ç‰ˆæœ¬ä¿¡æ¯ã€‚</p>
        </div>

        <h3>1.3 å¯ç”¨ Compose Compiler</h3>

        <p>ç¡®ä¿åœ¨ <code>build.gradle.kts</code> (Project çº§åˆ«) ä¸­é…ç½®äº† Compose Compilerï¼š</p>

        <pre><code><span class="code-comment">// build.gradle.kts (Project level)</span>

<span class="code-keyword">buildscript</span> {
    <span class="code-keyword">dependencies</span> {
        <span class="code-keyword">classpath</span>(<span class="code-string">"org.jetbrains.kotlin:kotlin-gradle-plugin:1.9.20"</span>)
    }
}</code></pre>

        <h2 id="section-2">II. æ ¸å¿ƒæ¦‚å¿µç†è§£</h2>

        <h3>2.1 RemoteCompose å·¥ä½œæµç¨‹</h3>

        <div class="diagram-box">
<span class="diagram-warning">RemoteCompose å®Œæ•´å·¥ä½œæµç¨‹</span>

<span class="diagram-highlight">1. æ–‡æ¡£åˆ›å»º (Sender ç«¯)</span>
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  @Composable å‡½æ•°                                    â”‚
â”‚       â†“                                             â”‚
â”‚  RemoteComposeSender                                â”‚
â”‚       â†“                                             â”‚
â”‚  æ•è· Canvas æ“ä½œ                                    â”‚
â”‚       â†“                                             â”‚
â”‚  ç”ŸæˆäºŒè¿›åˆ¶æ–‡æ¡£ (WireBuffer)                          â”‚
â”‚       â†“                                             â”‚
â”‚  åºåˆ—åŒ–å¹¶ä¼ è¾“                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

<span class="diagram-accent">2. æ–‡æ¡£ä¼ è¾“</span>
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  äºŒè¿›åˆ¶æ–‡æ¡£                                          â”‚
â”‚  (å¯é€šè¿‡ HTTP, WebSocket, æœ¬åœ°æ–‡ä»¶ç­‰ä¼ è¾“)              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

<span class="diagram-highlight">3. æ–‡æ¡£æ’­æ”¾ (Player ç«¯)</span>
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  æ¥æ”¶äºŒè¿›åˆ¶æ–‡æ¡£                                       â”‚
â”‚       â†“                                             â”‚
â”‚  RemoteComposePlayer                                â”‚
â”‚       â†“                                             â”‚
â”‚  è§£æ WireBuffer                                    â”‚
â”‚       â†“                                             â”‚
â”‚  åœ¨ Canvas ä¸Šæ‰§è¡Œç»˜åˆ¶æ“ä½œ                             â”‚
â”‚       â†“                                             â”‚
â”‚  æ¸²æŸ“åˆ°å±å¹•                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        </div>

        <h3>2.2 æ ¸å¿ƒ API æ¦‚è§ˆ</h3>

        <pre><code><span class="code-comment">// 1. RemoteComposeSender - æ–‡æ¡£åˆ›å»ºå™¨</span>
<span class="code-keyword">class</span> <span class="code-type">RemoteComposeSender</span> {
    <span class="code-keyword">fun</span> <span class="code-func">createDocument</span>(
        width: <span class="code-type">Float</span>,
        height: <span class="code-type">Float</span>,
        content: <span class="code-annotation">@Composable</span> () -&gt; <span class="code-type">Unit</span>
    ): <span class="code-type">RemoteComposeDocument</span>
    
    <span class="code-keyword">fun</span> <span class="code-func">encode</span>(document: <span class="code-type">RemoteComposeDocument</span>): <span class="code-type">ByteArray</span>
}

<span class="code-comment">// 2. RemoteComposePlayer - æ–‡æ¡£æ’­æ”¾å™¨</span>
<span class="code-keyword">class</span> <span class="code-type">RemoteComposePlayer</span> {
    <span class="code-keyword">fun</span> <span class="code-func">decode</span>(bytes: <span class="code-type">ByteArray</span>): <span class="code-type">RemoteComposeDocument</span>
    
    <span class="code-annotation">@Composable</span>
    <span class="code-keyword">fun</span> <span class="code-func">Play</span>(
        document: <span class="code-type">RemoteComposeDocument</span>,
        modifier: <span class="code-type">Modifier</span> = <span class="code-type">Modifier</span>,
        onSemanticAction: (<span class="code-type">SemanticAction</span>) -&gt; <span class="code-type">Unit</span> = {}
    )
}</code></pre>

        <h2 id="section-3">III. åˆ›å»ºç¬¬ä¸€ä¸ªæ–‡æ¡£</h2>

        <h3>3.1 æœ€ç®€å•çš„ç¤ºä¾‹</h3>

        <p>è®©æˆ‘ä»¬ä»æœ€ç®€å•çš„ä¾‹å­å¼€å§‹ï¼šåˆ›å»ºä¸€ä¸ªåŒ…å«æ–‡æœ¬çš„æ–‡æ¡£ã€‚</p>

        <pre><code><span class="code-keyword">import</span> androidx.compose.remote.sender.RemoteComposeSender
<span class="code-keyword">import</span> androidx.compose.foundation.layout.*
<span class="code-keyword">import</span> androidx.compose.material3.*
<span class="code-keyword">import</span> androidx.compose.runtime.*
<span class="code-keyword">import</span> androidx.compose.ui.Modifier
<span class="code-keyword">import</span> androidx.compose.ui.unit.dp

<span class="code-keyword">class</span> <span class="code-type">DocumentCreator</span> {
    <span class="code-keyword">private val</span> sender = <span class="code-type">RemoteComposeSender</span>()
    
    <span class="code-keyword">fun</span> <span class="code-func">createSimpleDocument</span>(): <span class="code-type">ByteArray</span> {
        <span class="code-comment">// 1. åˆ›å»ºæ–‡æ¡£</span>
        <span class="code-keyword">val</span> document = sender.<span class="code-func">createDocument</span>(
            width = <span class="code-string">360f</span>,  <span class="code-comment">// æ–‡æ¡£å®½åº¦ (dp)</span>
            height = <span class="code-string">640f</span>  <span class="code-comment">// æ–‡æ¡£é«˜åº¦ (dp)</span>
        ) {
            <span class="code-comment">// 2. å®šä¹‰ UI å†…å®¹</span>
            <span class="code-type">Column</span>(
                modifier = <span class="code-type">Modifier</span>
                    .<span class="code-func">fillMaxSize</span>()
                    .<span class="code-func">padding</span>(<span class="code-string">16.dp</span>),
                verticalArrangement = <span class="code-type">Arrangement</span>.Center,
                horizontalAlignment = <span class="code-type">Alignment</span>.CenterHorizontally
            ) {
                <span class="code-type">Text</span>(
                    text = <span class="code-string">"Hello, RemoteCompose!"</span>,
                    style = <span class="code-type">MaterialTheme</span>.typography.headlineLarge
                )
            }
        }
        
        <span class="code-comment">// 3. ç¼–ç ä¸ºäºŒè¿›åˆ¶</span>
        <span class="code-keyword">return</span> sender.<span class="code-func">encode</span>(document)
    }
}</code></pre>

        <h3>3.2 æ·»åŠ æŒ‰é’®å’Œäº¤äº’</h3>

        <pre><code><span class="code-keyword">fun</span> <span class="code-func">createInteractiveDocument</span>(): <span class="code-type">ByteArray</span> {
    <span class="code-keyword">val</span> document = sender.<span class="code-func">createDocument</span>(
        width = <span class="code-string">360f</span>,
        height = <span class="code-string">640f</span>
    ) {
        <span class="code-keyword">var</span> count <span class="code-keyword">by</span> <span class="code-func">remember</span> { <span class="code-func">mutableStateOf</span>(<span class="code-string">0</span>) }
        
        <span class="code-type">Column</span>(
            modifier = <span class="code-type">Modifier</span>
                .<span class="code-func">fillMaxSize</span>()
                .<span class="code-func">padding</span>(<span class="code-string">16.dp</span>),
            verticalArrangement = <span class="code-type">Arrangement</span>.Center,
            horizontalAlignment = <span class="code-type">Alignment</span>.CenterHorizontally
        ) {
            <span class="code-type">Text</span>(
                text = <span class="code-string">"Count: $count"</span>,
                style = <span class="code-type">MaterialTheme</span>.typography.headlineMedium
            )
            
            <span class="code-type">Spacer</span>(modifier = <span class="code-type">Modifier</span>.<span class="code-func">height</span>(<span class="code-string">16.dp</span>))
            
            <span class="code-type">Button</span>(
                onClick = { count++ },
                modifier = <span class="code-type">Modifier</span>.<span class="code-func">semantics</span> {
                    <span class="code-comment">// æ·»åŠ è¯­ä¹‰åŠ¨ä½œï¼Œç”¨äºå®¢æˆ·ç«¯å¤„ç†</span>
                    <span class="code-func">semanticAction</span>(
                        action = <span class="code-type">SemanticAction</span>.<span class="code-type">SendEvent</span>(
                            id = <span class="code-string">"button_click"</span>,
                            eventName = <span class="code-string">"increment"</span>,
                            payload = <span class="code-func">mapOf</span>(<span class="code-string">"current_count"</span> <span class="code-keyword">to</span> count)
                        )
                    )
                }
            ) {
                <span class="code-type">Text</span>(<span class="code-string">"Increment"</span>)
            }
        }
    }
    
    <span class="code-keyword">return</span> sender.<span class="code-func">encode</span>(document)
}</code></pre>

        <h3>3.3 ä½¿ç”¨ Modifier è‡ªå®šä¹‰æ ·å¼</h3>

        <pre><code><span class="code-keyword">fun</span> <span class="code-func">createStyledDocument</span>(): <span class="code-type">ByteArray</span> {
    <span class="code-keyword">val</span> document = sender.<span class="code-func">createDocument</span>(
        width = <span class="code-string">360f</span>,
        height = <span class="code-string">640f</span>
    ) {
        <span class="code-type">Box</span>(
            modifier = <span class="code-type">Modifier</span>
                .<span class="code-func">fillMaxSize</span>()
                .<span class="code-func">background</span>(
                    brush = <span class="code-type">Brush</span>.<span class="code-func">linearGradient</span>(
                        colors = <span class="code-func">listOf</span>(
                            <span class="code-type">Color</span>(<span class="code-string">0xFF6200EE</span>),
                            <span class="code-type">Color</span>(<span class="code-string">0xFF03DAC5</span>)
                        )
                    )
                )
        ) {
            <span class="code-type">Card</span>(
                modifier = <span class="code-type">Modifier</span>
                    .<span class="code-func">fillMaxWidth</span>()
                    .<span class="code-func">padding</span>(<span class="code-string">16.dp</span>)
                    .<span class="code-func">align</span>(<span class="code-type">Alignment</span>.Center),
                elevation = <span class="code-type">CardDefaults</span>.<span class="code-func">cardElevation</span>(<span class="code-string">8.dp</span>)
            ) {
                <span class="code-type">Column</span>(
                    modifier = <span class="code-type">Modifier</span>.<span class="code-func">padding</span>(<span class="code-string">24.dp</span>)
                ) {
                    <span class="code-type">Text</span>(
                        text = <span class="code-string">"Styled Card"</span>,
                        style = <span class="code-type">MaterialTheme</span>.typography.headlineSmall
                    )
                    <span class="code-type">Spacer</span>(modifier = <span class="code-type">Modifier</span>.<span class="code-func">height</span>(<span class="code-string">8.dp</span>))
                    <span class="code-type">Text</span>(
                        text = <span class="code-string">"This is a beautifully styled card with gradient background."</span>,
                        style = <span class="code-type">MaterialTheme</span>.typography.bodyMedium
                    )
                }
            }
        }
    }
    
    <span class="code-keyword">return</span> sender.<span class="code-func">encode</span>(document)
}</code></pre>

        <h2 id="section-4">IV. æ’­æ”¾å™¨ä½¿ç”¨</h2>

        <h3>4.1 åŸºç¡€æ’­æ”¾</h3>

        <pre><code><span class="code-keyword">import</span> androidx.compose.remote.player.RemoteComposePlayer
<span class="code-keyword">import</span> androidx.compose.foundation.layout.*
<span class="code-keyword">import</span> androidx.compose.runtime.*
<span class="code-keyword">import</span> androidx.compose.ui.Modifier

<span class="code-keyword">class</span> <span class="code-type">DocumentViewModel</span> : <span class="code-type">ViewModel</span>() {
    <span class="code-keyword">private val</span> player = <span class="code-type">RemoteComposePlayer</span>()
    
    <span class="code-keyword">private val</span> _document = <span class="code-type">MutableStateFlow</span>&lt;<span class="code-type">RemoteComposeDocument</span>?&gt;(<span class="code-keyword">null</span>)
    <span class="code-keyword">val</span> document: <span class="code-type">StateFlow</span>&lt;<span class="code-type">RemoteComposeDocument</span>?&gt; = _document
    
    <span class="code-keyword">fun</span> <span class="code-func">loadDocument</span>(bytes: <span class="code-type">ByteArray</span>) {
        <span class="code-keyword">try</span> {
            <span class="code-keyword">val</span> doc = player.<span class="code-func">decode</span>(bytes)
            _document.<span class="code-func">value</span> = doc
        } <span class="code-keyword">catch</span> (e: <span class="code-type">Exception</span>) {
            <span class="code-comment">// å¤„ç†è§£ç é”™è¯¯</span>
            <span class="code-func">Log</span>.e(<span class="code-string">"DocumentViewModel"</span>, <span class="code-string">"Failed to decode document"</span>, e)
        }
    }
}

<span class="code-annotation">@Composable</span>
<span class="code-keyword">fun</span> <span class="code-func">RemoteComposeScreen</span>(
    viewModel: <span class="code-type">DocumentViewModel</span> = <span class="code-func">viewModel</span>()
) {
    <span class="code-keyword">val</span> document <span class="code-keyword">by</span> viewModel.document.<span class="code-func">collectAsState</span>()
    <span class="code-keyword">val</span> player = <span class="code-func">remember</span> { <span class="code-type">RemoteComposePlayer</span>() }
    
    <span class="code-type">Scaffold</span> { padding -&gt;
        <span class="code-type">Box</span>(
            modifier = <span class="code-type">Modifier</span>
                .<span class="code-func">fillMaxSize</span>()
                .<span class="code-func">padding</span>(padding)
        ) {
            document?.<span class="code-func">let</span> { doc -&gt;
                <span class="code-comment">// æ’­æ”¾æ–‡æ¡£</span>
                player.<span class="code-func">Play</span>(
                    document = doc,
                    modifier = <span class="code-type">Modifier</span>.<span class="code-func">fillMaxSize</span>()
                )
            } ?: <span class="code-type">CircularProgressIndicator</span>(
                modifier = <span class="code-type">Modifier</span>.<span class="code-func">align</span>(<span class="code-type">Alignment</span>.Center)
            )
        }
    }
}</code></pre>

        <h3>4.2 ä»ç½‘ç»œåŠ è½½æ–‡æ¡£</h3>

        <pre><code><span class="code-keyword">interface</span> <span class="code-type">RemoteComposeApi</span> {
    <span class="code-annotation">@GET</span>(<span class="code-string">"api/document/{id}"</span>)
    <span class="code-keyword">suspend fun</span> <span class="code-func">getDocument</span>(<span class="code-annotation">@Path</span>(<span class="code-string">"id"</span>) id: <span class="code-type">String</span>): <span class="code-type">ResponseBody</span>
}

<span class="code-keyword">class</span> <span class="code-type">DocumentRepository</span>(
    <span class="code-keyword">private val</span> api: <span class="code-type">RemoteComposeApi</span>
) {
    <span class="code-keyword">suspend fun</span> <span class="code-func">fetchDocument</span>(id: <span class="code-type">String</span>): <span class="code-type">Result</span>&lt;<span class="code-type">ByteArray</span>&gt; {
        <span class="code-keyword">return try</span> {
            <span class="code-keyword">val</span> response = api.<span class="code-func">getDocument</span>(id)
            <span class="code-keyword">if</span> (response.<span class="code-func">isSuccessful</span>) {
                <span class="code-type">Result</span>.<span class="code-func">success</span>(response.<span class="code-func">bytes</span>()!!)
            } <span class="code-keyword">else</span> {
                <span class="code-type">Result</span>.<span class="code-func">failure</span>(<span class="code-type">Exception</span>(<span class="code-string">"Failed to fetch document"</span>))
            }
        } <span class="code-keyword">catch</span> (e: <span class="code-type">Exception</span>) {
            <span class="code-type">Result</span>.<span class="code-func">failure</span>(e)
        }
    }
}

<span class="code-keyword">class</span> <span class="code-type">DocumentViewModel</span>(
    <span class="code-keyword">private val</span> repository: <span class="code-type">DocumentRepository</span>
) : <span class="code-type">ViewModel</span>() {
    <span class="code-keyword">private val</span> player = <span class="code-type">RemoteComposePlayer</span>()
    
    <span class="code-keyword">private val</span> _uiState = <span class="code-type">MutableStateFlow</span>&lt;<span class="code-type">DocumentUiState</span>&gt;(
        <span class="code-type">DocumentUiState</span>.<span class="code-func">Loading</span>()
    )
    <span class="code-keyword">val</span> uiState: <span class="code-type">StateFlow</span>&lt;<span class="code-type">DocumentUiState</span>&gt; = _uiState
    
    <span class="code-keyword">fun</span> <span class="code-func">loadDocument</span>(id: <span class="code-type">String</span>) {
        viewModelScope.<span class="code-func">launch</span> {
            _uiState.<span class="code-func">value</span> = <span class="code-type">DocumentUiState</span>.<span class="code-func">Loading</span>()
            
            <span class="code-keyword">when</span> (<span class="code-keyword">val</span> result = repository.<span class="code-func">fetchDocument</span>(id)) {
                <span class="code-keyword">is</span> <span class="code-type">Result</span>.<span class="code-type">Success</span> -&gt; {
                    <span class="code-keyword">try</span> {
                        <span class="code-keyword">val</span> doc = player.<span class="code-func">decode</span>(result.<span class="code-func">getOrNull</span>()!!)
                        _uiState.<span class="code-func">value</span> = <span class="code-type">DocumentUiState</span>.<span class="code-func">Success</span>(doc)
                    } <span class="code-keyword">catch</span> (e: <span class="code-type">Exception</span>) {
                        _uiState.<span class="code-func">value</span> = <span class="code-type">DocumentUiState</span>.<span class="code-func">Error</span>(e.<span class="code-func">message</span> ?: <span class="code-string">"Unknown error"</span>)
                    }
                }
                <span class="code-keyword">is</span> <span class="code-type">Result</span>.<span class="code-type">Failure</span> -&gt; {
                    _uiState.<span class="code-func">value</span> = <span class="code-type">DocumentUiState</span>.<span class="code-func">Error</span>(
                        result.<span class="code-func">exceptionOrNull</span>()?.<span class="code-func">message</span> ?: <span class="code-string">"Unknown error"</span>
                    )
                }
            }
        }
    }
}

<span class="code-keyword">sealed class</span> <span class="code-type">DocumentUiState</span> {
    <span class="code-keyword">data class</span> <span class="code-type">Loading</span>(<span class="code-keyword">val</span> message: <span class="code-type">String</span> = <span class="code-string">"Loading..."</span>) : <span class="code-type">DocumentUiState</span>()
    <span class="code-keyword">data class</span> <span class="code-type">Success</span>(<span class="code-keyword">val</span> document: <span class="code-type">RemoteComposeDocument</span>) : <span class="code-type">DocumentUiState</span>()
    <span class="code-keyword">data class</span> <span class="code-type">Error</span>(<span class="code-keyword">val</span> message: <span class="code-type">String</span>) : <span class="code-type">DocumentUiState</span>()
}</code></pre>

        <h2 id="section-5">V. å¤„ç†äº¤äº’äº‹ä»¶</h2>

        <h3>5.1 è¯­ä¹‰åŠ¨ä½œå¤„ç†</h3>

        <pre><code><span class="code-annotation">@Composable</span>
<span class="code-keyword">fun</span> <span class="code-func">RemoteComposeScreen</span>(
    viewModel: <span class="code-type">DocumentViewModel</span> = <span class="code-func">viewModel</span>()
) {
    <span class="code-keyword">val</span> uiState <span class="code-keyword">by</span> viewModel.uiState.<span class="code-func">collectAsState</span>()
    <span class="code-keyword">val</span> player = <span class="code-func">remember</span> { <span class="code-type">RemoteComposePlayer</span>() }
    
    <span class="code-type">Scaffold</span> { padding -&gt;
        <span class="code-type">Box</span>(
            modifier = <span class="code-type">Modifier</span>
                .<span class="code-func">fillMaxSize</span>()
                .<span class="code-func">padding</span>(padding)
        ) {
            <span class="code-keyword">when</span> (<span class="code-keyword">val</span> state = uiState) {
                <span class="code-keyword">is</span> <span class="code-type">DocumentUiState</span>.<span class="code-type">Loading</span> -&gt; {
                    <span class="code-type">Column</span>(
                        modifier = <span class="code-type">Modifier</span>.<span class="code-func">align</span>(<span class="code-type">Alignment</span>.Center),
                        horizontalAlignment = <span class="code-type">Alignment</span>.CenterHorizontally
                    ) {
                        <span class="code-type">CircularProgressIndicator</span>()
                        <span class="code-type">Spacer</span>(modifier = <span class="code-type">Modifier</span>.<span class="code-func">height</span>(<span class="code-string">16.dp</span>))
                        <span class="code-type">Text</span>(text = state.message)
                    }
                }
                <span class="code-keyword">is</span> <span class="code-type">DocumentUiState</span>.<span class="code-type">Success</span> -&gt; {
                    player.<span class="code-func">Play</span>(
                        document = state.document,
                        modifier = <span class="code-type">Modifier</span>.<span class="code-func">fillMaxSize</span>(),
                        onSemanticAction = { action -&gt;
                            <span class="code-comment">// å¤„ç†è¯­ä¹‰åŠ¨ä½œ</span>
                            <span class="code-func">handleSemanticAction</span>(action, viewModel)
                        }
                    )
                }
                <span class="code-keyword">is</span> <span class="code-type">DocumentUiState</span>.<span class="code-type">Error</span> -&gt; {
                    <span class="code-type">Column</span>(
                        modifier = <span class="code-type">Modifier</span>.<span class="code-func">align</span>(<span class="code-type">Alignment</span>.Center),
                        horizontalAlignment = <span class="code-type">Alignment</span>.CenterHorizontally
                    ) {
                        <span class="code-type">Text</span>(
                            text = <span class="code-string">"Error: ${state.message}"</span>,
                            color = <span class="code-type">MaterialTheme</span>.colorScheme.error
                        )
                        <span class="code-type">Spacer</span>(modifier = <span class="code-type">Modifier</span>.<span class="code-func">height</span>(<span class="code-string">16.dp</span>))
                        <span class="code-type">Button</span>(onClick = { viewModel.<span class="code-func">loadDocument</span>(<span class="code-string">"default"</span>) }) {
                            <span class="code-type">Text</span>(<span class="code-string">"Retry"</span>)
                        }
                    }
                }
            }
        }
    }
}

<span class="code-keyword">fun</span> <span class="code-func">handleSemanticAction</span>(
    action: <span class="code-type">SemanticAction</span>,
    viewModel: <span class="code-type">DocumentViewModel</span>
) {
    <span class="code-keyword">when</span> (action) {
        <span class="code-keyword">is</span> <span class="code-type">SemanticAction</span>.<span class="code-type">Navigate</span> -&gt; {
            <span class="code-comment">// å¤„ç†å¯¼èˆª</span>
            <span class="code-func">Log</span>.d(<span class="code-string">"RemoteCompose"</span>, <span class="code-string">"Navigate to: ${action.route}"</span>)
            <span class="code-comment">// ä½¿ç”¨ Navigation Compose å¯¼èˆª</span>
        }
        <span class="code-keyword">is</span> <span class="code-type">SemanticAction</span>.<span class="code-type">OpenUrl</span> -&gt; {
            <span class="code-comment">// æ‰“å¼€ URL</span>
            <span class="code-keyword">val</span> intent = <span class="code-type">Intent</span>(<span class="code-type">Intent</span>.<span class="code-type">ACTION_VIEW</span>, <span class="code-type">Uri</span>.<span class="code-func">parse</span>(action.url))
            context.<span class="code-func">startActivity</span>(intent)
        }
        <span class="code-keyword">is</span> <span class="code-type">SemanticAction</span>.<span class="code-type">SendEvent</span> -&gt; {
            <span class="code-comment">// å‘é€äº‹ä»¶åˆ°æœåŠ¡å™¨</span>
            viewModel.<span class="code-func">sendEvent</span>(action.eventName, action.payload)
        }
        <span class="code-keyword">is</span> <span class="code-type">SemanticAction</span>.<span class="code-type">LocalAction</span> -&gt; {
            <span class="code-comment">// æ‰§è¡Œæœ¬åœ°åŠ¨ä½œ</span>
            <span class="code-keyword">when</span> (action.actionType) {
                <span class="code-type">LocalActionType</span>.<span class="code-type">SHARE</span> -&gt; {
                    <span class="code-comment">// åˆ†äº«</span>
                }
                <span class="code-type">LocalActionType</span>.<span class="code-type">COPY_TO_CLIPBOARD</span> -&gt; {
                    <span class="code-comment">// å¤åˆ¶åˆ°å‰ªè´´æ¿</span>
                }
                <span class="code-comment">// ... å…¶ä»–åŠ¨ä½œ</span>
            }
        }
        <span class="code-keyword">is</span> <span class="code-type">SemanticAction</span>.<span class="code-type">Composite</span> -&gt; {
            <span class="code-comment">// æ‰§è¡Œå¤åˆåŠ¨ä½œ</span>
            action.actions.<span class="code-func">forEach</span> { 
                <span class="code-func">handleSemanticAction</span>(it, viewModel) 
            }
        }
    }
}</code></pre>

        <h3>5.2 äº‹ä»¶å›ä¼ åˆ°æœåŠ¡å™¨</h3>

        <pre><code><span class="code-keyword">interface</span> <span class="code-type">RemoteComposeApi</span> {
    <span class="code-annotation">@POST</span>(<span class="code-string">"api/event"</span>)
    <span class="code-keyword">suspend fun</span> <span class="code-func">sendEvent</span>(
        <span class="code-annotation">@Body</span> event: <span class="code-type">EventRequest</span>
    ): <span class="code-type">EventResponse</span>
}

<span class="code-keyword">data class</span> <span class="code-type">EventRequest</span>(
    <span class="code-keyword">val</span> documentId: <span class="code-type">String</span>,
    <span class="code-keyword">val</span> eventName: <span class="code-type">String</span>,
    <span class="code-keyword">val</span> payload: <span class="code-type">Map</span>&lt;<span class="code-type">String</span>, <span class="code-type">Any</span>&gt;
)

<span class="code-keyword">data class</span> <span class="code-type">EventResponse</span>(
    <span class="code-keyword">val</span> success: <span class="code-type">Boolean</span>,
    <span class="code-keyword">val</span> newDocumentId: <span class="code-type">String</span>?,  <span class="code-comment">// å¯é€‰ï¼šè¿”å›æ–°æ–‡æ¡£</span>
    <span class="code-keyword">val</span> message: <span class="code-type">String</span>?
)

<span class="code-keyword">class</span> <span class="code-type">DocumentViewModel</span>(
    <span class="code-keyword">private val</span> repository: <span class="code-type">DocumentRepository</span>
) : <span class="code-type">ViewModel</span>() {
    <span class="code-keyword">private var</span> currentDocumentId: <span class="code-type">String</span>? = <span class="code-keyword">null</span>
    
    <span class="code-keyword">fun</span> <span class="code-func">sendEvent</span>(eventName: <span class="code-type">String</span>, payload: <span class="code-type">Map</span>&lt;<span class="code-type">String</span>, <span class="code-type">Any</span>&gt;) {
        viewModelScope.<span class="code-func">launch</span> {
            <span class="code-keyword">val</span> documentId = currentDocumentId ?: <span class="code-keyword">return@launch</span>
            
            <span class="code-keyword">val</span> result = repository.<span class="code-func">sendEvent</span>(
                <span class="code-type">EventRequest</span>(documentId, eventName, payload)
            )
            
            <span class="code-keyword">if</span> (result.<span class="code-keyword">is</span> <span class="code-type">Result</span>.<span class="code-type">Success</span>) {
                <span class="code-keyword">val</span> response = result.<span class="code-func">getOrNull</span>()!!
                <span class="code-keyword">if</span> (response.success) {
                    <span class="code-comment">// å¦‚æœæœåŠ¡å™¨è¿”å›äº†æ–°æ–‡æ¡£ï¼ŒåŠ è½½å®ƒ</span>
                    response.newDocumentId?.<span class="code-func">let</span> { newId -&gt;
                        <span class="code-func">loadDocument</span>(newId)
                    }
                }
            }
        }
    }
}</code></pre>

        <h2 id="section-6">VI. å®Œæ•´ç¤ºä¾‹é¡¹ç›®</h2>

        <h3>6.1 é¡¹ç›®ç»“æ„</h3>

        <div class="diagram-box">
<span class="diagram-warning">é¡¹ç›®ç»“æ„</span>

app/
â”œâ”€â”€ src/main/java/com/example/remotecompose/
â”‚   â”œâ”€â”€ <span class="diagram-highlight">MainActivity.kt</span>
â”‚   â”œâ”€â”€ <span class="diagram-highlight">ui/</span>
â”‚   â”‚   â”œâ”€â”€ RemoteComposeScreen.kt
â”‚   â”‚   â””â”€â”€ DocumentViewModel.kt
â”‚   â”œâ”€â”€ <span class="diagram-highlight">data/</span>
â”‚   â”‚   â”œâ”€â”€ RemoteComposeApi.kt
â”‚   â”‚   â”œâ”€â”€ DocumentRepository.kt
â”‚   â”‚   â””â”€â”€ models/
â”‚   â”‚       â”œâ”€â”€ EventRequest.kt
â”‚   â”‚       â””â”€â”€ EventResponse.kt
â”‚   â””â”€â”€ <span class="diagram-highlight">di/</span>
â”‚       â””â”€â”€ AppModule.kt
        </div>

        <h3>6.2 MainActivity</h3>

        <pre><code><span class="code-keyword">package</span> com.example.remotecompose

<span class="code-keyword">import</span> android.os.Bundle
<span class="code-keyword">import</span> androidx.activity.ComponentActivity
<span class="code-keyword">import</span> androidx.activity.compose.setContent
<span class="code-keyword">import</span> androidx.compose.foundation.layout.fillMaxSize
<span class="code-keyword">import</span> androidx.compose.material3.MaterialTheme
<span class="code-keyword">import</span> androidx.compose.material3.Surface
<span class="code-keyword">import</span> androidx.compose.ui.Modifier
<span class="code-keyword">import</span> com.example.remotecompose.ui.RemoteComposeScreen
<span class="code-keyword">import</span> com.example.remotecompose.ui.theme.RemoteComposeTheme

<span class="code-keyword">class</span> <span class="code-type">MainActivity</span> : <span class="code-type">ComponentActivity</span>() {
    <span class="code-keyword">override fun</span> <span class="code-func">onCreate</span>(savedInstanceState: <span class="code-type">Bundle</span>?) {
        <span class="code-keyword">super</span>.<span class="code-func">onCreate</span>(savedInstanceState)
        
        setContent {
            <span class="code-type">RemoteComposeTheme</span> {
                <span class="code-type">Surface</span>(
                    modifier = <span class="code-type">Modifier</span>.<span class="code-func">fillMaxSize</span>(),
                    color = <span class="code-type">MaterialTheme</span>.colorScheme.background
                ) {
                    <span class="code-type">RemoteComposeScreen</span>()
                }
            }
        }
    }
}</code></pre>

        <h3>6.3 ä¾èµ–æ³¨å…¥ (Hilt)</h3>

        <pre><code><span class="code-keyword">package</span> com.example.remotecompose.di

<span class="code-keyword">import</span> com.example.remotecompose.data.DocumentRepository
<span class="code-keyword">import</span> com.example.remotecompose.data.RemoteComposeApi
<span class="code-keyword">import</span> dagger.Module
<span class="code-keyword">import</span> dagger.Provides
<span class="code-keyword">import</span> dagger.hilt.InstallIn
<span class="code-keyword">import</span> dagger.hilt.components.SingletonComponent
<span class="code-keyword">import</span> okhttp3.OkHttpClient
<span class="code-keyword">import</span> retrofit2.Retrofit
<span class="code-keyword">import</span> retrofit2.converter.gson.GsonConverterFactory
<span class="code-keyword">import</span> javax.inject.Singleton

<span class="code-annotation">@Module</span>
<span class="code-annotation">@InstallIn</span>(<span class="code-type">SingletonComponent</span>::<span class="code-type">class</span>)
<span class="code-keyword">object</span> <span class="code-type">AppModule</span> {
    
    <span class="code-annotation">@Provides</span>
    <span class="code-annotation">@Singleton</span>
    <span class="code-keyword">fun</span> <span class="code-func">provideOkHttpClient</span>(): <span class="code-type">OkHttpClient</span> {
        <span class="code-keyword">return</span> <span class="code-type">OkHttpClient</span>.Builder()
            .<span class="code-func">connectTimeout</span>(<span class="code-string">30</span>, <span class="code-type">TimeUnit</span>.<span class="code-type">SECONDS</span>)
            .<span class="code-func">readTimeout</span>(<span class="code-string">30</span>, <span class="code-type">TimeUnit</span>.<span class="code-type">SECONDS</span>)
            .<span class="code-func">build</span>()
    }
    
    <span class="code-annotation">@Provides</span>
    <span class="code-annotation">@Singleton</span>
    <span class="code-keyword">fun</span> <span class="code-func">provideRetrofit</span>(okHttpClient: <span class="code-type">OkHttpClient</span>): <span class="code-type">Retrofit</span> {
        <span class="code-keyword">return</span> <span class="code-type">Retrofit</span>.Builder()
            .<span class="code-func">baseUrl</span>(<span class="code-string">"https://your-api.com/"</span>)
            .<span class="code-func">client</span>(okHttpClient)
            .<span class="code-func">addConverterFactory</span>(<span class="code-type">GsonConverterFactory</span>.<span class="code-func">create</span>())
            .<span class="code-func">build</span>()
    }
    
    <span class="code-annotation">@Provides</span>
    <span class="code-annotation">@Singleton</span>
    <span class="code-keyword">fun</span> <span class="code-func">provideApi</span>(retrofit: <span class="code-type">Retrofit</span>): <span class="code-type">RemoteComposeApi</span> {
        <span class="code-keyword">return</span> retrofit.<span class="code-func">create</span>(<span class="code-type">RemoteComposeApi</span>::<span class="code-type">class</span>.<span class="code-keyword">java</span>)
    }
    
    <span class="code-annotation">@Provides</span>
    <span class="code-annotation">@Singleton</span>
    <span class="code-keyword">fun</span> <span class="code-func">provideRepository</span>(api: <span class="code-type">RemoteComposeApi</span>): <span class="code-type">DocumentRepository</span> {
        <span class="code-keyword">return</span> <span class="code-type">DocumentRepository</span>(api)
    }
}</code></pre>

        <h2 id="section-7">VII. æœ€ä½³å®è·µ</h2>

        <h3>7.1 æ–‡æ¡£ç¼“å­˜</h3>

        <pre><code><span class="code-keyword">class</span> <span class="code-type">DocumentCache</span>(
    <span class="code-keyword">private val</span> context: <span class="code-type">Context</span>
) {
    <span class="code-keyword">private val</span> cacheDir = <span class="code-type">File</span>(context.cacheDir, <span class="code-string">"remote_compose"</span>)
    <span class="code-keyword">private val</span> memoryCache = <span class="code-type">LruCache</span>&lt;<span class="code-type">String</span>, <span class="code-type">ByteArray</span>&gt;(<span class="code-string">50</span>)
    
    <span class="code-keyword">init</span> {
        cacheDir.<span class="code-func">mkdirs</span>()
    }
    
    <span class="code-keyword">suspend fun</span> <span class="code-func">get</span>(id: <span class="code-type">String</span>): <span class="code-type">ByteArray</span>? {
        <span class="code-comment">// 1. æ£€æŸ¥å†…å­˜ç¼“å­˜</span>
        memoryCache.<span class="code-func">get</span>(id)?.<span class="code-func">let</span> { <span class="code-keyword">return</span> it }
        
        <span class="code-comment">// 2. æ£€æŸ¥ç£ç›˜ç¼“å­˜</span>
        <span class="code-keyword">val</span> file = <span class="code-type">File</span>(cacheDir, <span class="code-string">"$id.bin"</span>)
        <span class="code-keyword">if</span> (file.<span class="code-func">exists</span>()) {
            <span class="code-keyword">val</span> bytes = <span class="code-keyword">withContext</span>(<span class="code-type">Dispatchers</span>.<span class="code-type">IO</span>) {
                file.<span class="code-func">readBytes</span>()
            }
            memoryCache.<span class="code-func">put</span>(id, bytes)
            <span class="code-keyword">return</span> bytes
        }
        
        <span class="code-keyword">return null</span>
    }
    
    <span class="code-keyword">suspend fun</span> <span class="code-func">put</span>(id: <span class="code-type">String</span>, bytes: <span class="code-type">ByteArray</span>) {
        <span class="code-comment">// 1. å­˜å…¥å†…å­˜ç¼“å­˜</span>
        memoryCache.<span class="code-func">put</span>(id, bytes)
        
        <span class="code-comment">// 2. å­˜å…¥ç£ç›˜ç¼“å­˜</span>
        <span class="code-keyword">withContext</span>(<span class="code-type">Dispatchers</span>.<span class="code-type">IO</span>) {
            <span class="code-keyword">val</span> file = <span class="code-type">File</span>(cacheDir, <span class="code-string">"$id.bin"</span>)
            file.<span class="code-func">writeBytes</span>(bytes)
        }
    }
    
    <span class="code-keyword">fun</span> <span class="code-func">clear</span>() {
        memoryCache.<span class="code-func">evictAll</span>()
        cacheDir.<span class="code-func">listFiles</span>()?.<span class="code-func">forEach</span> { it.<span class="code-func">delete</span>() }
    }
}</code></pre>

        <h3>7.2 é”™è¯¯å¤„ç†</h3>

        <pre><code><span class="code-keyword">sealed class</span> <span class="code-type">DocumentError</span> : <span class="code-type">Exception</span>() {
    <span class="code-keyword">data class</span> <span class="code-type">NetworkError</span>(<span class="code-keyword">val</span> message: <span class="code-type">String</span>) : <span class="code-type">DocumentError</span>()
    <span class="code-keyword">data class</span> <span class="code-type">DecodeError</span>(<span class="code-keyword">val</span> message: <span class="code-type">String</span>) : <span class="code-type">DocumentError</span>()
    <span class="code-keyword">data class</span> <span class="code-type">VersionMismatch</span>(<span class="code-keyword">val</span> expected: <span class="code-type">Int</span>, <span class="code-keyword">val</span> actual: <span class="code-type">Int</span>) : <span class="code-type">DocumentError</span>()
    <span class="code-keyword">data class</span> <span class="code-type">InvalidFormat</span>(<span class="code-keyword">val</span> message: <span class="code-type">String</span>) : <span class="code-type">DocumentError</span>()
}

<span class="code-keyword">fun</span> <span class="code-type">DocumentError</span>.<span class="code-func">getUserMessage</span>(): <span class="code-type">String</span> {
    <span class="code-keyword">return when</span> (<span class="code-keyword">this</span>) {
        <span class="code-keyword">is</span> <span class="code-type">NetworkError</span> -&gt; <span class="code-string">"ç½‘ç»œè¿æ¥å¤±è´¥ï¼Œè¯·æ£€æŸ¥ç½‘ç»œè®¾ç½®"</span>
        <span class="code-keyword">is</span> <span class="code-type">DecodeError</span> -&gt; <span class="code-string">"æ–‡æ¡£è§£æå¤±è´¥ï¼Œè¯·é‡è¯•"</span>
        <span class="code-keyword">is</span> <span class="code-type">VersionMismatch</span> -&gt; <span class="code-string">"æ–‡æ¡£ç‰ˆæœ¬ä¸å…¼å®¹ï¼Œè¯·æ›´æ–°åº”ç”¨"</span>
        <span class="code-keyword">is</span> <span class="code-type">InvalidFormat</span> -&gt; <span class="code-string">"æ–‡æ¡£æ ¼å¼é”™è¯¯"</span>
    }
}</code></pre>

        <h3>7.3 æ€§èƒ½ä¼˜åŒ–</h3>

        <div class="tip-box success">
            <div class="tip-title">âœ… æ€§èƒ½ä¼˜åŒ–å»ºè®®</div>
            <ul>
                <li><strong>æ–‡æ¡£å¤§å°</strong>ï¼šå°½é‡æ§åˆ¶æ–‡æ¡£å¤§å°ï¼Œé¿å…åŒ…å«è¿‡å¤šå›¾ç‰‡</li>
                <li><strong>æ‡’åŠ è½½</strong>ï¼šå¯¹äºé•¿åˆ—è¡¨ï¼Œä½¿ç”¨åˆ†é¡µåŠ è½½</li>
                <li><strong>ç¼“å­˜ç­–ç•¥</strong>ï¼šåˆç†ä½¿ç”¨å†…å­˜å’Œç£ç›˜ç¼“å­˜</li>
                <li><strong>å¢é‡æ›´æ–°</strong>ï¼šåªä¼ è¾“å˜åŒ–çš„æ“ä½œï¼Œè€Œéæ•´ä¸ªæ–‡æ¡£</li>
                <li><strong>é¢„åŠ è½½</strong>ï¼šåœ¨ç”¨æˆ·å¯èƒ½è®¿é—®å‰é¢„åŠ è½½æ–‡æ¡£</li>
            </ul>
        </div>

        <h2 id="section-8">VIII. å¸¸è§é—®é¢˜</h2>

        <h3>8.1 æ–‡æ¡£æ— æ³•è§£ç </h3>

        <div class="tip-box error">
            <div class="tip-title">âŒ é—®é¢˜ï¼šæ–‡æ¡£è§£ç å¤±è´¥</div>
            <p><strong>å¯èƒ½åŸå› ï¼š</strong></p>
            <ul>
                <li>æ–‡æ¡£ç‰ˆæœ¬ä¸å…¼å®¹</li>
                <li>æ–‡æ¡£æ ¼å¼æŸå</li>
                <li>ç¼–ç è¿‡ç¨‹ä¸­å‡ºé”™</li>
            </ul>
            <p><strong>è§£å†³æ–¹æ¡ˆï¼š</strong></p>
            <ul>
                <li>æ£€æŸ¥æ–‡æ¡£ç‰ˆæœ¬å·</li>
                <li>éªŒè¯æ–‡æ¡£å®Œæ•´æ€§ï¼ˆä½¿ç”¨æ ¡éªŒå’Œï¼‰</li>
                <li>ç¡®ä¿ä½¿ç”¨ç›¸åŒç‰ˆæœ¬çš„ RemoteCompose åº“</li>
            </ul>
        </div>

        <h3>8.2 äº¤äº’äº‹ä»¶ä¸å“åº”</h3>

        <div class="tip-box warning">
            <div class="tip-title">âš ï¸ é—®é¢˜ï¼šç‚¹å‡»æ— å“åº”</div>
            <p><strong>æ£€æŸ¥æ¸…å•ï¼š</strong></p>
            <ol>
                <li>ç¡®è®¤æ–‡æ¡£ä¸­å®šä¹‰äº†è¯­ä¹‰åŠ¨ä½œ</li>
                <li>æ£€æŸ¥ <code>onSemanticAction</code> å›è°ƒæ˜¯å¦æ­£ç¡®è®¾ç½®</li>
                <li>éªŒè¯ç‚¹å‡»åŒºåŸŸæ˜¯å¦åœ¨æ–‡æ¡£èŒƒå›´å†…</li>
                <li>æ£€æŸ¥æ˜¯å¦æœ‰å…¶ä»– View é®æŒ¡</li>
            </ol>
        </div>

        <h3>8.3 æ–‡æ¡£æ¸²æŸ“ä¸å®Œæ•´</h3>

        <div class="tip-box warning">
            <div class="tip-title">âš ï¸ é—®é¢˜ï¼šUI æ˜¾ç¤ºä¸å®Œæ•´</div>
            <p><strong>å¯èƒ½åŸå› ï¼š</strong></p>
            <ul>
                <li>æ–‡æ¡£å°ºå¯¸ä¸å±å¹•ä¸åŒ¹é…</li>
                <li>æŸäº›æ“ä½œæœªæ­£ç¡®æ•è·</li>
                <li>èµ„æºï¼ˆå›¾ç‰‡ã€å­—ä½“ï¼‰ç¼ºå¤±</li>
            </ul>
            <p><strong>è§£å†³æ–¹æ¡ˆï¼š</strong></p>
            <ul>
                <li>ä½¿ç”¨å“åº”å¼å°ºå¯¸ï¼ˆ<code>fillMaxSize</code>ï¼‰</li>
                <li>æ£€æŸ¥èµ„æºæ˜¯å¦å®Œæ•´åµŒå…¥æ–‡æ¡£</li>
                <li>ä½¿ç”¨å¸ƒå±€çº¦æŸè€Œéå›ºå®šå°ºå¯¸</li>
            </ul>
        </div>

        <h2>IX. æ€»ç»“</h2>

        <p>é€šè¿‡æœ¬æ–‡çš„è¯¦ç»†è®²è§£ï¼Œä½ åº”è¯¥å·²ç»æŒæ¡äº† RemoteCompose çš„å®Œæ•´ä½¿ç”¨æ–¹æ³•ã€‚ä»ç¯å¢ƒé…ç½®åˆ°å®é™…é¡¹ç›®é›†æˆï¼Œä»åŸºç¡€æ’­æ”¾åˆ°äº¤äº’å¤„ç†ï¼ŒRemoteCompose ä¸ºæœåŠ¡å™¨é©±åŠ¨ UI æä¾›äº†ä¸€ä¸ªå¼ºå¤§è€Œçµæ´»çš„è§£å†³æ–¹æ¡ˆã€‚</p>

        <p>è®°ä½ä»¥ä¸‹å…³é”®ç‚¹ï¼š</p>
        <ul>
            <li>ä½¿ç”¨ <code>RemoteComposeSender</code> åˆ›å»ºæ–‡æ¡£</li>
            <li>ä½¿ç”¨ <code>RemoteComposePlayer</code> æ’­æ”¾æ–‡æ¡£</li>
            <li>é€šè¿‡ <code>SemanticAction</code> å¤„ç†äº¤äº’</li>
            <li>å®ç°åˆç†çš„ç¼“å­˜å’Œé”™è¯¯å¤„ç†</li>
            <li>éµå¾ªæœ€ä½³å®è·µä¼˜åŒ–æ€§èƒ½</li>
        </ul>

        <p>ç°åœ¨ï¼Œå¼€å§‹æ„å»ºä½ çš„ç¬¬ä¸€ä¸ª RemoteCompose åº”ç”¨å§ï¼ğŸš€</p>
    </article>

    <footer class="footer">
        <p>Â© 2024 Fidroid - ä¸“æ³¨ Android ä¸ Jetpack Compose</p>
    </footer>
</body>
</html>

