<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Compose å®æˆ˜æŠ€å·§ï¼šå¸¸è§é™·é˜±ä¸è§£å†³æ–¹æ¡ˆ - Fidroid</title>
    <meta name="description" content="æ€»ç»“å®é™…å¼€å‘ä¸­æœ€å¸¸è§çš„ Compose é™·é˜±ï¼Œæä¾›ç»è¿‡éªŒè¯çš„è§£å†³æ–¹æ¡ˆï¼Œå¸®åŠ©ä½ é¿å…è¿™äº›å‘ï¼Œå†™å‡ºæ›´å¥å£®ã€æ›´é«˜æ•ˆçš„ä»£ç ã€‚">
    <style>

        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; line-height: 1.8; color: #e5e7eb; background: #020617; }
        .navbar { background: rgba(15,23,42,0.98); backdrop-filter: blur(10px); position: fixed; top: 0; width: 100%; z-index: 1000; }
        .nav-container { max-width: 900px; margin: 0 auto; padding: 1rem 20px; display: flex; justify-content: space-between; align-items: center; }
        .logo { font-size: 1.5rem; font-weight: bold; color: #38bdf8; text-decoration: none; letter-spacing: 0.08em; text-transform: uppercase; }
        .back-link { color: #9ca3af; text-decoration: none; font-size: 0.9rem; }
        .back-link:hover { color: #38bdf8; }
        .article-header { padding: 120px 20px 60px; background: radial-gradient(circle at top left, #dc2626 0, transparent 50%), radial-gradient(circle at bottom right, #7c3aed 0, transparent 55%), #020617; text-align: center; }
        .article-header h1 { max-width: 800px; margin: 0 auto 1rem; font-size: 2.5rem; font-weight: 800; letter-spacing: -0.03em; color: #fff; }
        .article-meta { color: #9ca3af; font-size: 0.9rem; margin-bottom: 1.5rem; }
        .article-tags { display: flex; justify-content: center; flex-wrap: wrap; gap: 0.5rem; }
        .article-tag { padding: 0.25rem 0.75rem; border-radius: 999px; font-size: 0.75rem; background: rgba(15,23,42,0.85); border: 1px solid rgba(220,38,38,0.4); color: #f87171; }
        .article-content { max-width: 800px; margin: 0 auto; padding: 60px 20px 80px; }
        .article-content h2 { font-size: 1.6rem; margin: 2.5rem 0 1rem; color: #f9fafb; border-left: 4px solid #dc2626; padding-left: 1rem; }
        .article-content h3 { font-size: 1.25rem; margin: 2rem 0 0.75rem; color: #e5e7eb; }
        .article-content p { margin-bottom: 1.25rem; color: #d1d5db; }
        .article-content ul, .article-content ol { margin: 1rem 0 1.5rem 1.5rem; color: #d1d5db; }
        .article-content li { margin-bottom: 0.5rem; }
        .article-content strong { color: #f9fafb; }
        pre { background: #0f172a; border: 1px solid rgba(220,38,38,0.3); border-radius: 12px; padding: 1.25rem; overflow-x: auto; margin: 1.5rem 0; font-size: 0.85rem; line-height: 1.6; }
        code { font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, monospace; color: #e5e7eb; }
        .code-keyword { color: #c084fc; }
        .code-func { color: #38bdf8; }
        .code-type { color: #4ade80; }
        .code-string { color: #fb7185; }
        .code-comment { color: #6b7280; font-style: italic; }
        .footer { background: #020617; border-top: 1px solid #111827; padding: 2rem; text-align: center; color: #6b7280; }
        .footer a { color: #38bdf8; text-decoration: none; }
    
        .toc {
            background: rgba(15,23,42,0.6);
            border: 1px solid rgba(220,38,38,0.3);
            border-radius: 12px;
            padding: 1.5rem;
            margin: 2rem 0 3rem;
        }
        .toc-title {
            font-size: 1.1rem;
            font-weight: 600;
            color: #f87171;
            margin-bottom: 1rem;
        }
        .toc-list {
            list-style: none;
            margin: 0;
            padding: 0;
        }
        .toc-list li {
            margin: 0.5rem 0;
        }
        .toc-h2 {
            margin-left: 0;
        }
        .toc-list a {
            color: #d1d5db;
            text-decoration: none;
        }
        .toc-list a:hover {
            color: #38bdf8;
        }
        .comparison-table {
            width: 100%;
            border-collapse: collapse;
            margin: 1.5rem 0;
            background: #0f172a;
            border-radius: 12px;
            overflow: hidden;
        }
        .comparison-table th,
        .comparison-table td {
            padding: 1rem;
            text-align: left;
            border-bottom: 1px solid rgba(220,38,38,0.2);
        }
        .comparison-table th {
            background: rgba(220,38,38,0.2);
            color: #f87171;
            font-weight: 600;
        }
        .comparison-table tr:last-child td {
            border-bottom: none;
        }
        .code-bad {
            background: rgba(220,38,38,0.1);
            border-left: 3px solid #ef4444;
            padding: 1rem;
            margin: 1rem 0;
        }
        .code-good {
            background: rgba(34,197,94,0.1);
            border-left: 3px solid #22c55e;
            padding: 1rem;
            margin: 1rem 0;
        }
        .reference {
            background: rgba(15,23,42,0.6);
            border: 1px solid rgba(148,163,184,0.2);
            border-radius: 8px;
            padding: 1rem 1.25rem;
            margin: 1rem 0;
            font-size: 0.9rem;
        }
        .reference-title {
            font-weight: 600;
            color: #94a3b8;
            font-size: 0.75rem;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            margin-bottom: 0.5rem;
        }
        .reference a { color: #38bdf8; }
    </style>
</head>
<body>
    <nav class="navbar">
        <div class="nav-container">
            <a href="../index.html" class="logo">Fidroid</a>
            <a href="../index.html#blog" class="back-link">â† è¿”å›åšå®¢åˆ—è¡¨</a>
        </div>
    </nav>

    <header class="article-header">
        <h1>Compose å®æˆ˜æŠ€å·§ï¼šå¸¸è§é™·é˜±ä¸è§£å†³æ–¹æ¡ˆ</h1>
        <p class="article-meta">2024-12-21 Â· 35-40 min Â· å®æˆ˜æŠ€å·§</p>
        <div class="article-tags">
            <span class="article-tag">å®æˆ˜æŠ€å·§</span>
            <span class="article-tag">å¸¸è§é™·é˜±</span>
            <span class="article-tag">æœ€ä½³å®è·µ</span>
            <span class="article-tag">æ€§èƒ½ä¼˜åŒ–</span>
            <span class="article-tag">é—®é¢˜æ’æŸ¥</span>
        </div>
    </header>

    <article class="article-content">
        <nav class="toc">
            <div class="toc-title">ğŸ“š ç›®å½•</div>
            <ul class="toc-list">
                <li class="toc-h2"><a href="#i-çŠ¶æ€ç®¡ç†é™·é˜±">I. çŠ¶æ€ç®¡ç†é™·é˜±</a></li>
                <li class="toc-h2"><a href="#ii-æ€§èƒ½ä¼˜åŒ–é™·é˜±">II. æ€§èƒ½ä¼˜åŒ–é™·é˜±</a></li>
                <li class="toc-h2"><a href="#iii-åˆ—è¡¨æ¸²æŸ“é™·é˜±">III. åˆ—è¡¨æ¸²æŸ“é™·é˜±</a></li>
                <li class="toc-h2"><a href="#iv-å‰¯ä½œç”¨å¤„ç†é™·é˜±">IV. å‰¯ä½œç”¨å¤„ç†é™·é˜±</a></li>
                <li class="toc-h2"><a href="#v-å†…å­˜æ³„æ¼é™·é˜±">V. å†…å­˜æ³„æ¼é™·é˜±</a></li>
                <li class="toc-h2"><a href="#vi-åŠ¨ç”»ä¸äº¤äº’é™·é˜±">VI. åŠ¨ç”»ä¸äº¤äº’é™·é˜±</a></li>
                <li class="toc-h2"><a href="#vii-ä»£ç ç»„ç»‡é™·é˜±">VII. ä»£ç ç»„ç»‡é™·é˜±</a></li>
                <li class="toc-h2"><a href="#viii-è°ƒè¯•ä¸æ’æŸ¥æŠ€å·§">VIII. è°ƒè¯•ä¸æ’æŸ¥æŠ€å·§</a></li>
            </ul>
        </nav>
<p>åœ¨å®é™…é¡¹ç›®ä¸­ï¼Œå³ä½¿ç†è§£äº† Compose çš„åŸºæœ¬æ¦‚å¿µï¼Œä»ç„¶ä¼šé‡åˆ°å„ç§æ„æƒ³ä¸åˆ°çš„é—®é¢˜ã€‚æœ¬æ–‡æ€»ç»“äº†å®é™…å¼€å‘ä¸­æœ€å¸¸è§çš„é™·é˜±ï¼Œå¹¶æä¾›ç»è¿‡éªŒè¯çš„è§£å†³æ–¹æ¡ˆï¼Œå¸®åŠ©ä½ é¿å…è¿™äº›å‘ï¼Œå†™å‡ºæ›´å¥å£®ã€æ›´é«˜æ•ˆçš„ Compose ä»£ç ã€‚</p>
        <h3 id="-å®˜æ–¹å‚è€ƒ">ğŸ“š å®˜æ–¹å‚è€ƒ</h3>
        <ul>
        <li><a href="https://developer.android.com/jetpack/compose/performance" target="_blank">Compose Performance - Android Developers</a></li>
        <li><a href="https://developer.android.com/jetpack/compose/mental-model" target="_blank">Thinking in Compose - Android Developers</a></li>
        <li><a href="https://developer.android.com/jetpack/compose/best-practices" target="_blank">Compose Best Practices - Android Developers</a></li>
        </ul>
        <h3 id="ç›®å½•">ç›®å½•</h3>
        <ul>
        <li><a href="#i-çŠ¶æ€ç®¡ç†é™·é˜±" target="_blank">I. çŠ¶æ€ç®¡ç†é™·é˜±</a></li>
        <li><a href="#ii-æ€§èƒ½ä¼˜åŒ–é™·é˜±" target="_blank">II. æ€§èƒ½ä¼˜åŒ–é™·é˜±</a></li>
        <li><a href="#iii-åˆ—è¡¨æ¸²æŸ“é™·é˜±" target="_blank">III. åˆ—è¡¨æ¸²æŸ“é™·é˜±</a></li>
        <li><a href="#iv-å‰¯ä½œç”¨å¤„ç†é™·é˜±" target="_blank">IV. å‰¯ä½œç”¨å¤„ç†é™·é˜±</a></li>
        <li><a href="#v-å†…å­˜æ³„æ¼é™·é˜±" target="_blank">V. å†…å­˜æ³„æ¼é™·é˜±</a></li>
        <li><a href="#vi-åŠ¨ç”»ä¸äº¤äº’é™·é˜±" target="_blank">VI. åŠ¨ç”»ä¸äº¤äº’é™·é˜±</a></li>
        <li><a href="#vii-ä»£ç ç»„ç»‡é™·é˜±" target="_blank">VII. ä»£ç ç»„ç»‡é™·é˜±</a></li>
        <li><a href="#viii-è°ƒè¯•ä¸æ’æŸ¥æŠ€å·§" target="_blank">VIII. è°ƒè¯•ä¸æ’æŸ¥æŠ€å·§</a></li>
        </ul>
        <h3 id="i-çŠ¶æ€ç®¡ç†é™·é˜±">I. çŠ¶æ€ç®¡ç†é™·é˜±</h3>
        <p>çŠ¶æ€ç®¡ç†æ˜¯ Compose å¼€å‘ä¸­æœ€å®¹æ˜“å‡ºé”™çš„åœ°æ–¹ã€‚ä»¥ä¸‹æ˜¯æœ€å¸¸è§çš„é™·é˜±å’Œè§£å†³æ–¹æ¡ˆã€‚</p>
        <h4>1.1 å¿˜è®°ä½¿ç”¨ remember</h4>
        <p>è¿™æ˜¯æœ€å¸¸è§çš„é”™è¯¯ä¹‹ä¸€ï¼Œä¼šå¯¼è‡´çŠ¶æ€åœ¨æ¯æ¬¡é‡ç»„æ—¶è¢«é‡ç½®ã€‚</p>
        <div class="code-bad"><pre><code>
        // âŒ é”™è¯¯ï¼šæ¯æ¬¡é‡ç»„éƒ½åˆ›å»ºæ–°çŠ¶æ€
@Composable
fun BrokenCounter() {
    var count = mutableStateOf(0)  // æ²¡æœ‰ rememberï¼
    Button(onClick = { count.value++ }) {
        Text("Count: ${count.value}")
    }
    // ç‚¹å‡»æŒ‰é’®åï¼Œcount ä¼šç«‹å³é‡ç½®ä¸º 0
}

// âœ… æ­£ç¡®ï¼šä½¿ç”¨ remember ä¿æŒçŠ¶æ€
@Composable
fun FixedCounter() {
    var count by remember { mutableStateOf(0) }
    Button(onClick = { count++ }) {
        Text("Count: $count")
    }
}
        </code></pre></div>
        <p><strong>ä¸ºä»€ä¹ˆä¼šå‡ºé”™ï¼Ÿ</strong></p>
        <ul>
        <li>æ¯æ¬¡é‡ç»„æ—¶ï¼Œ<code>mutableStateOf(0)</code> éƒ½ä¼šåˆ›å»ºæ–°çš„çŠ¶æ€å¯¹è±¡</li>
        <li>æ–°å¯¹è±¡çš„å€¼æ˜¯ 0ï¼Œæ‰€ä»¥ UI æ€»æ˜¯æ˜¾ç¤º 0</li>
        <li><code>remember</code> ç¡®ä¿çŠ¶æ€å¯¹è±¡åœ¨é‡ç»„ä¹‹é—´ä¿æŒ</li>
        </ul>
        <h4>1.2 remember çš„ key ä¸ç¨³å®š</h4>
        <p>ä½¿ç”¨ä¸ç¨³å®šçš„ key ä¼šå¯¼è‡´ <code>remember</code> å¤±æ•ˆã€‚</p>
        <div class="code-bad"><pre><code>
        // âŒ é”™è¯¯ï¼šlistOf æ¯æ¬¡éƒ½æ˜¯æ–°å¯¹è±¡
@Composable
fun ExpensiveComponent(items: List&lt;Item&gt;) {
    val sortedItems = remember(listOf(1, 2, 3)) {  // key ä¸ç¨³å®šï¼
        items.sortedBy { it.name }
    }
}

// âœ… æ­£ç¡®ï¼šä½¿ç”¨ç¨³å®šçš„ key
@Composable
fun ExpensiveComponent(items: List&lt;Item&gt;) {
    val sortedItems = remember(items) {  // items ä½œä¸º key
        items.sortedBy { it.name }
    }
}

// âœ… æˆ–è€…ä½¿ç”¨å¤šä¸ªç¨³å®šçš„ key
@Composable
fun FilteredList(items: List&lt;Item&gt;, filter: String) {
    val filtered = remember(items, filter) {  // å¤šä¸ª key
        items.filter { it.name.contains(filter) }
    }
}
        </code></pre></div>
        <h4>1.3 çŠ¶æ€æå‡è¿‡åº¦æˆ–ä¸è¶³</h4>
        <p>çŠ¶æ€æå‡æ˜¯ Compose çš„æ ¸å¿ƒæ¦‚å¿µï¼Œä½†æå‡çš„å±‚çº§éœ€è¦ä»”ç»†è€ƒè™‘ã€‚</p>
        <div class="code-bad"><pre><code>
        // âŒ é”™è¯¯ï¼šçŠ¶æ€æå‡ä¸è¶³ï¼Œç»„ä»¶ä¸å¯å¤ç”¨
@Composable
fun ProductCard(product: Product) {
    var isExpanded by remember { mutableStateOf(false) }  // å†…éƒ¨çŠ¶æ€
    // çˆ¶ç»„ä»¶æ— æ³•æ§åˆ¶å±•å¼€çŠ¶æ€
}

// âŒ é”™è¯¯ï¼šçŠ¶æ€æå‡è¿‡åº¦ï¼Œä¸å¿…è¦çš„å¤æ‚æ€§
@Composable
fun ProductList(products: List&lt;Product&gt;) {
    var expandedIds = remember { mutableSetOf&lt;Long&gt;() }  // ç®¡ç†æ‰€æœ‰å±•å¼€çŠ¶æ€
    
    products.forEach { product -&gt;
        ProductCard(
            product = product,
            isExpanded = expandedIds.contains(product.id),
            onExpandedChange = { /* å¤æ‚çš„æ›´æ–°é€»è¾‘ */ }
        )
    }
}

// âœ… æ­£ç¡®ï¼šå¹³è¡¡çš„çŠ¶æ€æå‡
@Composable
fun ProductCard(
    product: Product,
    isExpanded: Boolean = false,  // é»˜è®¤å€¼ï¼Œå¯é€‰çš„å—æ§çŠ¶æ€
    onExpandedChange: (Boolean) -&gt; Unit = {}  // å¯é€‰çš„å›è°ƒ
) {
    // å¦‚æœæ²¡æœ‰æä¾›å›è°ƒï¼Œä½¿ç”¨å†…éƒ¨çŠ¶æ€
    var internalExpanded by remember { mutableStateOf(false) }
    val expanded = if (onExpandedChange != {}) isExpanded else internalExpanded
    val onToggle = if (onExpandedChange != {}) onExpandedChange else { internalExpanded = !internalExpanded }
    
    // UI å®ç°...
}
        </code></pre></div>
        <h4>1.4 åœ¨ç»„åˆä¸­ä¿®æ”¹çŠ¶æ€</h4>
        <p>è¿™æ˜¯å¯¼è‡´æ— é™é‡ç»„çš„å¸¸è§åŸå› ã€‚</p>
        <div class="code-bad"><pre><code>
        // âŒ é”™è¯¯ï¼šåœ¨ç»„åˆä¸­ä¿®æ”¹çŠ¶æ€ï¼Œå¯¼è‡´æ— é™é‡ç»„
@Composable
fun InfiniteLoop() {
    var count by remember { mutableStateOf(0) }
    count++  // æ¯æ¬¡é‡ç»„éƒ½ä¿®æ”¹ï¼Œå¯¼è‡´æ— é™å¾ªç¯ï¼
    Text("Count: $count")
}

// âœ… æ­£ç¡®ï¼šåœ¨äº‹ä»¶ä¸­ä¿®æ”¹çŠ¶æ€
@Composable
fun FixedLoop() {
    var count by remember { mutableStateOf(0) }
    
    LaunchedEffect(Unit) {
        delay(1000)
        count++  // åœ¨åç¨‹ä¸­ä¿®æ”¹ï¼Œä¸ä¼šå¯¼è‡´æ— é™é‡ç»„
    }
    
    Text("Count: $count")
}
        </code></pre></div>
        <h4>1.5 çŠ¶æ€åŒæ­¥é—®é¢˜</h4>
        <p>å¤šä¸ªçŠ¶æ€æºå¯èƒ½å¯¼è‡´ UI ä¸ä¸€è‡´ã€‚</p>
        <div class="code-bad"><pre><code>
        // âŒ é”™è¯¯ï¼šçŠ¶æ€ä¸åŒæ­¥
@Composable
fun SyncProblem() {
    var name by remember { mutableStateOf("") }
    var displayName by remember { mutableStateOf("") }
    
    Column {
        TextField(
            value = name,
            onValueChange = { name = it }
        )
        Text("Display: $displayName")  // å¯èƒ½ä¸åŒæ­¥
    }
}

// âœ… æ­£ç¡®ï¼šå•ä¸€æ•°æ®æº
@Composable
fun FixedSync() {
    var name by remember { mutableStateOf("") }
    val displayName = name  // æ´¾ç”ŸçŠ¶æ€ï¼Œè‡ªåŠ¨åŒæ­¥
    
    Column {
        TextField(
            value = name,
            onValueChange = { name = it }
        )
        Text("Display: $displayName")
    }
}

// âœ… æˆ–è€…ä½¿ç”¨ derivedStateOf
@Composable
fun DerivedState() {
    var name by remember { mutableStateOf("") }
    val displayName by remember {
        derivedStateOf { name.uppercase() }
    }
    
    Column {
        TextField(value = name, onValueChange = { name = it })
        Text("Display: $displayName")
    }
}
        </code></pre></div>
        <h3 id="ii-æ€§èƒ½ä¼˜åŒ–é™·é˜±">II. æ€§èƒ½ä¼˜åŒ–é™·é˜±</h3>
        <p>æ€§èƒ½é—®é¢˜å¾€å¾€åœ¨é¡¹ç›®åæœŸæ‰æš´éœ²ï¼Œä½†å¾ˆå¤šé—®é¢˜å¯ä»¥åœ¨å¼€å‘é˜¶æ®µé¿å…ã€‚</p>
        <h4>2.1 å¿˜è®°ç¼“å­˜è®¡ç®—ç»“æœ</h4>
        <p>æ¯æ¬¡é‡ç»„éƒ½é‡æ–°è®¡ç®—æ˜‚è´µæ“ä½œä¼šä¸¥é‡å½±å“æ€§èƒ½ã€‚</p>
        <div class="code-bad"><pre><code>
        // âŒ é”™è¯¯ï¼šæ¯æ¬¡é‡ç»„éƒ½é‡æ–°è®¡ç®—
@Composable
fun ExpensiveList(items: List&lt;Item&gt;) {
    val sortedItems = items.sortedBy { it.name }  // æ¯æ¬¡éƒ½æ’åºï¼
    val filteredItems = sortedItems.filter { it.isActive }  // æ¯æ¬¡éƒ½è¿‡æ»¤ï¼
    
    LazyColumn {
        items(filteredItems) { item -&gt;
            ItemRow(item)
        }
    }
}

// âœ… æ­£ç¡®ï¼šä½¿ç”¨ remember ç¼“å­˜
@Composable
fun OptimizedList(items: List&lt;Item&gt;) {
    val sortedItems = remember(items) {
        items.sortedBy { it.name }
    }
    val filteredItems = remember(sortedItems) {
        sortedItems.filter { it.isActive }
    }
    
    LazyColumn {
        items(filteredItems) { item -&gt;
            ItemRow(item)
        }
    }
}

// âœ… æ›´ä¼˜é›…ï¼šä½¿ç”¨ derivedStateOf
@Composable
fun DerivedStateList(items: List&lt;Item&gt;) {
    val processedItems by remember {
        derivedStateOf {
            items.sortedBy { it.name }
                .filter { it.isActive }
        }
    }
    
    LazyColumn {
        items(processedItems) { item -&gt;
            ItemRow(item)
        }
    }
}
        </code></pre></div>
        <h4>2.2 ä¸å¿…è¦çš„é‡ç»„</h4>
        <p>æ²¡æœ‰æ­£ç¡®ä½¿ç”¨ç¨³å®šæ€§æ³¨è§£ä¼šå¯¼è‡´ä¸å¿…è¦çš„é‡ç»„ã€‚</p>
        <div class="code-bad"><pre><code>
        // âŒ é”™è¯¯ï¼šä¸ç¨³å®šçš„æ•°æ®ç±»
data class User(
    var name: String,  // var å¯¼è‡´ä¸ç¨³å®š
    var age: Int
)

@Composable
fun UserProfile(user: User) {
    // å³ä½¿ user æ²¡å˜ï¼Œä¹Ÿå¯èƒ½é‡ç»„
    Text(user.name)
}

// âœ… æ­£ç¡®ï¼šä½¿ç”¨ @Stable æˆ– @Immutable
@Stable
data class User(
    val name: String,  // val å±æ€§
    val age: Int
)

@Composable
fun UserProfile(user: User) {
    // ç°åœ¨å¯ä»¥æ­£ç¡®è·³è¿‡é‡ç»„
    Text(user.name)
}
        </code></pre></div>
        <h4>2.3 Lambda å¯¼è‡´çš„é‡ç»„</h4>
        <p>Lambda å‚æ•°æ¯æ¬¡éƒ½æ˜¯æ–°å®ä¾‹ï¼Œä¼šå¯¼è‡´æ¥æ”¶å®ƒçš„å‡½æ•°æ— æ³•è·³è¿‡ã€‚</p>
        <div class="code-bad"><pre><code>
        // âŒ é”™è¯¯ï¼šæ¯æ¬¡é‡ç»„éƒ½åˆ›å»ºæ–° Lambda
@Composable
fun MyScreen() {
    var count by remember { mutableStateOf(0) }
    
    Counter(
        count = count,
        onIncrement = { count++ }  // æ–° Lambda å®ä¾‹
    )
}

@Composable
fun Counter(count: Int, onIncrement: () -&gt; Unit) {
    // å³ä½¿ count æ²¡å˜ï¼ŒonIncrement æ˜¯æ–°å®ä¾‹ï¼Œæ— æ³•è·³è¿‡
    Button(onClick = onIncrement) {
        Text("Count: $count")
    }
}

// âœ… æ­£ç¡®ï¼šä½¿ç”¨ remember è®°å¿†åŒ– Lambda
@Composable
fun FixedScreen() {
    var count by remember { mutableStateOf(0) }
    
    val onIncrement = remember { { count++ } }
    // æˆ–è€…ä½¿ç”¨ rememberUpdatedStateï¼ˆå¦‚æœéœ€è¦æ•è·æœ€æ–°å€¼ï¼‰
    val onIncrementUpdated = rememberUpdatedState { count++ }
    
    Counter(
        count = count,
        onIncrement = onIncrement
    )
}

// âœ… æˆ–è€…å¯ç”¨ Strong Skipping Modeï¼ˆCompose 1.5.4+ï¼‰
// ç¼–è¯‘å™¨ä¼šè‡ªåŠ¨å¤„ç†
        </code></pre></div>
        <h4>2.4 åœ¨ LazyColumn ä¸­æ‰§è¡Œæ˜‚è´µæ“ä½œ</h4>
        <p>åœ¨åˆ—è¡¨é¡¹ä¸­æ‰§è¡Œæ˜‚è´µæ“ä½œä¼šå¯¼è‡´æ»šåŠ¨å¡é¡¿ã€‚</p>
        <div class="code-bad"><pre><code>
        // âŒ é”™è¯¯ï¼šåœ¨åˆ—è¡¨é¡¹ä¸­æ‰§è¡Œæ˜‚è´µæ“ä½œ
@Composable
fun ProductList(products: List&lt;Product&gt;) {
    LazyColumn {
        items(products) { product -&gt;
            // æ¯æ¬¡æ»šåŠ¨éƒ½å¯èƒ½é‡æ–°è®¡ç®—
            val formattedPrice = formatPrice(product.price)  // æ˜‚è´µæ“ä½œ
            ProductRow(product, formattedPrice)
        }
    }
}

// âœ… æ­£ç¡®ï¼šé¢„å…ˆå¤„ç†æ•°æ®
@Composable
fun OptimizedProductList(products: List&lt;Product&gt;) {
    val processedProducts = remember(products) {
        products.map { product -&gt;
            product.copy(
                formattedPrice = formatPrice(product.price)  // é¢„å…ˆæ ¼å¼åŒ–
            )
        }
    }
    
    LazyColumn {
        items(processedProducts) { product -&gt;
            ProductRow(product, product.formattedPrice)
        }
    }
}
        </code></pre></div>
        <h3 id="iii-åˆ—è¡¨æ¸²æŸ“é™·é˜±">III. åˆ—è¡¨æ¸²æŸ“é™·é˜±</h3>
        <p>åˆ—è¡¨æ˜¯å¤§å¤šæ•°åº”ç”¨çš„æ ¸å¿ƒï¼Œä¹Ÿæ˜¯æœ€å®¹æ˜“å‡ºç°æ€§èƒ½é—®é¢˜çš„åœ°æ–¹ã€‚</p>
        <h4>3.1 å¿˜è®°ä½¿ç”¨ key</h4>
        <p>æ²¡æœ‰ key ä¼šå¯¼è‡´åˆ—è¡¨é¡¹çŠ¶æ€é”™ä¹±ã€‚</p>
        <div class="code-bad"><pre><code>
        // âŒ é”™è¯¯ï¼šæ²¡æœ‰ keyï¼ŒçŠ¶æ€ä¼šé”™ä¹±
@Composable
fun ItemList(items: List&lt;Item&gt;) {
    LazyColumn {
        items(items) { item -&gt;
            ItemRow(item)  // å¦‚æœ items é¡ºåºæ”¹å˜ï¼ŒçŠ¶æ€ä¼šé”™ä¹±
        }
    }
}

// âœ… æ­£ç¡®ï¼šä½¿ç”¨ key
@Composable
fun FixedItemList(items: List&lt;Item&gt;) {
    LazyColumn {
        items(
            items = items,
            key = { it.id }  // ä½¿ç”¨å”¯ä¸€ ID
        ) { item -&gt;
            ItemRow(item)
        }
    }
}
        </code></pre></div>
        <h4>3.2 key ä¸ç¨³å®š</h4>
        <p>ä½¿ç”¨ä¸ç¨³å®šçš„å€¼ä½œä¸º key ä¼šå¯¼è‡´é—®é¢˜ã€‚</p>
        <div class="code-bad"><pre><code>
        // âŒ é”™è¯¯ï¼šä½¿ç”¨ä¸ç¨³å®šçš„ key
@Composable
fun UnstableKeyList(items: List&lt;Item&gt;) {
    LazyColumn {
        items(
            items = items,
            key = { it.hashCode() }  // hashCode å¯èƒ½é‡å¤
        ) { item -&gt;
            ItemRow(item)
        }
    }
}

// âœ… æ­£ç¡®ï¼šä½¿ç”¨ç¨³å®šçš„å”¯ä¸€æ ‡è¯†
@Composable
fun StableKeyList(items: List&lt;Item&gt;) {
    LazyColumn {
        items(
            items = items,
            key = { it.id }  // å”¯ä¸€ä¸”ç¨³å®šçš„ ID
        ) { item -&gt;
            ItemRow(item)
        }
    }
}
        </code></pre></div>
        <h4>3.3 åˆ—è¡¨é¡¹ä¸­çš„çŠ¶æ€ç®¡ç†</h4>
        <p>åœ¨åˆ—è¡¨é¡¹ä¸­åˆ›å»ºçŠ¶æ€å¯èƒ½å¯¼è‡´å†…å­˜æ³„æ¼æˆ–æ€§èƒ½é—®é¢˜ã€‚</p>
        <div class="code-bad"><pre><code>
        // âŒ é”™è¯¯ï¼šæ¯ä¸ªåˆ—è¡¨é¡¹éƒ½æœ‰ç‹¬ç«‹çŠ¶æ€ï¼Œå¯èƒ½å¯¼è‡´å†…å­˜é—®é¢˜
@Composable
fun ItemList(items: List&lt;Item&gt;) {
    LazyColumn {
        items(items) { item -&gt;
            var isExpanded by remember { mutableStateOf(false) }
            // å¦‚æœåˆ—è¡¨å¾ˆé•¿ï¼Œä¼šæœ‰å¾ˆå¤šçŠ¶æ€å¯¹è±¡
            ExpandableItemRow(item, isExpanded) { isExpanded = !isExpanded }
        }
    }
}

// âœ… æ­£ç¡®ï¼šçŠ¶æ€æå‡åˆ°åˆ—è¡¨çº§åˆ«
@Composable
fun OptimizedItemList(items: List&lt;Item&gt;) {
    var expandedIds by remember { mutableStateOf(setOf&lt;Long&gt;()) }
    
    LazyColumn {
        items(items) { item -&gt;
            ExpandableItemRow(
                item = item,
                isExpanded = expandedIds.contains(item.id),
                onExpandedChange = { expanded -&gt;
                    expandedIds = if (expanded) {
                        expandedIds + item.id
                    } else {
                        expandedIds - item.id
                    }
                }
            )
        }
    }
}
        </code></pre></div>
        <h4>3.4 åˆ—è¡¨æ›´æ–°å¯¼è‡´å…¨é‡é‡ç»„</h4>
        <p>æ›´æ–°åˆ—è¡¨æ—¶æ²¡æœ‰ä½¿ç”¨æ­£ç¡®çš„ API ä¼šå¯¼è‡´æ€§èƒ½é—®é¢˜ã€‚</p>
        <div class="code-bad"><pre><code>
        // âŒ é”™è¯¯ï¼šæ¯æ¬¡æ›´æ–°éƒ½åˆ›å»ºæ–°åˆ—è¡¨
@Composable
fun MutableListProblem() {
    val items = remember { mutableStateOf(mutableListOf&lt;Item&gt;()) }
    
    LazyColumn {
        items(items.value) { item -&gt;  // MutableList ä¸ç¨³å®š
            ItemRow(item)
        }
    }
    
    Button(onClick = {
        items.value.add(Item())  // ä¿®æ”¹åˆ—è¡¨
        items.value = items.value  // è§¦å‘é‡ç»„ï¼Œä½†å¯èƒ½ä¸å¿…è¦
    }) {
        Text("Add")
    }
}

// âœ… æ­£ç¡®ï¼šä½¿ç”¨ä¸å¯å˜åˆ—è¡¨
@Composable
fun ImmutableListSolution() {
    var items by remember { mutableStateOf(listOf&lt;Item&gt;()) }
    
    LazyColumn {
        items(items) { item -&gt;
            ItemRow(item)
        }
    }
    
    Button(onClick = {
        items = items + Item()  // åˆ›å»ºæ–°åˆ—è¡¨
    }) {
        Text("Add")
    }
}
        </code></pre></div>
        <h3 id="iv-å‰¯ä½œç”¨å¤„ç†é™·é˜±">IV. å‰¯ä½œç”¨å¤„ç†é™·é˜±</h3>
        <p>å‰¯ä½œç”¨ï¼ˆSide Effectsï¼‰æ˜¯ Compose ä¸­å®¹æ˜“å‡ºé”™çš„åœ°æ–¹ï¼Œéœ€è¦ä»”ç»†å¤„ç†ã€‚</p>
        <h4>4.1 LaunchedEffect çš„ key é”™è¯¯</h4>
        <p>key è®¾ç½®ä¸å½“ä¼šå¯¼è‡´å‰¯ä½œç”¨æ‰§è¡Œæ—¶æœºé”™è¯¯ã€‚</p>
        <div class="code-bad"><pre><code>
        // âŒ é”™è¯¯ï¼škey è®¾ç½®é”™è¯¯
@Composable
fun UserProfile(userId: String) {
    LaunchedEffect(Unit) {  // key æ˜¯ Unitï¼Œåªæ‰§è¡Œä¸€æ¬¡
        loadUser(userId)  // ä½† userId å˜åŒ–æ—¶ä¸ä¼šé‡æ–°åŠ è½½
    }
}

// âœ… æ­£ç¡®ï¼šä½¿ç”¨æ­£ç¡®çš„ key
@Composable
fun FixedUserProfile(userId: String) {
    LaunchedEffect(userId) {  // userId ä½œä¸º key
        loadUser(userId)  // userId å˜åŒ–æ—¶é‡æ–°åŠ è½½
    }
}
        </code></pre></div>
        <h4>4.2 å‰¯ä½œç”¨ä¸­çš„çŠ¶æ€æ›´æ–°</h4>
        <p>åœ¨å‰¯ä½œç”¨ä¸­æ›´æ–°çŠ¶æ€å¯èƒ½å¯¼è‡´æ— é™å¾ªç¯ã€‚</p>
        <div class="code-bad"><pre><code>
        // âŒ é”™è¯¯ï¼šå¯èƒ½å¯¼è‡´æ— é™å¾ªç¯
@Composable
fun InfiniteEffect() {
    var count by remember { mutableStateOf(0) }
    
    LaunchedEffect(count) {  // count å˜åŒ–è§¦å‘
        delay(1000)
        count++  // åˆè§¦å‘ LaunchedEffectï¼Œæ— é™å¾ªç¯
    }
    
    Text("Count: $count")
}

// âœ… æ­£ç¡®ï¼šä½¿ç”¨æ ‡å¿—ä½æˆ–æ¡ä»¶åˆ¤æ–­
@Composable
fun FixedEffect() {
    var count by remember { mutableStateOf(0) }
    var isRunning by remember { mutableStateOf(false) }
    
    LaunchedEffect(isRunning) {
        if (isRunning) {
            while (true) {
                delay(1000)
                count++
            }
        }
    }
    
    Column {
        Text("Count: $count")
        Button(onClick = { isRunning = !isRunning }) {
            Text(if (isRunning) "Stop" else "Start")
        }
    }
}
        </code></pre></div>
        <h4>4.3 å¿˜è®°æ¸…ç†èµ„æº</h4>
        <p>DisposableEffect ä¸­å¿˜è®°æ¸…ç†èµ„æºä¼šå¯¼è‡´å†…å­˜æ³„æ¼ã€‚</p>
        <div class="code-bad"><pre><code>
        // âŒ é”™è¯¯ï¼šæ²¡æœ‰æ¸…ç†èµ„æº
@Composable
fun ResourceLeak() {
    DisposableEffect(Unit) {
        val observer = object : Observer {
            override fun onChanged(value: Any) {
                // å¤„ç†å˜åŒ–
            }
        }
        dataSource.observe(observer)
        // å¿˜è®°ç§»é™¤ observerï¼
        onDispose { }
    }
}

// âœ… æ­£ç¡®ï¼šåœ¨ onDispose ä¸­æ¸…ç†
@Composable
fun FixedResource() {
    DisposableEffect(Unit) {
        val observer = object : Observer {
            override fun onChanged(value: Any) {
                // å¤„ç†å˜åŒ–
            }
        }
        dataSource.observe(observer)
        
        onDispose {
            dataSource.removeObserver(observer)  // æ¸…ç†
        }
    }
}
        </code></pre></div>
        <h4>4.4 åœ¨å‰¯ä½œç”¨ä¸­è®¿é—®æœ€æ–°å€¼</h4>
        <p>å‰¯ä½œç”¨ä¸­çš„é—­åŒ…å¯èƒ½æ•è·æ—§å€¼ã€‚</p>
        <div class="code-bad"><pre><code>
        // âŒ é”™è¯¯ï¼šæ•è·æ—§å€¼
@Composable
fun OldValueProblem(userId: String) {
    LaunchedEffect(Unit) {
        delay(5000)
        loadUser(userId)  // å¯èƒ½ä½¿ç”¨çš„æ˜¯æ—§çš„ userId
    }
}

// âœ… æ­£ç¡®ï¼šä½¿ç”¨ rememberUpdatedState
@Composable
fun FixedValueProblem(userId: String) {
    val currentUserId by rememberUpdatedState(userId)
    
    LaunchedEffect(Unit) {
        delay(5000)
        loadUser(currentUserId())  // ä½¿ç”¨æœ€æ–°çš„ userId
    }
}
        </code></pre></div>
        <h3 id="v-å†…å­˜æ³„æ¼é™·é˜±">V. å†…å­˜æ³„æ¼é™·é˜±</h3>
        <p>å†…å­˜æ³„æ¼åœ¨ Compose ä¸­å¯èƒ½ä¸é‚£ä¹ˆæ˜æ˜¾ï¼Œä½†ç¡®å®å­˜åœ¨ã€‚</p>
        <h4>5.1 åœ¨ Composable ä¸­æŒæœ‰ View å¼•ç”¨</h4>
        <p>æŒæœ‰ View å¼•ç”¨ä¼šå¯¼è‡´å†…å­˜æ³„æ¼ã€‚</p>
        <div class="code-bad"><pre><code>
        // âŒ é”™è¯¯ï¼šæŒæœ‰ View å¼•ç”¨
@Composable
fun ViewReferenceLeak() {
    val webView = remember { WebView(context) }
    
    AndroidView(
        factory = { webView },
        update = { }
    )
    // webView å¯èƒ½æŒæœ‰ Activity å¼•ç”¨
}

// âœ… æ­£ç¡®ï¼šä½¿ç”¨ DisposableEffect æ¸…ç†
@Composable
fun FixedViewReference() {
    val webView = remember { WebView(context) }
    
    DisposableEffect(Unit) {
        onDispose {
            webView.destroy()  // æ¸…ç† WebView
        }
    }
    
    AndroidView(
        factory = { webView },
        update = { }
    )
}
        </code></pre></div>
        <h4>5.2 åç¨‹æœªå–æ¶ˆ</h4>
        <p>é•¿æ—¶é—´è¿è¡Œçš„åç¨‹å¦‚æœæ²¡æœ‰æ­£ç¡®å–æ¶ˆä¼šå¯¼è‡´å†…å­˜æ³„æ¼ã€‚</p>
        <div class="code-bad"><pre><code>
        // âŒ é”™è¯¯ï¼šåç¨‹å¯èƒ½æœªå–æ¶ˆ
@Composable
fun CoroutineLeak() {
    LaunchedEffect(Unit) {
        while (true) {  // æ— é™å¾ªç¯
            delay(1000)
            // åšä¸€äº›å·¥ä½œ
        }
        // å¦‚æœ Composable è¢«ç§»é™¤ï¼Œè¿™ä¸ªåç¨‹å¯èƒ½è¿˜åœ¨è¿è¡Œ
    }
}

// âœ… æ­£ç¡®ï¼šLaunchedEffect ä¼šè‡ªåŠ¨å–æ¶ˆ
// ä½†å¦‚æœæ˜¯æ‰‹åŠ¨åˆ›å»ºçš„åç¨‹ï¼Œéœ€è¦ç¡®ä¿å–æ¶ˆ
@Composable
fun FixedCoroutine() {
    val scope = rememberCoroutineScope()
    
    DisposableEffect(Unit) {
        val job = scope.launch {
            while (true) {
                delay(1000)
                // åšä¸€äº›å·¥ä½œ
            }
        }
        
        onDispose {
            job.cancel()  // ç¡®ä¿å–æ¶ˆ
        }
    }
}
        </code></pre></div>
        <h4>5.3 é—­åŒ…æ•è·å¤§å¯¹è±¡</h4>
        <p>Lambda æ•è·å¤§å¯¹è±¡å¯èƒ½å¯¼è‡´å†…å­˜é—®é¢˜ã€‚</p>
        <div class="code-bad"><pre><code>
        // âŒ é”™è¯¯ï¼šæ•è·å¤§å¯¹è±¡
@Composable
fun LargeObjectCapture(largeData: LargeData) {
    LazyColumn {
        items(largeData.items) { item -&gt;
            Button(
                onClick = { 
                    processItem(item, largeData)  // æ•è· largeData
                }
            ) {
                Text(item.name)
            }
        }
    }
    // largeData è¢«æ‰€æœ‰ Lambda æ•è·ï¼Œæ— æ³•é‡Šæ”¾
}

// âœ… æ­£ç¡®ï¼šåªä¼ é€’éœ€è¦çš„éƒ¨åˆ†
@Composable
fun FixedLargeObject(largeData: LargeData) {
    val processor = remember(largeData) {
        ItemProcessor(largeData.config)  // åªä¿ç•™éœ€è¦çš„éƒ¨åˆ†
    }
    
    LazyColumn {
        items(largeData.items) { item -&gt;
            Button(
                onClick = { 
                    processor.process(item)  // ä¸æ•è· largeData
                }
            ) {
                Text(item.name)
            }
        }
    }
}
        </code></pre></div>
        <h3 id="vi-åŠ¨ç”»ä¸äº¤äº’é™·é˜±">VI. åŠ¨ç”»ä¸äº¤äº’é™·é˜±</h3>
        <p>åŠ¨ç”»å’Œäº¤äº’æ˜¯æå‡ç”¨æˆ·ä½“éªŒçš„å…³é”®ï¼Œä½†ä¹Ÿå®¹æ˜“å‡ºç°é—®é¢˜ã€‚</p>
        <h4>6.1 åŠ¨ç”»å¯¼è‡´æ€§èƒ½é—®é¢˜</h4>
        <p>å¤æ‚çš„åŠ¨ç”»å¯èƒ½å¯¼è‡´æ‰å¸§ã€‚</p>
        <div class="code-bad"><pre><code>
        // âŒ é”™è¯¯ï¼šåœ¨é‡ç»„ä¸­è®¡ç®—åŠ¨ç”»å€¼
@Composable
fun ExpensiveAnimation() {
    var target by remember { mutableStateOf(0f) }
    
    val animatedValue by animateFloatAsState(
        targetValue = target,
        animationSpec = tween(1000)
    )
    
    // æ¯æ¬¡é‡ç»„éƒ½é‡æ–°è®¡ç®—
    val complexValue = calculateComplexValue(animatedValue)  // æ˜‚è´µè®¡ç®—
    
    Box(modifier = Modifier.offset(animatedValue.dp)) {
        Text("Moving")
    }
}

// âœ… æ­£ç¡®ï¼šä½¿ç”¨ LaunchedEffect æˆ– remember
@Composable
fun OptimizedAnimation() {
    var target by remember { mutableStateOf(0f) }
    
    val animatedValue by animateFloatAsState(
        targetValue = target,
        animationSpec = tween(1000)
    )
    
    // ç¼“å­˜è®¡ç®—ç»“æœ
    val complexValue = remember(animatedValue) {
        calculateComplexValue(animatedValue)
    }
    
    Box(modifier = Modifier.offset(animatedValue.dp)) {
        Text("Moving")
    }
}
        </code></pre></div>
        <h4>6.2 æ‰‹åŠ¿å†²çª</h4>
        <p>å¤šä¸ªæ‰‹åŠ¿åŒæ—¶å­˜åœ¨å¯èƒ½å¯¼è‡´å†²çªã€‚</p>
        <div class="code-bad"><pre><code>
        // âŒ é”™è¯¯ï¼šæ‰‹åŠ¿å†²çª
@Composable
fun GestureConflict() {
    Box(
        modifier = Modifier
            .clickable { /* ç‚¹å‡» */ }
            .pointerInput(Unit) {
                detectDragGestures { /* æ‹–æ‹½ */ }
            }
    ) {
        Text("Content")
    }
    // ç‚¹å‡»å’Œæ‹–æ‹½å¯èƒ½å†²çª
}

// âœ… æ­£ç¡®ï¼šä½¿ç”¨æ¡ä»¶åˆ¤æ–­æˆ–ä¼˜å…ˆçº§
@Composable
fun FixedGesture() {
    var isDragging by remember { mutableStateOf(false) }
    
    Box(
        modifier = Modifier
            .pointerInput(Unit) {
                detectDragGestures(
                    onDragStart = { isDragging = true },
                    onDragEnd = { isDragging = false },
                    onDrag = { /* æ‹–æ‹½ */ }
                )
            }
            .then(
                if (!isDragging) {
                    Modifier.clickable { /* ç‚¹å‡» */ }
                } else {
                    Modifier
                }
            )
    ) {
        Text("Content")
    }
}
        </code></pre></div>
        <h3 id="vii-ä»£ç ç»„ç»‡é™·é˜±">VII. ä»£ç ç»„ç»‡é™·é˜±</h3>
        <p>è‰¯å¥½çš„ä»£ç ç»„ç»‡æ˜¯ç»´æŠ¤å¤§å‹é¡¹ç›®çš„å…³é”®ã€‚</p>
        <h4>7.1 Composable å‡½æ•°è¿‡å¤§</h4>
        <p>è¿‡å¤§çš„ Composable å‡½æ•°éš¾ä»¥ç»´æŠ¤å’Œæµ‹è¯•ã€‚</p>
        <div class="code-bad"><pre><code>
        // âŒ é”™è¯¯ï¼šä¸€ä¸ªå·¨å¤§çš„ Composable
@Composable
fun HugeScreen() {
    // 200+ è¡Œä»£ç 
    // åŒ…å«æ‰€æœ‰é€»è¾‘å’Œ UI
    // éš¾ä»¥æµ‹è¯•å’Œç»´æŠ¤
}

// âœ… æ­£ç¡®ï¼šæ‹†åˆ†ä¸ºå°çš„ Composable
@Composable
fun OrganizedScreen() {
    Column {
        HeaderSection()
        ContentSection()
        FooterSection()
    }
}

@Composable
fun HeaderSection() {
    // ç‹¬ç«‹çš„é€»è¾‘
}

@Composable
fun ContentSection() {
    // ç‹¬ç«‹çš„é€»è¾‘
}
        </code></pre></div>
        <h4>7.2 ä¸šåŠ¡é€»è¾‘æ··åœ¨ UI ä¸­</h4>
        <p>ä¸šåŠ¡é€»è¾‘åº”è¯¥æ”¾åœ¨ ViewModel æˆ–å…¶ä»–ä¸šåŠ¡å±‚ã€‚</p>
        <div class="code-bad"><pre><code>
        // âŒ é”™è¯¯ï¼šä¸šåŠ¡é€»è¾‘åœ¨ UI ä¸­
@Composable
fun ProductList() {
    val products = remember { mutableStateOf&lt;List&lt;Product&gt;&gt;(emptyList()) }
    
    LaunchedEffect(Unit) {
        // ä¸šåŠ¡é€»è¾‘æ··åœ¨ UI ä¸­
        val response = api.getProducts()
        products.value = response.data
    }
    
    LazyColumn {
        items(products.value) { product -&gt;
            ProductRow(product)
        }
    }
}

// âœ… æ­£ç¡®ï¼šä¸šåŠ¡é€»è¾‘åœ¨ ViewModel
@Composable
fun FixedProductList(viewModel: ProductViewModel = hiltViewModel()) {
    val uiState by viewModel.uiState.collectAsState()
    
    when (val state = uiState) {
        is ProductUiState.Loading -&gt; LoadingIndicator()
        is ProductUiState.Success -&gt; ProductListContent(state.products)
        is ProductUiState.Error -&gt; ErrorMessage(state.message)
    }
}
        </code></pre></div>
        <h4>7.3 é‡å¤ä»£ç </h4>
        <p>æ²¡æœ‰æå–å¯å¤ç”¨ç»„ä»¶å¯¼è‡´ä»£ç é‡å¤ã€‚</p>
        <div class="code-bad"><pre><code>
        // âŒ é”™è¯¯ï¼šé‡å¤ä»£ç 
@Composable
fun Screen1() {
    Column {
        Text("Title", style = MaterialTheme.typography.h5)
        Text("Subtitle", style = MaterialTheme.typography.body1)
        // é‡å¤çš„æ ·å¼å’Œç»“æ„
    }
}

@Composable
fun Screen2() {
    Column {
        Text("Title", style = MaterialTheme.typography.h5)
        Text("Subtitle", style = MaterialTheme.typography.body1)
        // ç›¸åŒçš„ä»£ç 
    }
}

// âœ… æ­£ç¡®ï¼šæå–å¯å¤ç”¨ç»„ä»¶
@Composable
fun TitleSection(title: String, subtitle: String) {
    Column {
        Text(title, style = MaterialTheme.typography.h5)
        Text(subtitle, style = MaterialTheme.typography.body1)
    }
}

@Composable
fun Screen1() {
    TitleSection("Title", "Subtitle")
}

@Composable
fun Screen2() {
    TitleSection("Title", "Subtitle")
}
        </code></pre></div>
        <h3 id="viii-è°ƒè¯•ä¸æ’æŸ¥æŠ€å·§">VIII. è°ƒè¯•ä¸æ’æŸ¥æŠ€å·§</h3>
        <p>æŒæ¡è°ƒè¯•æŠ€å·§å¯ä»¥å¿«é€Ÿå®šä½å’Œè§£å†³é—®é¢˜ã€‚</p>
        <h4>8.1 é‡ç»„è¿½è¸ª</h4>
        <p>ä½¿ç”¨é‡ç»„è®¡æ•°å™¨æ‰¾å‡ºä¸å¿…è¦çš„é‡ç»„ã€‚</p>
        <pre><code>
        @Composable
fun RecompositionTracker(name: String) {
    val recompositionCount = remember { mutableIntStateOf(0) }
    SideEffect {
        recompositionCount.intValue++
        Log.d("Recomposition", "$name recomposed ${recompositionCount.intValue} times")
    }
    
    // ä½ çš„ UI ä»£ç 
}
        </code></pre>
        <h4>8.2 æ€§èƒ½åˆ†æ</h4>
        <p>ä½¿ç”¨ Profiler åˆ†ææ€§èƒ½ç“¶é¢ˆã€‚</p>
        <pre><code>
        // åœ¨éœ€è¦åˆ†æçš„åœ°æ–¹æ·»åŠ æ ‡è®°
@Composable
fun ProfiledComponent() {
    if (BuildConfig.DEBUG) {
        Trace.beginSection("ProfiledComponent")
    }
    
    // ä½ çš„ä»£ç 
    
    if (BuildConfig.DEBUG) {
        Trace.endSection()
    }
}
        </code></pre>
        <h4>8.3 ç¨³å®šæ€§æ£€æŸ¥</h4>
        <p>å®šæœŸæ£€æŸ¥ç¼–è¯‘å™¨æŠ¥å‘Šï¼Œç¡®ä¿ç±»å‹ç¨³å®šã€‚</p>
        <pre><code>
        // build.gradle.kts
composeCompiler {
    reportsDestination = layout.buildDirectory.dir("compose_reports")
    metricsDestination = layout.buildDirectory.dir("compose_metrics")
}
        </code></pre>
        <h3 id="æ€»ç»“">æ€»ç»“</h3>
        <p>å®é™…é¡¹ç›®ä¸­çš„ Compose å¼€å‘éœ€è¦æ³¨æ„ï¼š</p>
        <ul>
        <li>âœ… <strong>çŠ¶æ€ç®¡ç†</strong>ï¼šæ­£ç¡®ä½¿ç”¨ rememberï¼Œé¿å…çŠ¶æ€é‡ç½®</li>
        <li>âœ… <strong>æ€§èƒ½ä¼˜åŒ–</strong>ï¼šç¼“å­˜è®¡ç®—ç»“æœï¼Œä½¿ç”¨ç¨³å®šæ€§æ³¨è§£</li>
        <li>âœ… <strong>åˆ—è¡¨æ¸²æŸ“</strong>ï¼šä½¿ç”¨ keyï¼Œé¿å…çŠ¶æ€é”™ä¹±</li>
        <li>âœ… <strong>å‰¯ä½œç”¨å¤„ç†</strong>ï¼šæ­£ç¡®è®¾ç½® keyï¼ŒåŠæ—¶æ¸…ç†èµ„æº</li>
        <li>âœ… <strong>å†…å­˜ç®¡ç†</strong>ï¼šé¿å…æŒæœ‰å¤§å¯¹è±¡ï¼ŒåŠæ—¶å–æ¶ˆåç¨‹</li>
        <li>âœ… <strong>ä»£ç ç»„ç»‡</strong>ï¼šæ‹†åˆ†å¤§å‡½æ•°ï¼Œæå–å¯å¤ç”¨ç»„ä»¶</li>
        </ul>
        <p>æŒæ¡è¿™äº›æŠ€å·§ï¼Œå¯ä»¥é¿å…å¤§éƒ¨åˆ†å¸¸è§é—®é¢˜ï¼Œå†™å‡ºæ›´å¥å£®ã€æ›´é«˜æ•ˆçš„ Compose ä»£ç ã€‚</p>
        <p>---</p>
        <h3 id="æ¨èé˜…è¯»">æ¨èé˜…è¯»</h3>
        <ul>
        <li><a href="https://developer.android.com/jetpack/compose/performance" target="_blank">Compose Performance - Android Developers</a></li>
        <li><a href="https://developer.android.com/jetpack/compose/best-practices" target="_blank">Compose Best Practices - Android Developers</a></li>
        <li><a href="https://developer.android.com/jetpack/compose/mental-model" target="_blank">Thinking in Compose - Android Developers</a></li>
        </ul>
        <div class="reference">
            <div class="reference-title">ğŸ“š å®˜æ–¹å‚è€ƒ</div>
            <a href="https://developer.android.com/jetpack/compose/performance" target="_blank">Compose Performance - Android Developers</a><br>
            <a href="https://developer.android.com/jetpack/compose/best-practices" target="_blank">Compose Best Practices - Android Developers</a><br>
            <a href="https://developer.android.com/jetpack/compose/mental-model" target="_blank">Thinking in Compose - Android Developers</a>
        </div>
    </article>

    <footer class="footer">
        <p>&copy; 2024 Fidroid. <a href="../index.html">è¿”å›é¦–é¡µ</a></p>
    </footer>
</body>
</html>
