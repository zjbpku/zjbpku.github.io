<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Compose Compiler æ·±åº¦å‰–æï¼šä»æºç åˆ°ä¼˜åŒ–çš„å®Œæ•´ä¹‹æ—… - Fidroid</title>
    <meta name="description" content="æ·±å…¥ç†è§£ Jetpack Compose ç¼–è¯‘å™¨çš„å·¥ä½œåŸç†ï¼Œæ¶µç›– IR è½¬æ¢æµç¨‹ã€ç¨³å®šæ€§æ¨æ–­ã€Restartable/Skippable æœºåˆ¶ã€Lambda è®°å¿†åŒ–ã€Strong Skipping Mode ç­‰æ ¸å¿ƒæ¦‚å¿µã€‚">
    <style>

        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            line-height: 1.8;
            color: #e5e7eb;
            background: #020617;
        }
        .navbar {
            background: rgba(15,23,42,0.98);
            backdrop-filter: blur(10px);
            position: fixed;
            top: 0;
            width: 100%;
            z-index: 1000;
        }
        .nav-container {
            max-width: 900px;
            margin: 0 auto;
            padding: 1rem 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .logo {
            font-size: 1.5rem;
            font-weight: bold;
            color: #38bdf8;
            text-decoration: none;
            letter-spacing: 0.08em;
            text-transform: uppercase;
        }
        .back-link { color: #9ca3af; text-decoration: none; font-size: 0.9rem; }
        .back-link:hover { color: #38bdf8; }

        .article-header {
            padding: 120px 20px 60px;
            background: radial-gradient(circle at top left, #7c3aed 0, transparent 50%),
                        radial-gradient(circle at bottom right, #0ea5e9 0, transparent 55%),
                        #020617;
            text-align: center;
        }
        .article-header h1 {
            max-width: 800px;
            margin: 0 auto 1rem;
            font-size: 2.5rem;
            font-weight: 800;
            letter-spacing: -0.03em;
            color: #fff;
        }
        .article-meta { color: #9ca3af; font-size: 0.9rem; margin-bottom: 1.5rem; }
        .article-tags { display: flex; justify-content: center; flex-wrap: wrap; gap: 0.5rem; }
        .article-tag {
            padding: 0.25rem 0.75rem;
            border-radius: 999px;
            font-size: 0.75rem;
            background: rgba(15,23,42,0.85);
            border: 1px solid rgba(124,58,237,0.4);
            color: #c4b5fd;
        }

        .article-content {
            max-width: 800px;
            margin: 0 auto;
            padding: 60px 20px 80px;
        }
        .article-content h2 {
            font-size: 1.6rem;
            margin: 2.5rem 0 1rem;
            color: #f9fafb;
            border-left: 4px solid #7c3aed;
            padding-left: 1rem;
        }
        .article-content h3 { font-size: 1.25rem; margin: 2rem 0 0.75rem; color: #e5e7eb; }
        .article-content p { margin-bottom: 1.25rem; color: #d1d5db; }
        .article-content ul, .article-content ol { margin: 1rem 0 1.5rem 1.5rem; color: #d1d5db; }
        .article-content li { margin-bottom: 0.5rem; }
        .article-content strong { color: #f9fafb; }
        .article-content a { color: #38bdf8; text-decoration: underline; }

        pre {
            background: #0f172a;
            border: 1px solid rgba(124,58,237,0.3);
            border-radius: 12px;
            padding: 1.25rem;
            overflow-x: auto;
            margin: 1.5rem 0;
            font-size: 0.85rem;
            line-height: 1.6;
        }
        code { font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, monospace; color: #e5e7eb; }
        .code-keyword { color: #c084fc; }
        .code-func { color: #38bdf8; }
        .code-type { color: #4ade80; }
        .code-string { color: #fb7185; }
        .code-comment { color: #6b7280; font-style: italic; }
        .code-number { color: #fbbf24; }

        .callout {
            background: rgba(124,58,237,0.1);
            border: 1px solid rgba(124,58,237,0.3);
            border-radius: 12px;
            padding: 1.25rem 1.5rem;
            margin: 1.5rem 0;
        }
        .callout-title { font-weight: 600; color: #c4b5fd; margin-bottom: 0.5rem; }
        .callout p { margin-bottom: 0; color: #d1d5db; }

        .callout-warning {
            background: rgba(245,158,11,0.1);
            border: 1px solid rgba(245,158,11,0.3);
        }
        .callout-warning .callout-title { color: #fcd34d; }

        .callout-info {
            background: rgba(14,165,233,0.1);
            border: 1px solid rgba(14,165,233,0.3);
        }
        .callout-info .callout-title { color: #7dd3fc; }

        .diagram {
            background: #0f172a;
            border: 1px solid rgba(124,58,237,0.3);
            border-radius: 12px;
            padding: 2rem;
            margin: 1.5rem 0;
            text-align: center;
            font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, monospace;
            font-size: 0.85rem;
            line-height: 1.8;
            color: #94a3b8;
            overflow-x: auto;
        }
        .diagram .highlight { color: #c084fc; font-weight: bold; }
        .diagram .data { color: #4ade80; }
        .diagram .gap { color: #f87171; }

        .reference {
            background: rgba(15,23,42,0.6);
            border: 1px solid rgba(148,163,184,0.2);
            border-radius: 8px;
            padding: 1rem 1.25rem;
            margin: 1rem 0;
            font-size: 0.9rem;
        }
        .reference-title {
            font-weight: 600;
            color: #94a3b8;
            font-size: 0.75rem;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            margin-bottom: 0.5rem;
        }
        .reference a { color: #38bdf8; }

        .footer {
            background: #020617;
            border-top: 1px solid #111827;
            padding: 2rem;
            text-align: center;
            color: #6b7280;
        }
        .footer a { color: #38bdf8; text-decoration: none; }
    
        .toc {
            background: rgba(15,23,42,0.6);
            border: 1px solid rgba(124,58,237,0.3);
            border-radius: 12px;
            padding: 1.5rem;
            margin: 2rem 0 3rem;
        }
        .toc-title {
            font-size: 1.1rem;
            font-weight: 600;
            color: #c4b5fd;
            margin-bottom: 1rem;
        }
        .toc-list {
            list-style: none;
            margin: 0;
            padding: 0;
        }
        .toc-list li {
            margin: 0.5rem 0;
        }
        .toc-h2 {
            margin-left: 0;
        }
        .toc-h3 {
            margin-left: 1.5rem;
            font-size: 0.9rem;
        }
        .toc-list a {
            color: #d1d5db;
            text-decoration: none;
        }
        .toc-list a:hover {
            color: #38bdf8;
        }
        .comparison-table {
            width: 100%;
            border-collapse: collapse;
            margin: 1.5rem 0;
            background: #0f172a;
            border-radius: 12px;
            overflow: hidden;
        }
        .comparison-table th,
        .comparison-table td {
            padding: 1rem;
            text-align: left;
            border-bottom: 1px solid rgba(124,58,237,0.2);
        }
        .comparison-table th {
            background: rgba(124,58,237,0.2);
            color: #c4b5fd;
            font-weight: 600;
        }
        .comparison-table tr:last-child td {
            border-bottom: none;
        }
        .callout-success {
            background: rgba(34,197,94,0.1);
            border: 1px solid rgba(34,197,94,0.3);
        }
        .callout-success .callout-title { color: #86efac; }
    </style>
</head>
<body>
    <nav class="navbar">
        <div class="nav-container">
            <a href="../index.html" class="logo">Fidroid</a>
            <a href="../index.html#blog" class="back-link">â† è¿”å›åšå®¢åˆ—è¡¨</a>
        </div>
    </nav>

    <header class="article-header">
        <h1>Compose Compiler æ·±åº¦å‰–æï¼šä»æºç åˆ°ä¼˜åŒ–çš„å®Œæ•´ä¹‹æ—…</h1>
        <p class="article-meta">2024-12-16 Â· 50-60 min Â· åŸç†æ·±åº¦è§£æ</p>
        <div class="article-tags">
            <span class="article-tag">Compose Compiler</span>
            <span class="article-tag">IR Transform</span>
            <span class="article-tag">Stability</span>
            <span class="article-tag">Restartable/Skippable</span>
            <span class="article-tag">Strong Skipping</span>
            <span class="article-tag">Lambda Memoization</span>
        </div>
    </header>

    <article class="article-content">
        <nav class="toc">
            <div class="toc-title">ğŸ“š ç›®å½•</div>
            <ul class="toc-list">
                <li class="toc-h2"><a href="#i-å¼•è¨€ä¸ºä»€ä¹ˆéœ€è¦-compose-compiler">I. å¼•è¨€ï¼šä¸ºä»€ä¹ˆéœ€è¦ Compose Compilerï¼Ÿ</a></li>
                <li class="toc-h2"><a href="#ii-ir-è½¬æ¢å®Œæ•´æµç¨‹">II. IR è½¬æ¢å®Œæ•´æµç¨‹</a></li>
                <li class="toc-h2"><a href="#iii-ç¨³å®šæ€§æ¨æ–­ç³»ç»Ÿ-stability-inference">III. ç¨³å®šæ€§æ¨æ–­ç³»ç»Ÿ</a></li>
                <li class="toc-h2"><a href="#iv-restartable-ä¸-skippable-æœºåˆ¶">IV. Restartable ä¸ Skippable æœºåˆ¶</a></li>
                <li class="toc-h2"><a href="#v-lambda-è®°å¿†åŒ–åŸç†">V. Lambda è®°å¿†åŒ–åŸç†</a></li>
                <li class="toc-h2"><a href="#vi-strong-skipping-mode-æ·±åº¦è§£æ">VI. Strong Skipping Mode æ·±åº¦è§£æ</a></li>
                <li class="toc-h2"><a href="#vii-ç¼–è¯‘å™¨æŠ¥å‘Šä¸è°ƒè¯•">VII. ç¼–è¯‘å™¨æŠ¥å‘Šä¸è°ƒè¯•</a></li>
                <li class="toc-h2"><a href="#viii-æ€»ç»“ä¸æœ€ä½³å®è·µ">VIII. æ€»ç»“ä¸æœ€ä½³å®è·µ</a></li>
            </ul>
        </nav>
<p>å½“ä½ å†™ä¸‹ç¬¬ä¸€ä¸ª <code>@Composable</code> å‡½æ•°æ—¶ï¼Œå¯èƒ½ä¸ä¼šæ„è¯†åˆ° Compose ç¼–è¯‘å™¨åœ¨èƒŒååšäº†å¤§é‡å·¥ä½œã€‚ä»ç®€å•çš„å‡½æ•°è°ƒç”¨åˆ°å¤æ‚çš„é‡ç»„ä¼˜åŒ–ï¼Œè¿™ä¸€åˆ‡éƒ½ä¾èµ–äº Compose Compiler Plugin çš„å¼ºå¤§èƒ½åŠ›ã€‚æœ¬æ–‡å°†å¸¦ä½ æ·±å…¥æ¢ç´¢è¿™ä¸ªç¼–è¯‘å™¨çš„å†…éƒ¨æœºåˆ¶ï¼Œç†è§£å®ƒå¦‚ä½•å°†ä½ çš„ Kotlin ä»£ç è½¬æ¢ä¸ºé«˜æ•ˆçš„è¿è¡Œæ—¶å®ç°ã€‚</p>
        <h3 id="-å®˜æ–¹å‚è€ƒ">ğŸ“š å®˜æ–¹å‚è€ƒ</h3>
        <ul>
        <li><a href="https://developer.android.com/jetpack/compose/mental-model" target="_blank">Thinking in Compose - Android Developers</a></li>
        <li><a href="https://cs.android.com/androidx/platform/frameworks/support/+/androidx-main:compose/compiler/compiler-hosted/" target="_blank">Compose Compiler Source Code</a></li>
        </ul>
        <h3 id="ç›®å½•">ç›®å½•</h3>
        <ul>
        <li><a href="#i-å¼•è¨€ä¸ºä»€ä¹ˆéœ€è¦-compose-compiler" target="_blank">I. å¼•è¨€ï¼šä¸ºä»€ä¹ˆéœ€è¦ Compose Compilerï¼Ÿ</a></li>
        <li><a href="#ii-ir-è½¬æ¢å®Œæ•´æµç¨‹" target="_blank">II. IR è½¬æ¢å®Œæ•´æµç¨‹</a></li>
        <li><a href="#iii-ç¨³å®šæ€§æ¨æ–­ç³»ç»Ÿ-stability-inference" target="_blank">III. ç¨³å®šæ€§æ¨æ–­ç³»ç»Ÿ</a></li>
        <li><a href="#iv-restartable-ä¸-skippable-æœºåˆ¶" target="_blank">IV. Restartable ä¸ Skippable æœºåˆ¶</a></li>
        <li><a href="#v-lambda-è®°å¿†åŒ–åŸç†" target="_blank">V. Lambda è®°å¿†åŒ–åŸç†</a></li>
        <li><a href="#vi-strong-skipping-mode-æ·±åº¦è§£æ" target="_blank">VI. Strong Skipping Mode æ·±åº¦è§£æ</a></li>
        <li><a href="#vii-ç¼–è¯‘å™¨æŠ¥å‘Šä¸è°ƒè¯•" target="_blank">VII. ç¼–è¯‘å™¨æŠ¥å‘Šä¸è°ƒè¯•</a></li>
        <li><a href="#viii-æ€»ç»“ä¸æœ€ä½³å®è·µ" target="_blank">VIII. æ€»ç»“ä¸æœ€ä½³å®è·µ</a></li>
        </ul>
        <h3 id="i-å¼•è¨€ä¸ºä»€ä¹ˆéœ€è¦-compose-compiler">I. å¼•è¨€ï¼šä¸ºä»€ä¹ˆéœ€è¦ Compose Compilerï¼Ÿ</h3>
        <p>Compose å£°æ˜å¼ UI ä¸ä¼ ç»Ÿå‘½ä»¤å¼çš„æœ¬è´¨åŒºåˆ«åœ¨äºï¼šä½ æè¿° UI åº”è¯¥æ˜¯ä»€ä¹ˆæ ·å­ï¼Œè€Œä¸æ˜¯å¦‚ä½•ä¿®æ”¹å®ƒã€‚è¿™ç§è½¬å˜å¸¦æ¥äº†é©å‘½æ€§çš„ä¼˜åŠ¿ï¼Œä½†ä¹Ÿéœ€è¦ä¸€ä¸ªå¼ºå¤§çš„ç¼–è¯‘å™¨æ¥æ”¯æŒã€‚</p>
        <h4>Compose å£°æ˜å¼ UI ä¸ä¼ ç»Ÿå‘½ä»¤å¼çš„æœ¬è´¨åŒºåˆ«</h4>
        <p>ä¼ ç»Ÿçš„ Android View ç³»ç»Ÿé‡‡ç”¨<strong>å‘½ä»¤å¼</strong>ç¼–ç¨‹æ¨¡å‹ï¼šä½ åˆ›å»º View å¯¹è±¡ï¼ŒæŒæœ‰å®ƒä»¬çš„å¼•ç”¨ï¼Œç„¶åé€šè¿‡æ–¹æ³•è°ƒç”¨æ¥ä¿®æ”¹å®ƒä»¬çš„çŠ¶æ€ã€‚è¿™ç§æ–¹å¼ç›´è§‚ï¼Œä½†å­˜åœ¨æ˜æ˜¾çš„æ€§èƒ½å’Œç»´æŠ¤é—®é¢˜ï¼š</p>
        <ul>
        <li><strong>çŠ¶æ€åŒæ­¥å›°éš¾</strong>ï¼šUI çŠ¶æ€åˆ†æ•£åœ¨å„ä¸ª View å¯¹è±¡ä¸­ï¼Œéš¾ä»¥ä¿è¯ä¸€è‡´æ€§</li>
        <li><strong>æ€§èƒ½å¼€é”€å¤§</strong>ï¼šæ¯æ¬¡æ›´æ–°éƒ½éœ€è¦éå† View æ ‘ï¼Œæ‰¾åˆ°ç›®æ ‡ View å¹¶ä¿®æ”¹</li>
        <li><strong>å†…å­˜å ç”¨é«˜</strong>ï¼šæ¯ä¸ª View éƒ½æ˜¯ç‹¬ç«‹çš„å¯¹è±¡ï¼ŒæŒæœ‰å¤§é‡çŠ¶æ€</li>
        </ul>
        <p>Compose é‡‡ç”¨äº†<strong>å£°æ˜å¼</strong>æ¨¡å‹ï¼šä½ æè¿° UI åº”è¯¥æ˜¯ä»€ä¹ˆæ ·å­ï¼Œè€Œä¸æ˜¯å¦‚ä½•ä¿®æ”¹å®ƒã€‚è¿™ç§è½¬å˜å¸¦æ¥äº†é©å‘½æ€§çš„ä¼˜åŠ¿ï¼Œä½†ä¹Ÿéœ€è¦ä¸€ä¸ªå¼ºå¤§çš„ç¼–è¯‘å™¨æ¥æ”¯æŒï¼š</p>
        <div class="callout callout-info">
        <p class="callout-title">æ ¸å¿ƒæ´å¯Ÿ</p>
        <p>ğŸ’¡</p>
        <p>Compose çš„å£°æ˜å¼æ¨¡å‹è¦æ±‚ç¼–è¯‘å™¨èƒ½å¤Ÿï¼š</p>
        <p>- è¿½è¸ªå‡½æ•°è°ƒç”¨å’Œå‚æ•°å˜åŒ–</p>
        <p>- è‡ªåŠ¨æ¨æ–­å“ªäº›éƒ¨åˆ†å¯ä»¥è·³è¿‡é‡ç»„</p>
        <p>- ä¼˜åŒ– Lambda è¡¨è¾¾å¼çš„è®°å¿†åŒ–</p>
        <p>- ç”Ÿæˆé«˜æ•ˆçš„è¿è¡Œæ—¶ä»£ç </p>
        </div>
        <h4>ç¼–è¯‘å™¨æ’ä»¶åœ¨ Compose æ¶æ„ä¸­çš„æ ¸å¿ƒåœ°ä½</h4>
        <p>Compose Compiler Plugin æ˜¯ Compose æ¶æ„çš„æ ¸å¿ƒç»„ä»¶ï¼Œå®ƒå·¥ä½œåœ¨ Kotlin ç¼–è¯‘å™¨çš„ IRï¼ˆIntermediate Representationï¼‰å±‚é¢ï¼Œåœ¨æºç å’Œå­—èŠ‚ç ä¹‹é—´è¿›è¡Œè½¬æ¢ã€‚è¿™ä¸ªæ’ä»¶è´Ÿè´£ï¼š</p>
        <ol>
        <li><strong>å‡½æ•°è½¬æ¢</strong>ï¼šå°† <code>@Composable</code> å‡½æ•°è½¬æ¢ä¸ºå¸¦æœ‰ <code>$composer</code> å‚æ•°çš„ç‰ˆæœ¬</li>
        <li><strong>ç¨³å®šæ€§æ¨æ–­</strong>ï¼šåˆ†æç±»å‹ç³»ç»Ÿï¼Œæ¨æ–­å“ªäº›ç±»å‹æ˜¯ç¨³å®šçš„</li>
        <li><strong>è·³è¿‡ä¼˜åŒ–</strong>ï¼šç”Ÿæˆä»£ç æ¥æ£€æµ‹å‚æ•°å˜åŒ–ï¼Œå®ç°æ™ºèƒ½è·³è¿‡</li>
        <li><strong>Lambda å¤„ç†</strong>ï¼šè‡ªåŠ¨åŒ…è£…éœ€è¦è®°å¿†åŒ–çš„ Lambda è¡¨è¾¾å¼</li>
        </ol>
        <pre><code>
        Compose æ¶æ„å±‚æ¬¡
        
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚   Kotlin Source Code                â”‚
        â”‚   @Composable fun MyComponent()     â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚   Compose Compiler Plugin           â”‚
        â”‚   â€¢ IR Transformation                â”‚
        â”‚   â€¢ Stability Inference              â”‚
        â”‚   â€¢ Skip Logic Generation            â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚   Transformed IR                     â”‚
        â”‚   fun MyComponent($composer, ...)   â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚   Bytecode                           â”‚
        â”‚   (JVM/Android Runtime)             â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        </code></pre>
        <h4>æœ¬æ–‡å°†å›ç­”çš„å…³é”®é—®é¢˜</h4>
        <p>é€šè¿‡æœ¬æ–‡ï¼Œä½ å°†ç†è§£ï¼š</p>
        <ul>
        <li>ç¼–è¯‘å™¨å¦‚ä½•å°†ä½ çš„ <code>@Composable</code> å‡½æ•°è½¬æ¢ä¸ºè¿è¡Œæ—¶ä»£ç ï¼Ÿ</li>
        <li>ç¨³å®šæ€§æ¨æ–­ç³»ç»Ÿå¦‚ä½•å·¥ä½œï¼Œä¸ºä»€ä¹ˆæŸäº›ç±»å‹è¢«æ ‡è®°ä¸ºä¸ç¨³å®šï¼Ÿ</li>
        <li>Restartable å’Œ Skippable æœºåˆ¶å¦‚ä½•å®ç°æ™ºèƒ½é‡ç»„ä¼˜åŒ–ï¼Ÿ</li>
        <li>Lambda è¡¨è¾¾å¼ä¸ºä»€ä¹ˆéœ€è¦ç‰¹æ®Šå¤„ç†ï¼Œç¼–è¯‘å™¨å¦‚ä½•è‡ªåŠ¨ä¼˜åŒ–ï¼Ÿ</li>
        <li>Strong Skipping Mode å¸¦æ¥äº†å“ªäº›æ”¹è¿›ï¼Œå¦‚ä½•æ­£ç¡®ä½¿ç”¨ï¼Ÿ</li>
        <li>å¦‚ä½•åˆ©ç”¨ç¼–è¯‘å™¨æŠ¥å‘Šæ¥è¯Šæ–­å’Œä¼˜åŒ–æ€§èƒ½é—®é¢˜ï¼Ÿ</li>
        </ul>
        <h3 id="ii-ir-è½¬æ¢å®Œæ•´æµç¨‹">II. IR è½¬æ¢å®Œæ•´æµç¨‹</h3>
        <p>Compose Compiler Plugin å·¥ä½œåœ¨ Kotlin ç¼–è¯‘å™¨çš„ IR å±‚é¢ï¼Œè¿™æ˜¯ç†è§£æ•´ä¸ªè½¬æ¢æµç¨‹çš„å…³é”®ã€‚è®©æˆ‘ä»¬ä» Kotlin æºç åˆ°æœ€ç»ˆå­—èŠ‚ç çš„å®Œæ•´è·¯å¾„å¼€å§‹ã€‚</p>
        <pre><code>
        IR è½¬æ¢å®Œæ•´æµç¨‹
        
        Kotlin Source
            â”‚
            â–¼
        Frontend (Parser, Type Checker)
            â”‚
            â–¼
        IR (Intermediate Representation)
            â”‚
            â–¼
        Compose Plugin (IR Transformation)
            â”‚  â€¢ ComposableFunctionBodyTransformer
            â”‚  â€¢ ComposerParamTransformer
            â”‚  â€¢ LiveLiteralTransformer
            â”‚
            â–¼
        Transformed IR
            â”‚
            â–¼
        Backend (Code Generator)
            â”‚
            â–¼
        Bytecode
        </code></pre>
        <h4>2.1 Compose Compiler Plugin æ¶æ„</h4>
        <p>Compose Compiler Plugin é€šè¿‡ Kotlin ç¼–è¯‘å™¨çš„æ’ä»¶æœºåˆ¶é›†æˆï¼Œä¸»è¦å…¥å£æ˜¯ <code>ComposeIrGenerationExtension</code>ã€‚è¿™ä¸ªæ‰©å±•åœ¨ IR ç”Ÿæˆé˜¶æ®µè¢«è°ƒç”¨ï¼Œè´Ÿè´£æ³¨å†Œå„ç§ IR è½¬æ¢å™¨ã€‚</p>
        <pre><code>
        // Compose Compiler Plugin å…¥å£ï¼ˆç®€åŒ–ç‰ˆï¼‰
        class ComposeIrGenerationExtension : IrGenerationExtension {
            override fun generate(
                moduleFragment: IrModuleFragment,
                pluginContext: IrPluginContext
            ) {
                // æ³¨å†Œå„ç§ IR è½¬æ¢å™¨
                val transformer = ComposableFunctionBodyTransformer(pluginContext)
                val paramTransformer = ComposerParamTransformer(pluginContext)
                val liveLiteralTransformer = LiveLiteralTransformer(pluginContext)
                
                // æŒ‰é¡ºåºæ‰§è¡Œè½¬æ¢
                moduleFragment.transformChildren(transformer, null)
                moduleFragment.transformChildren(paramTransformer, null)
                moduleFragment.transformChildren(liveLiteralTransformer, null)
            }
        }
        </code></pre>
        <h5>Lowering Phases è®¾è®¡</h5>
        <p>Kotlin ç¼–è¯‘å™¨ä½¿ç”¨ Lowering Phases æ¥ç»„ç»‡ IR è½¬æ¢ã€‚æ¯ä¸ª Phase è´Ÿè´£ç‰¹å®šçš„è½¬æ¢ä»»åŠ¡ï¼ŒCompose Plugin æ³¨å†Œäº†å¤šä¸ªè‡ªå®šä¹‰ Phaseï¼š</p>
        <ul>
        <li><strong>Phase 1: Composer Parameter Injection</strong>ï¼šä¸º <code>@Composable</code> å‡½æ•°æ³¨å…¥ <code>$composer</code> å‚æ•°</li>
        <li><strong>Phase 2: Function Body Transformation</strong>ï¼šè½¬æ¢å‡½æ•°ä½“ï¼Œæ·»åŠ  Group ç®¡ç†å’Œè·³è¿‡é€»è¾‘</li>
        <li><strong>Phase 3: Stability Inference</strong>ï¼šæ¨æ–­ç±»å‹ç¨³å®šæ€§ï¼Œç”Ÿæˆ <code>$stable</code> ä¿¡æ¯</li>
        <li><strong>Phase 4: Skip Logic Generation</strong>ï¼šç”Ÿæˆå‚æ•°å˜åŒ–æ£€æµ‹å’Œè·³è¿‡ä»£ç </li>
        <li><strong>Phase 5: Lambda Memoization</strong>ï¼šå¤„ç† Lambda è¡¨è¾¾å¼çš„è®°å¿†åŒ–</li>
        </ul>
        <div class="callout callout">
        <p class="callout-title">ä¸ºä»€ä¹ˆä½¿ç”¨ IRï¼Ÿ</p>
        <p>ğŸ”¬</p>
        <p>IRï¼ˆIntermediate Representationï¼‰æ˜¯ç¼–è¯‘å™¨åœ¨æºç å’Œå­—èŠ‚ç ä¹‹é—´çš„ä¸­é—´è¡¨ç¤ºã€‚ä½¿ç”¨ IR è€Œä¸æ˜¯ç›´æ¥æ“ä½œ ASTï¼ˆæŠ½è±¡è¯­æ³•æ ‘ï¼‰æˆ–å­—èŠ‚ç çš„ä¼˜åŠ¿åœ¨äºï¼š</p>
        <p>- <strong>ç±»å‹ä¿¡æ¯å®Œæ•´</strong>ï¼šIR ä¿ç•™äº†å®Œæ•´çš„ç±»å‹ä¿¡æ¯ï¼Œä¾¿äºè¿›è¡Œç±»å‹æ¨æ–­å’Œä¼˜åŒ–</p>
        <p>- <strong>ç»“æ„æ¸…æ™°</strong>ï¼šIR çš„ç»“æ„æ›´é€‚åˆè¿›è¡Œç¨‹åºåˆ†æå’Œè½¬æ¢</p>
        <p>- <strong>å¹³å°æ— å…³</strong>ï¼šåŒæ ·çš„ IR å¯ä»¥ç”Ÿæˆ JVMã€Native æˆ– JS ä»£ç </p>
        </div>
        <h4>2.2 å…³é”®è½¬æ¢æ­¥éª¤</h4>
        <h5>ComposableFunctionBodyTransformerï¼šå‡½æ•°ä½“è½¬æ¢</h5>
        <p>è¿™æ˜¯æœ€æ ¸å¿ƒçš„è½¬æ¢å™¨ï¼Œè´Ÿè´£å°†æ™®é€šçš„å‡½æ•°ä½“è½¬æ¢ä¸º Compose è¿è¡Œæ—¶éœ€è¦çš„ç»“æ„ã€‚ä¸»è¦å·¥ä½œåŒ…æ‹¬ï¼š</p>
        <ol>
        <li>åœ¨å‡½æ•°å¼€å§‹å¤„æ’å…¥ <code>startRestartGroup</code> è°ƒç”¨</li>
        <li>åœ¨å‡½æ•°ç»“æŸå¤„æ’å…¥ <code>endRestartGroup</code> è°ƒç”¨</li>
        <li>ä¸ºæ¯ä¸ª Composable è°ƒç”¨æ·»åŠ  Group Key</li>
        <li>ç”Ÿæˆè·³è¿‡é€»è¾‘ï¼ˆå¦‚æœå‚æ•°ç¨³å®šï¼‰</li>
        </ol>
        <pre><code>
        // è½¬æ¢å‰ï¼šä½ å†™çš„ä»£ç 
        @Composable
        fun Greeting(name: String) {
            Text("Hello, $name")
            Button(onClick = {}) {
                Text("Click me")
            }
        }
        
        // è½¬æ¢åï¼šç¼–è¯‘å™¨ç”Ÿæˆçš„ä»£ç ï¼ˆç®€åŒ–ç‰ˆï¼‰
        fun Greeting(
            name: String,
            $composer: Composer,
            $changed: Int
        ) {
            // å¼€å§‹ Groupï¼Œä½¿ç”¨åŸºäºæºç ä½ç½®çš„å”¯ä¸€ Key
            $composer.startRestartGroup(0x12345678)
            
            // è·³è¿‡é€»è¾‘ï¼ˆå¦‚æœæ‰€æœ‰å‚æ•°éƒ½ç¨³å®šä¸”æœªå˜åŒ–ï¼‰
            if ($changed == 0 &amp;&amp; $composer.skipping) {
                $composer.skipToGroupEnd()
                return
            }
            
            // è½¬æ¢åçš„ Composable è°ƒç”¨
            Text(
                "Hello, $name",
                $composer,
                0b00000001  // $changed ä½æ©ç 
            )
            Button(
                onClick = {},
                $composer,
                0b00000010,
                content = { Text("Click me", $composer, 0) }
            )
            
            // ç»“æŸ Groupï¼Œè¿”å›æ›´æ–° Scope
            $composer.endRestartGroup()?.updateScope { 
                Greeting(name, $composer, $changed or 1) 
            }
        }
        </code></pre>
        <h5>ComposerParamTransformerï¼šå‚æ•°æ³¨å…¥</h5>
        <p>è¿™ä¸ªè½¬æ¢å™¨è´Ÿè´£ä¸ºæ‰€æœ‰ <code>@Composable</code> å‡½æ•°æ³¨å…¥å¿…è¦çš„å‚æ•°ï¼š</p>
        <ul>
        <li><code>$composer: Composer</code>ï¼šç”¨äºè®¿é—® Slot Table å’Œæ‰§è¡Œç»„åˆæ“ä½œ</li>
        <li><code>$changed: Int</code>ï¼šä½æ©ç ï¼Œè¡¨ç¤ºå“ªäº›å‚æ•°å‘ç”Ÿäº†å˜åŒ–</li>
        <li><code>$default: Int</code>ï¼ˆå¯é€‰ï¼‰ï¼šç”¨äºé»˜è®¤å‚æ•°çš„å¤„ç†</li>
        </ul>
        <div class="callout callout-warning">
        <p class="callout-title">å‚æ•°é¡ºåºçš„é‡è¦æ€§</p>
        <p>âš ï¸</p>
        <p>ç¼–è¯‘å™¨æ³¨å…¥çš„å‚æ•°å¿…é¡»æŒ‰ç…§ç‰¹å®šé¡ºåºæ’åˆ—ï¼Œä¸”ä¸èƒ½ä¸ç”¨æˆ·å®šä¹‰çš„å‚æ•°å†²çªã€‚è¿™æ˜¯ä¸ºä»€ä¹ˆ <code>@Composable</code> å‡½æ•°ä¸èƒ½æœ‰æŸäº›ç‰¹å®šåç§°çš„å‚æ•°ã€‚</p>
        </div>
        <h5>LiveLiteralTransformerï¼šLive Edit æ”¯æŒ</h5>
        <p>è¿™ä¸ªè½¬æ¢å™¨æ”¯æŒ Android Studio çš„ Live Edit åŠŸèƒ½ï¼Œå…è®¸åœ¨è¿è¡Œæ—¶ä¿®æ”¹æŸäº›å­—é¢é‡å€¼ï¼ˆå¦‚å­—ç¬¦ä¸²ã€æ•°å­—ï¼‰è€Œæ— éœ€å®Œå…¨é‡æ–°ç¼–è¯‘ã€‚</p>
        <pre><code>
        // è½¬æ¢å‰
        @Composable
        fun Example() {
            Text("Hello")  // å­—é¢é‡
        }
        
        // è½¬æ¢åï¼ˆå¯ç”¨ Live Editï¼‰
        @Composable
        fun Example($composer: Composer) {
            val liveString = $composer.liveLiteral("Hello")
            Text(liveString, $composer, 0)
        }
        </code></pre>
        <h4>2.3 ä»£ç ç¤ºä¾‹ï¼šè½¬æ¢å‰åå¯¹æ¯”</h4>
        <p>è®©æˆ‘ä»¬çœ‹ä¸€ä¸ªæ›´å¤æ‚çš„ä¾‹å­ï¼Œå±•ç¤ºç¼–è¯‘å™¨å¦‚ä½•å¤„ç†åµŒå¥—çš„ Composable è°ƒç”¨å’Œæ¡ä»¶é€»è¾‘ï¼š</p>
        <pre><code>
        // è½¬æ¢å‰ï¼šåŸå§‹ä»£ç 
        @Composable
        fun UserProfile(user: User, showDetails: Boolean) {
            Column {
                Text(text = user.name)
                if (showDetails) {
                    Text(text = user.email)
                    Text(text = user.bio)
                }
            }
        }
        
        // è½¬æ¢åï¼šç¼–è¯‘å™¨ç”Ÿæˆçš„ä»£ç ï¼ˆç®€åŒ–ç‰ˆï¼Œå±•ç¤ºå…³é”®éƒ¨åˆ†ï¼‰
        fun UserProfile(
            user: User,
            showDetails: Boolean,
            $composer: Composer,
            $changed: Int
        ) {
            $composer.startRestartGroup(0xABCD1234)
            
            // å‚æ•°å˜åŒ–æ£€æµ‹ï¼ˆç®€åŒ–ï¼‰
            val changedUser = $changed and 0b00000001 != 0
            val changedShowDetails = $changed and 0b00000010 != 0
            
            if (!changedUser &amp;&amp; !changedShowDetails &amp;&amp; $composer.skipping) {
                $composer.skipToGroupEnd()
                return
            }
            
            // è½¬æ¢åçš„ Column è°ƒç”¨
            Column(
                $composer = $composer,
                $changed = 0,
                content = {
                    Text(
                        text = user.name,
                        $composer = $composer,
                        $changed = if (changedUser) 0b00000001 else 0
                    )
                    
                    // æ¡ä»¶é€»è¾‘ï¼šç¼–è¯‘å™¨ä¼šä¸ºæ¯ä¸ªåˆ†æ”¯ç”Ÿæˆä¸åŒçš„ Group Key
                    if (showDetails) {
                        $composer.startRestartGroup(0xEF567890)  // if åˆ†æ”¯çš„ Key
                        Text(text = user.email, $composer, 0)
                        Text(text = user.bio, $composer, 0)
                        $composer.endRestartGroup()
                    } else {
                        $composer.startRestartGroup(0xEF567891)  // else åˆ†æ”¯çš„ Keyï¼ˆå¦‚æœå­˜åœ¨ï¼‰
                        $composer.endRestartGroup()
                    }
                }
            )
            
            $composer.endRestartGroup()?.updateScope {
                UserProfile(user, showDetails, $composer, $changed or 0b00000011)
            }
        }
        </code></pre>
        <div class="callout callout-info">
        <p class="callout-title">å…³é”®è§‚å¯Ÿ</p>
        <p>ğŸ’¡</p>
        <p>ä»è¿™ä¸ªä¾‹å­å¯ä»¥çœ‹å‡ºï¼š</p>
        <p>- æ¯ä¸ª Composable è°ƒç”¨éƒ½æœ‰è‡ªå·±çš„ Group Keyï¼ŒåŸºäºæºç ä½ç½®ç”Ÿæˆ</p>
        <p>- æ¡ä»¶åˆ†æ”¯ä¼šç”Ÿæˆä¸åŒçš„ Group Keyï¼Œç¡®ä¿ä½ç½®è®°å¿†åŒ–çš„æ­£ç¡®æ€§</p>
        <p>- <code>$changed</code> ä½æ©ç ä¼šé€å±‚ä¼ é€’ï¼Œå­ç»„ä»¶å¯ä»¥åŸºäºçˆ¶ç»„ä»¶çš„å‚æ•°å˜åŒ–ä¿¡æ¯è¿›è¡Œä¼˜åŒ–</p>
        </div>
        <div class="callout callout">
        <p class="callout-title">æºç å‚è€ƒ</p>
        <p>ğŸ“š</p>
        <p><a href="https://cs.android.com/androidx/platform/frameworks/support/+/androidx-main:compose/compiler/compiler-hosted/src/main/java/androidx/compose/compiler/plugins/kotlin/" target="_blank">Compose Compiler Plugin Source</a></p>
        </div>
        <h3 id="iii-ç¨³å®šæ€§æ¨æ–­ç³»ç»Ÿ-stability-inference">III. ç¨³å®šæ€§æ¨æ–­ç³»ç»Ÿ (Stability Inference)</h3>
        <p>ç¨³å®šæ€§æ¨æ–­æ˜¯ Compose Compiler çš„æ ¸å¿ƒåŠŸèƒ½ä¹‹ä¸€ã€‚å®ƒå†³å®šäº†ç¼–è¯‘å™¨èƒ½å¦ç”Ÿæˆè·³è¿‡ä¼˜åŒ–ä»£ç ï¼Œç›´æ¥å½±å“é‡ç»„æ€§èƒ½ã€‚ç†è§£ç¨³å®šæ€§ç³»ç»Ÿçš„å·¥ä½œåŸç†ï¼Œæ˜¯ç¼–å†™é«˜æ•ˆ Compose ä»£ç çš„å…³é”®ã€‚</p>
        <h4>3.1 ç¨³å®šæ€§çš„å®šä¹‰</h4>
        <p>åœ¨ Compose ä¸­ï¼Œä¸€ä¸ªç±»å‹è¢«è®¤ä¸ºæ˜¯<strong>ç¨³å®šï¼ˆStableï¼‰</strong>çš„ï¼Œå½“ä¸”ä»…å½“æ»¡è¶³ä»¥ä¸‹ä¸¤ä¸ªæ¡ä»¶ï¼š</p>
        <ol>
        <li><strong>å€¼ç›¸ç­‰æ€§ï¼ˆValue Equalityï¼‰</strong>ï¼šå¦‚æœä¸¤ä¸ªå®ä¾‹çš„å€¼ç›¸ç­‰ï¼ˆé€šè¿‡ <code>equals()</code> æ¯”è¾ƒï¼‰ï¼Œé‚£ä¹ˆå®ƒä»¬è¢«è®¤ä¸ºæ˜¯ç›¸åŒçš„ï¼Œä¸ä¼šè§¦å‘é‡ç»„</li>
        <li><strong>ä¸å¯å˜æ€§ï¼ˆImmutabilityï¼‰</strong>ï¼šç±»å‹çš„æ‰€æœ‰å…¬å…±å±æ€§åœ¨åˆ›å»ºåä¸ä¼šæ”¹å˜ï¼Œæˆ–è€…å¦‚æœæ”¹å˜ï¼Œä¼šé€šçŸ¥ Compose ç³»ç»Ÿ</li>
        </ol>
        <div class="callout callout-info">
        <p class="callout-title">ä¸ºä»€ä¹ˆç¨³å®šæ€§é‡è¦ï¼Ÿ</p>
        <p>ğŸ’¡</p>
        <p>åªæœ‰å½“å‚æ•°ç±»å‹ç¨³å®šæ—¶ï¼Œç¼–è¯‘å™¨æ‰èƒ½ç”Ÿæˆè·³è¿‡é€»è¾‘ã€‚å¦‚æœå‚æ•°ä¸ç¨³å®šï¼ŒCompose æ— æ³•åˆ¤æ–­å‚æ•°æ˜¯å¦çœŸçš„å‘ç”Ÿäº†å˜åŒ–ï¼Œåªèƒ½æ¯æ¬¡éƒ½æ‰§è¡Œé‡ç»„ï¼Œè¿™ä¼šä¸¥é‡å½±å“æ€§èƒ½ã€‚</p>
        </div>
        <h5>ç¨³å®šç±»å‹çš„ç¤ºä¾‹</h5>
        <pre><code>
        // âœ… ç¨³å®šç±»å‹ï¼šåŸºæœ¬ç±»å‹
        @Composable
        fun Example(
            count: Int,           // ç¨³å®š
            name: String,        // ç¨³å®šï¼ˆString æ˜¯ä¸å¯å˜çš„ï¼‰
            enabled: Boolean      // ç¨³å®š
        ) { }
        
        // âœ… ç¨³å®šç±»å‹ï¼šæ ‡è®°ä¸º @Stable çš„ç±»
        @Stable
        class User(
            val name: String,
            val age: Int
        ) {
            // æ‰€æœ‰å±æ€§éƒ½æ˜¯ valï¼Œä¸”ç±»å‹ç¨³å®š
        }
        
        // âœ… ç¨³å®šç±»å‹ï¼šæ ‡è®°ä¸º @Immutable çš„ç±»
        @Immutable
        data class Point(
            val x: Int,
            val y: Int
        )
        </code></pre>
        <h5>ä¸ç¨³å®šç±»å‹çš„ç¤ºä¾‹</h5>
        <pre><code>
        // âŒ ä¸ç¨³å®šç±»å‹ï¼šå¯å˜ç±»
        class MutableUser {
            var name: String = ""  // var å±æ€§å¯¼è‡´ä¸ç¨³å®š
            var age: Int = 0
        }
        
        // âŒ ä¸ç¨³å®šç±»å‹ï¼šåŒ…å«ä¸ç¨³å®šå±æ€§çš„ç±»
        class Container {
            val items: MutableList&lt;String&gt; = mutableListOf()  // MutableList ä¸ç¨³å®š
        }
        
        // âŒ ä¸ç¨³å®šç±»å‹ï¼šæ¥å£æˆ–æŠ½è±¡ç±»ï¼ˆé™¤éæ ‡è®°ä¸º @Stableï¼‰
        interface Shape  // é»˜è®¤ä¸ç¨³å®š
        abstract class BaseComponent  // é»˜è®¤ä¸ç¨³å®š
        </code></pre>
        <h4>3.2 æ¨æ–­ç®—æ³•</h4>
        <p>Compose Compiler ä½¿ç”¨ä¸€å¥—å¤æ‚çš„ç®—æ³•æ¥æ¨æ–­ç±»å‹çš„ç¨³å®šæ€§ã€‚è¿™ä¸ªç®—æ³•åœ¨ç¼–è¯‘æ—¶è¿è¡Œï¼Œåˆ†æç±»å‹çš„ç»“æ„æ¥ç¡®å®šå…¶ç¨³å®šæ€§ã€‚</p>
        <h5>åŸºæœ¬ç±»å‹çš„ç¨³å®šæ€§</h5>
        <p>æ‰€æœ‰ Kotlin åŸºæœ¬ç±»å‹ï¼ˆ<code>Int</code>ã€<code>String</code>ã€<code>Boolean</code>ã€<code>Float</code>ã€<code>Double</code> ç­‰ï¼‰éƒ½è¢«è®¤ä¸ºæ˜¯ç¨³å®šçš„ï¼š</p>
        <ul>
        <li>å®ƒä»¬æ˜¯ä¸å¯å˜çš„</li>
        <li>å€¼ç›¸ç­‰æ€§æ¯”è¾ƒæ˜¯å¯é çš„</li>
        <li>ç¼–è¯‘å™¨å¯ä»¥ç”Ÿæˆé«˜æ•ˆçš„æ¯”è¾ƒä»£ç </li>
        </ul>
        <h5>ç±»çš„ç¨³å®šæ€§æ¨æ–­è§„åˆ™</h5>
        <p>å¯¹äºè‡ªå®šä¹‰ç±»ï¼Œç¼–è¯‘å™¨ä½¿ç”¨ä»¥ä¸‹è§„åˆ™ï¼š</p>
        <ol>
        <li><strong>æ£€æŸ¥æ³¨è§£</strong>ï¼šå¦‚æœç±»è¢«æ ‡è®°ä¸º <code>@Stable</code> æˆ– <code>@Immutable</code>ï¼Œç›´æ¥è®¤ä¸ºç¨³å®š</li>
        <li><strong>æ£€æŸ¥å±æ€§</strong>ï¼šæ‰€æœ‰å…¬å…±å±æ€§å¿…é¡»æ˜¯ <code>val</code>ï¼Œä¸”ç±»å‹ç¨³å®š</li>
        <li><strong>æ£€æŸ¥æ„é€ å‡½æ•°</strong>ï¼šæ‰€æœ‰æ„é€ å‡½æ•°å‚æ•°çš„ç±»å‹å¿…é¡»ç¨³å®š</li>
        <li><strong>æ£€æŸ¥ç»§æ‰¿</strong>ï¼šå¦‚æœç»§æ‰¿è‡ªå…¶ä»–ç±»ï¼Œçˆ¶ç±»ä¹Ÿå¿…é¡»ç¨³å®š</li>
        </ol>
        <pre><code>
        // ç¼–è¯‘å™¨æ¨æ–­è¿‡ç¨‹ï¼ˆä¼ªä»£ç ï¼‰
        fun isStable(type: KotlinType): Boolean {
            // 1. æ£€æŸ¥æ³¨è§£
            if (type.hasAnnotation("Stable") || type.hasAnnotation("Immutable")) {
                return true
            }
            
            // 2. åŸºæœ¬ç±»å‹æ€»æ˜¯ç¨³å®š
            if (type is PrimitiveType) {
                return true
            }
            
            // 3. æ£€æŸ¥æ‰€æœ‰å±æ€§
            for (property in type.getProperties()) {
                if (property.isVar()) {  // var å±æ€§å¯¼è‡´ä¸ç¨³å®š
                    return false
                }
                if (!isStable(property.type)) {  // é€’å½’æ£€æŸ¥å±æ€§ç±»å‹
                    return false
                }
            }
            
            return true
        }
        </code></pre>
        <h5>æ³›å‹å‚æ•°çš„å¤„ç†</h5>
        <p>å¯¹äºæ³›å‹ç±»å‹ï¼Œç¼–è¯‘å™¨éœ€è¦æ£€æŸ¥ç±»å‹å‚æ•°ï¼š</p>
        <pre><code>
        // ç¤ºä¾‹ï¼šList çš„ç¨³å®šæ€§
        List&lt;String&gt;      // âœ… ç¨³å®šï¼šString ç¨³å®šï¼ŒList æœ¬èº«ä¸å¯å˜
        List&lt;User&gt;        // âœ… ç¨³å®šï¼šå¦‚æœ User ç¨³å®š
        List&lt;MutableUser&gt; // âŒ ä¸ç¨³å®šï¼šMutableUser ä¸ç¨³å®š
        
        MutableList&lt;String&gt; // âŒ ä¸ç¨³å®šï¼šMutableList æœ¬èº«å¯å˜
        </code></pre>
        <div class="callout callout-warning">
        <p class="callout-title">å¸¸è§é™·é˜±</p>
        <p>âš ï¸</p>
        <p>å³ä½¿æ³›å‹å‚æ•°ç±»å‹ç¨³å®šï¼Œå¦‚æœå®¹å™¨ç±»å‹æœ¬èº«å¯å˜ï¼ˆå¦‚ <code>MutableList</code>ã€<code>HashMap</code>ï¼‰ï¼Œæ•´ä¸ªç±»å‹ä»ç„¶ä¸ç¨³å®šã€‚è¿™æ˜¯å› ä¸ºå®¹å™¨å†…å®¹å¯èƒ½åœ¨å¤–éƒ¨è¢«ä¿®æ”¹ï¼Œè€Œ Compose æ— æ³•è¿½è¸ªè¿™äº›å˜åŒ–ã€‚</p>
        </div>
        <h4>3.3 $stable ä½æ©ç ç”Ÿæˆ</h4>
        <p>ç¼–è¯‘å™¨ä¸ºæ¯ä¸ª <code>@Composable</code> å‡½æ•°ç”Ÿæˆä¸€ä¸ª <code>$stable</code> ä½æ©ç ï¼Œç”¨äºå¿«é€Ÿåˆ¤æ–­å“ªäº›å‚æ•°æ˜¯ç¨³å®šçš„ã€‚è¿™ä¸ªä½æ©ç ä¸ <code>$changed</code> ä½æ©ç é…åˆä½¿ç”¨ï¼Œå®ç°è·³è¿‡ä¼˜åŒ–ã€‚</p>
        <h5>ä½æ©ç ç»“æ„</h5>
        <p>æ¯ä¸ªå‚æ•°å ç”¨ 1 ä½ï¼Œè¡¨ç¤ºè¯¥å‚æ•°ç±»å‹æ˜¯å¦ç¨³å®šï¼š</p>
        <pre><code>
        å‚æ•° 0 (name: String)        [1] ç¨³å®š
        å‚æ•° 1 (user: User)          [1] ç¨³å®š
        å‚æ•° 2 (items: List&lt;Item&gt;)   [1] ç¨³å®š
        å‚æ•° 3 (callback: () -&gt; Unit) [0] ä¸ç¨³å®šï¼ˆLambdaï¼‰
        </code></pre>
        <pre><code>
        // ç¤ºä¾‹ï¼š$stable ä½æ©ç ç”Ÿæˆ
        @Composable
        fun Example(
            name: String,              // bit 0: 1 (ç¨³å®š)
            user: User,                // bit 1: 1 (ç¨³å®š)
            items: List&lt;Item&gt;,        // bit 2: 1 (ç¨³å®š)
            callback: () -&gt; Unit        // bit 3: 0 (ä¸ç¨³å®š)
        ) { }
        
        // ç¼–è¯‘å™¨ç”Ÿæˆçš„ $stable ä½æ©ç 
        val $stable = 0b0111  // å‰ä¸‰ä¸ªå‚æ•°ç¨³å®šï¼Œæœ€åä¸€ä¸ªä¸ç¨³å®š
        
        // åœ¨è·³è¿‡é€»è¾‘ä¸­ä½¿ç”¨
        val stableChanged = $changed and $stable
        if (stableChanged == 0 &amp;&amp; $composer.skipping) {
            // æ‰€æœ‰ç¨³å®šå‚æ•°éƒ½æ²¡å˜åŒ–ï¼Œå¯ä»¥è·³è¿‡
            $composer.skipToGroupEnd()
        }
        </code></pre>
        <h5>ç¼–è¯‘å™¨å¦‚ä½•ç”Ÿæˆç¨³å®šæ€§ä¿¡æ¯</h5>
        <p>ç¼–è¯‘å™¨åœ¨ IR è½¬æ¢é˜¶æ®µåˆ†ææ¯ä¸ªå‚æ•°ç±»å‹ï¼Œç”Ÿæˆç¨³å®šæ€§ä¿¡æ¯ï¼š</p>
        <ol>
        <li><strong>ç±»å‹åˆ†æ</strong>ï¼šå¯¹æ¯ä¸ªå‚æ•°ç±»å‹è°ƒç”¨ç¨³å®šæ€§æ¨æ–­ç®—æ³•</li>
        <li><strong>ä½æ©ç æ„å»º</strong>ï¼šæ ¹æ®æ¨æ–­ç»“æœæ„å»º <code>$stable</code> ä½æ©ç </li>
        <li><strong>ä»£ç ç”Ÿæˆ</strong>ï¼šåœ¨å‡½æ•°å¼€å§‹å¤„ç”Ÿæˆç¨³å®šæ€§æ£€æŸ¥ä»£ç </li>
        </ol>
        <pre><code>
        ç¨³å®šæ€§æ¨æ–­æµç¨‹
        
        @Composable å‡½æ•°ç­¾å
            â”‚
            â–¼
        éå†æ¯ä¸ªå‚æ•°
            â”‚
            â”œâ”€â†’ å‚æ•°ç±»å‹åˆ†æ
            â”‚   â”œâ”€ æ£€æŸ¥ @Stable/@Immutable æ³¨è§£
            â”‚   â”œâ”€ æ£€æŸ¥å±æ€§å¯å˜æ€§
            â”‚   â””â”€ é€’å½’æ£€æŸ¥åµŒå¥—ç±»å‹
            â”‚
            â–¼
        ç”Ÿæˆ $stable ä½æ©ç 
            â”‚
            â–¼
        åœ¨è·³è¿‡é€»è¾‘ä¸­ä½¿ç”¨
        </code></pre>
        <h4>3.4 å®æˆ˜ï¼šæŸ¥çœ‹å’Œä¼˜åŒ–ç¨³å®šæ€§æŠ¥å‘Š</h4>
        <p>Compose Compiler å¯ä»¥ç”Ÿæˆè¯¦ç»†çš„ç¨³å®šæ€§æŠ¥å‘Šï¼Œå¸®åŠ©ä½ è¯Šæ–­å’Œä¼˜åŒ–æ€§èƒ½é—®é¢˜ã€‚</p>
        <h5>å¯ç”¨æŠ¥å‘Šç”Ÿæˆ</h5>
        <pre><code>
        // build.gradle.kts
        android {
            composeOptions {
                compilerExtensionVersion = "1.5.4"
            }
        }
        
        composeCompiler {
            // å¯ç”¨æŠ¥å‘Šç”Ÿæˆ
            reportsDestination = layout.buildDirectory.dir("compose_reports")
            metricsDestination = layout.buildDirectory.dir("compose_metrics")
        }
        </code></pre>
        <h5>è§£è¯» composables.txt</h5>
        <p>ç¼–è¯‘åï¼Œåœ¨ <code>build/compose_metrics/composables.txt</code> æ–‡ä»¶ä¸­å¯ä»¥æŸ¥çœ‹æ¯ä¸ª Composable å‡½æ•°çš„ç¨³å®šæ€§ä¿¡æ¯ï¼š</p>
        <pre><code>
        // composables.txt ç¤ºä¾‹
        restartable skippable scheme("[androidx.compose.ui.UiComposable]") fun UserProfile(
          stable user: User
          unstable onEdit: Function0&lt;kotlin.Unit&gt;
          stable count: Int
        )
          Nested classes = []
          Nested parameters = []
          Unstable parameters = [onEdit]
          Stable parameters = [user, count]
          Skippable: true
          Restartable: true
          Strong Skipping: enabled
          Source location: UserProfile.kt:15:5
        </code></pre>
        <p>å…³é”®å­—æ®µè§£è¯»ï¼š</p>
        <ul>
        <li><strong>restartable</strong>ï¼šå‡½æ•°å¯ä»¥è¢«é‡æ–°è°ƒç”¨ï¼ˆé‡ç»„ï¼‰</li>
        <li><strong>skippable</strong>ï¼šå‡½æ•°å¯ä»¥è¢«è·³è¿‡ï¼ˆå¦‚æœå‚æ•°æ²¡å˜åŒ–ï¼‰</li>
        <li><strong>stable/unstable parameters</strong>ï¼šåˆ—å‡ºç¨³å®šå’Œä¸ç¨³å®šçš„å‚æ•°</li>
        <li><strong>Strong Skipping</strong>ï¼šæ˜¯å¦å¯ç”¨äº† Strong Skipping Mode</li>
        <li><strong>Source location</strong>ï¼šæºç ä½ç½®ï¼ˆå¦‚æœå¯ç”¨äº† <code>includeSourceInformation</code>ï¼‰</li>
        </ul>
        <h5>ä¼˜åŒ–ç­–ç•¥</h5>
        <p>æ ¹æ®ç¨³å®šæ€§æŠ¥å‘Šï¼Œå¯ä»¥é‡‡å–ä»¥ä¸‹ä¼˜åŒ–ç­–ç•¥ï¼š</p>
        <ol>
        <li><strong>æ·»åŠ  @Stable æ³¨è§£</strong>ï¼šå¯¹äºä¸å¯å˜çš„æ•°æ®ç±»ï¼Œæ·»åŠ  <code>@Stable</code> æ³¨è§£</li>
        <li><strong>ä½¿ç”¨ä¸å¯å˜é›†åˆ</strong>ï¼šå°† <code>MutableList</code> æ”¹ä¸º <code>List</code></li>
        <li><strong>æå–ç¨³å®šå‚æ•°</strong>ï¼šå°†ä¸ç¨³å®šçš„å¤æ‚å¯¹è±¡æ‹†åˆ†ä¸ºç¨³å®šçš„åŸºæœ¬ç±»å‹å‚æ•°</li>
        <li><strong>ä½¿ç”¨ @Immutable</strong>ï¼šå¯¹äºå®Œå…¨ä¸å¯å˜çš„æ•°æ®ç±»ï¼Œä½¿ç”¨ <code>@Immutable</code></li>
        </ol>
        <pre><code>
        // âŒ ä¼˜åŒ–å‰ï¼šä¸ç¨³å®š
        @Composable
        fun UserCard(user: MutableUser) {  // MutableUser ä¸ç¨³å®š
            Text(user.name)
        }
        
        // âœ… ä¼˜åŒ–åï¼šç¨³å®š
        @Stable
        data class User(
            val name: String,
            val age: Int
        )
        
        @Composable
        fun UserCard(user: User) {  // ç°åœ¨ç¨³å®šäº†
            Text(user.name)
        }
        </code></pre>
        <div class="callout callout-success">
        <p class="callout-title">æœ€ä½³å®è·µ</p>
        <p>âœ…</p>
        <p>å®šæœŸæ£€æŸ¥ç¨³å®šæ€§æŠ¥å‘Šï¼Œç¡®ä¿å…³é”®è·¯å¾„ä¸Šçš„ Composable å‡½æ•°å‚æ•°å°½å¯èƒ½ç¨³å®šã€‚è¿™å¯ä»¥æ˜¾è‘—æå‡é‡ç»„æ€§èƒ½ï¼Œç‰¹åˆ«æ˜¯åœ¨åˆ—è¡¨æ¸²æŸ“ç­‰é«˜é¢‘åœºæ™¯ä¸­ã€‚</p>
        </div>
        <div class="callout callout">
        <p class="callout-title">æ·±å…¥é˜…è¯»</p>
        <p>ğŸ“š</p>
        <p>- <a href="https://developer.android.com/jetpack/compose/performance/stability" target="_blank">Compose Stability - Android Developers</a></p>
        <p>- <a href="https://cs.android.com/androidx/platform/frameworks/support/+/androidx-main:compose/compiler/compiler-hosted/src/main/java/androidx/compose/compiler/plugins/kotlin/analysis/StabilityInferencer.kt" target="_blank">StabilityInferencer.kt - Compose Compiler</a></p>
        </div>
        <h3 id="iv-restartable-ä¸-skippable-æœºåˆ¶">IV. Restartable ä¸ Skippable æœºåˆ¶</h3>
        <p>Restartable å’Œ Skippable æ˜¯ Compose é‡ç»„ä¼˜åŒ–çš„æ ¸å¿ƒæœºåˆ¶ã€‚ç†è§£è¿™ä¸¤ä¸ªæ¦‚å¿µçš„åŒºåˆ«å’Œå®ç°åŸç†ï¼Œå¯¹äºç¼–å†™é«˜æ€§èƒ½çš„ Compose ä»£ç è‡³å…³é‡è¦ã€‚</p>
        <h4>4.1 æ¦‚å¿µè¾¨æ</h4>
        <p>è™½ç„¶ Restartable å’Œ Skippable ç»å¸¸ä¸€èµ·å‡ºç°ï¼Œä½†å®ƒä»¬ä»£è¡¨ä¸åŒçš„æ¦‚å¿µï¼š</p>
        <h5>Restartableï¼šå¯ä»¥è¢«é‡æ–°è°ƒç”¨</h5>
        <p>ä¸€ä¸ª <code>@Composable</code> å‡½æ•°æ˜¯ <strong>Restartable</strong> çš„ï¼Œæ„å‘³ç€å½“å®ƒè¯»å–çš„çŠ¶æ€å‘ç”Ÿå˜åŒ–æ—¶ï¼Œå®ƒå¯ä»¥è¢«é‡æ–°è°ƒç”¨ï¼ˆé‡ç»„ï¼‰ã€‚è¿™æ˜¯ Compose çš„åŸºæœ¬èƒ½åŠ›ï¼Œå‡ ä¹æ‰€æœ‰ Composable å‡½æ•°éƒ½æ˜¯ Restartable çš„ã€‚</p>
        <pre><code>
        // Restartable å‡½æ•°ç¤ºä¾‹
        @Composable
        fun Counter() {
            var count by remember { mutableStateOf(0) }
            Button(onClick = { count++ }) {
                Text("Count: $count")  // è¯»å– countï¼Œå½“ count å˜åŒ–æ—¶ä¼šé‡ç»„
            }
        }
        </code></pre>
        <h5>Skippableï¼šå¯ä»¥è¢«è·³è¿‡</h5>
        <p>ä¸€ä¸ª <code>@Composable</code> å‡½æ•°æ˜¯ <strong>Skippable</strong> çš„ï¼Œæ„å‘³ç€å½“å®ƒçš„å‚æ•°æ²¡æœ‰å˜åŒ–æ—¶ï¼Œå¯ä»¥è·³è¿‡æ‰§è¡Œï¼Œç›´æ¥å¤ç”¨ä¹‹å‰çš„ç»“æœã€‚è¿™éœ€è¦æ»¡è¶³ç‰¹å®šæ¡ä»¶ï¼š</p>
        <ul>
        <li>æ‰€æœ‰å‚æ•°ç±»å‹éƒ½æ˜¯ç¨³å®šçš„</li>
        <li>å‚æ•°å€¼æ²¡æœ‰å˜åŒ–ï¼ˆé€šè¿‡ <code>$changed</code> ä½æ©ç åˆ¤æ–­ï¼‰</li>
        <li>å‡½æ•°ä½“ä¸­æ²¡æœ‰è¯»å–å¯å˜çŠ¶æ€</li>
        </ul>
        <pre><code>
        // Skippable å‡½æ•°ç¤ºä¾‹
        @Composable
        fun Greeting(name: String) {  // String ç¨³å®š
            Text("Hello, $name")  // å¦‚æœ name æ²¡å˜ï¼Œå¯ä»¥è·³è¿‡
        }
        
        // è°ƒç”¨
        Greeting("Alice")  // é¦–æ¬¡æ‰§è¡Œ
        Greeting("Alice")  // è·³è¿‡ï¼å‚æ•°æ²¡å˜
        Greeting("Bob")    // æ‰§è¡Œï¼Œå‚æ•°å˜äº†
        </code></pre>
        <h5>ä¸¤è€…çš„å…³ç³»å’ŒåŒºåˆ«</h5>
        <table class="comparison-table"><thead>
        <tr><th>ç‰¹æ€§</th><th>Restartable</th><th>Skippable</th></tr>
        <tr><td><strong>å®šä¹‰</strong></td><td>å¯ä»¥è¢«é‡æ–°è°ƒç”¨</td><td>å¯ä»¥è¢«è·³è¿‡æ‰§è¡Œ</td></tr>
        <tr><td><strong>è§¦å‘æ¡ä»¶</strong></td><td>è¯»å–çš„çŠ¶æ€å˜åŒ–</td><td>å‚æ•°æ²¡æœ‰å˜åŒ–</td></tr>
        <tr><td><strong>å‰ææ¡ä»¶</strong></td><td>æ— ç‰¹æ®Šè¦æ±‚</td><td>å‚æ•°å¿…é¡»ç¨³å®š</td></tr>
        <tr><td><strong>æ€§èƒ½å½±å“</strong></td><td>å¿…è¦çš„é‡ç»„</td><td>é¿å…ä¸å¿…è¦çš„é‡ç»„</td></tr>
        <tr><td><strong>é»˜è®¤çŠ¶æ€</strong></td><td>æ‰€æœ‰ Composable éƒ½æ˜¯</td><td>éœ€è¦æ»¡è¶³æ¡ä»¶</td></tr>
        <div class="callout callout">
        <p class="callout-title">å…³é”®ç†è§£</p>
        <p>ğŸ”¬</p>
        <p>ä¸€ä¸ªå‡½æ•°å¯ä»¥åŒæ—¶æ˜¯ Restartable å’Œ Skippableï¼šå½“å‚æ•°å˜åŒ–æ—¶ï¼Œå®ƒæ˜¯ Restartable çš„ï¼ˆä¼šè¢«é‡æ–°è°ƒç”¨ï¼‰ï¼›å½“å‚æ•°æ²¡å˜åŒ–æ—¶ï¼Œå®ƒæ˜¯ Skippable çš„ï¼ˆä¼šè¢«è·³è¿‡ï¼‰ã€‚è¿™ä¸¤ä¸ªç‰¹æ€§æ˜¯äº’è¡¥çš„ï¼Œå…±åŒå®ç°äº† Compose çš„æ™ºèƒ½é‡ç»„ä¼˜åŒ–ã€‚</p>
        </div>
        <h4>4.2 $changed å‚æ•°æ·±åº¦è§£æ</h4>
        <p><code>$changed</code> å‚æ•°æ˜¯ Compose Compiler æ³¨å…¥çš„ä¸€ä¸ªä½æ©ç ï¼Œç”¨äºè¿½è¸ªå“ªäº›å‚æ•°å‘ç”Ÿäº†å˜åŒ–ã€‚è¿™æ˜¯å®ç° Skippable æœºåˆ¶çš„æ ¸å¿ƒã€‚</p>
        <h5>ä½æ©ç ç»“æ„ï¼ˆæ¯å‚æ•° 3 ä½ï¼‰</h5>
        <p>æ¯ä¸ªå‚æ•°åœ¨ <code>$changed</code> ä½æ©ç ä¸­å ç”¨ 3 ä½ï¼Œç¼–ç äº†å‚æ•°çš„çŠ¶æ€ä¿¡æ¯ï¼š</p>
        <pre><code>
        å‚æ•° 0 (name: String)
            bit 0: 0 (SAME)
            bit 1-2: 11 (STATIC)
        
        å‚æ•° 1 (count: Int)
            bit 0: 1 (CHANGED)
            bit 1-2: 01 (SAME)
        
        å‚æ•° 2 (user: User)
            bit 0: 0 (SAME)
            bit 1-2: 10 (UNCERTAIN)
        </code></pre>
        <h5>çŠ¶æ€ç¼–ç </h5>
        <p>æ¯ 3 ä½ç¼–ç äº†ä»¥ä¸‹ä¿¡æ¯ï¼š</p>
        <ul>
        <li><strong>bit 0 (æœ€ä½ä½)</strong>ï¼šæ˜¯å¦"è„"ï¼ˆéœ€è¦æ£€æŸ¥ï¼‰</li>
        </ul>
        <p>  - <code>0</code>ï¼šå‚æ•°æœªå˜åŒ–ï¼ˆSAMEï¼‰</p>
        <p>  - <code>1</code>ï¼šå‚æ•°å¯èƒ½å˜åŒ–ï¼ˆCHANGEDï¼‰</p>
        <ul>
        <li><strong>bit 1-2</strong>ï¼šç¨³å®šæ€§ä¿¡æ¯</li>
        </ul>
        <p>  - <code>00</code>ï¼šUNCERTAINï¼ˆä¸ç¡®å®šï¼Œéœ€è¦è¿è¡Œæ—¶æ¯”è¾ƒï¼‰</p>
        <p>  - <code>01</code>ï¼šSAMEï¼ˆç›¸åŒï¼Œç¼–è¯‘æ—¶ç¡®å®šï¼‰</p>
        <p>  - <code>10</code>ï¼šSTATICï¼ˆé™æ€ï¼Œæ°¸è¿œä¸ä¼šå˜åŒ–ï¼‰</p>
        <p>  - <code>11</code>ï¼šCHANGEDï¼ˆå·²å˜åŒ–ï¼Œç¼–è¯‘æ—¶ç¡®å®šï¼‰</p>
        <pre><code>
        // $changed ä½æ©ç ç¤ºä¾‹
        @Composable
        fun Example(
            name: String,      // bits 0-2
            count: Int,        // bits 3-5
            user: User         // bits 6-8
        ) { }
        
        // è°ƒç”¨ç¤ºä¾‹
        val name = "Alice"
        val count = 42
        val user = User("Bob", 30)
        
        // é¦–æ¬¡è°ƒç”¨ï¼šæ‰€æœ‰å‚æ•°éƒ½æ˜¯ CHANGED
        Example(name, count, user, $composer, $changed = 0b111_111_111)
        
        // ç¬¬äºŒæ¬¡è°ƒç”¨ï¼Œname å’Œ count æ²¡å˜ï¼Œuser å˜äº†
        val newUser = User("Charlie", 25)
        Example(name, count, newUser, $composer, $changed = 0b111_000_000)
        //                                    â†‘      â†‘      â†‘
        //                                  user   count  name
        //                                 å˜åŒ–    æœªå˜   æœªå˜
        </code></pre>
        <h5>å‚æ•°æ¯”è¾ƒé€»è¾‘</h5>
        <p>ç¼–è¯‘å™¨ç”Ÿæˆçš„ä»£ç ä¼šæ£€æŸ¥æ¯ä¸ªå‚æ•°æ˜¯å¦å˜åŒ–ã€‚å¯¹äºç¨³å®šç±»å‹ï¼Œä½¿ç”¨å€¼æ¯”è¾ƒï¼›å¯¹äºä¸ç¨³å®šç±»å‹ï¼Œä½¿ç”¨å¼•ç”¨æ¯”è¾ƒï¼ˆåœ¨ä¼ ç»Ÿæ¨¡å¼ä¸‹ï¼‰æˆ–å®ä¾‹ç›¸ç­‰æ€§ï¼ˆåœ¨ Strong Skipping æ¨¡å¼ä¸‹ï¼‰ï¼š</p>
        <pre><code>
        // ç¼–è¯‘å™¨ç”Ÿæˆçš„å‚æ•°æ¯”è¾ƒé€»è¾‘ï¼ˆç®€åŒ–ç‰ˆï¼‰
        fun calculateChanged(
            oldName: String,
            newName: String,
            oldCount: Int,
            newCount: Int,
            oldUser: User,
            newUser: User
        ): Int {
            var changed = 0
            
            // å‚æ•° 0: name (String - ç¨³å®š)
            if (oldName != newName) {
                changed = changed or 0b000000001  // bit 0
            }
            
            // å‚æ•° 1: count (Int - ç¨³å®š)
            if (oldCount != newCount) {
                changed = changed or 0b000001000  // bit 3
            }
            
            // å‚æ•° 2: user (User - å¦‚æœç¨³å®šï¼Œä½¿ç”¨å€¼æ¯”è¾ƒï¼›å¦åˆ™ä½¿ç”¨å¼•ç”¨æ¯”è¾ƒ)
            if (oldUser != newUser) {  // æˆ– oldUser !== newUserï¼ˆä¸ç¨³å®šæ—¶ï¼‰
                changed = changed or 0b001000000  // bit 6
            }
            
            return changed
        }
        </code></pre>
        <h4>4.3 è·³è¿‡é€»è¾‘ç”Ÿæˆ</h4>
        <p>ç¼–è¯‘å™¨æ ¹æ®å‡½æ•°çš„å‚æ•°ç¨³å®šæ€§ï¼Œå†³å®šæ˜¯å¦ç”Ÿæˆè·³è¿‡é€»è¾‘ã€‚åªæœ‰å½“æ‰€æœ‰å‚æ•°éƒ½ç¨³å®šæ—¶ï¼Œæ‰ä¼šç”Ÿæˆå®Œæ•´çš„è·³è¿‡ä»£ç ã€‚</p>
        <h5>ç¼–è¯‘å™¨å¦‚ä½•å†³å®šæ˜¯å¦ç”Ÿæˆè·³è¿‡ä»£ç </h5>
        <p>ç¼–è¯‘å™¨ä½¿ç”¨ä»¥ä¸‹è§„åˆ™ï¼š</p>
        <ol>
        <li><strong>æ£€æŸ¥å‚æ•°ç¨³å®šæ€§</strong>ï¼šå¦‚æœæ‰€æœ‰å‚æ•°éƒ½ç¨³å®šï¼Œç”Ÿæˆè·³è¿‡é€»è¾‘</li>
        <li><strong>æ£€æŸ¥å‡½æ•°ä½“</strong>ï¼šå¦‚æœå‡½æ•°ä½“å†…è¯»å–äº†å¯å˜çŠ¶æ€ï¼Œä»ç„¶å¯ä»¥è·³è¿‡ï¼ˆä½†ä¼šåœ¨çŠ¶æ€å˜åŒ–æ—¶é‡ç»„ï¼‰</li>
        <li><strong>ç”Ÿæˆä½æ©ç æ£€æŸ¥</strong>ï¼šç”Ÿæˆä»£ç æ¥æ£€æŸ¥ <code>$changed</code> ä½æ©ç </li>
        </ol>
        <pre><code>
        // å®Œå…¨ Skippable çš„å‡½æ•°
        @Composable
        fun FullySkippable(
            name: String,      // ç¨³å®š
            count: Int          // ç¨³å®š
        ) {
            Text("$name: $count")
        }
        
        // ç¼–è¯‘å™¨ç”Ÿæˆçš„ä»£ç ï¼ˆç®€åŒ–ç‰ˆï¼‰
        fun FullySkippable(
            name: String,
            count: Int,
            $composer: Composer,
            $changed: Int
        ) {
            $composer.startRestartGroup(0x12345678)
            
            // è·³è¿‡é€»è¾‘ï¼šæ‰€æœ‰å‚æ•°ç¨³å®šï¼Œæ£€æŸ¥æ˜¯å¦éƒ½æ²¡å˜åŒ–
            if ($changed == 0 &amp;&amp; $composer.skipping) {
                // æ‰€æœ‰ç¨³å®šå‚æ•°éƒ½æ²¡å˜åŒ–ï¼Œå¯ä»¥è·³è¿‡
                $composer.skipToGroupEnd()
                return
            }
            
            Text("$name: $count", $composer, 0)
            
            $composer.endRestartGroup()?.updateScope {
                FullySkippable(name, count, $composer, $changed or 0b00000011)
            }
        }
        </code></pre>
        <h5>startRestartGroup / endRestartGroup æœºåˆ¶</h5>
        <p>æ¯ä¸ª Restartable å‡½æ•°éƒ½ä¼šè¢«åŒ…è£…åœ¨ <code>startRestartGroup</code> å’Œ <code>endRestartGroup</code> è°ƒç”¨ä¹‹é—´ï¼š</p>
        <ul>
        <li><strong>startRestartGroup</strong>ï¼šå¼€å§‹ä¸€ä¸ªæ–°çš„ Groupï¼Œè®°å½•å‡½æ•°çš„ä½ç½®å’Œå‚æ•°ä¿¡æ¯</li>
        <li><strong>endRestartGroup</strong>ï¼šç»“æŸ Groupï¼Œè¿”å›ä¸€ä¸ª <code>RecomposeScope</code>ï¼Œç”¨äºåç»­çš„é‡ç»„è§¦å‘</li>
        </ul>
        <pre><code>
        // startRestartGroup çš„ä½œç”¨
        fun Composer.startRestartGroup(key: Int) {
            // 1. åœ¨ Slot Table ä¸­åˆ›å»ºæ–°çš„ Group
            // 2. è®°å½• Group Keyï¼ˆç”¨äºä½ç½®åŒ¹é…ï¼‰
            // 3. è®¾ç½®å½“å‰ Group çš„ä¸Šä¸‹æ–‡
        }
        
        // endRestartGroup çš„ä½œç”¨
        fun Composer.endRestartGroup(): RecomposeScope? {
            // 1. å…³é—­å½“å‰ Group
            // 2. è¿”å› RecomposeScopeï¼ˆç”¨äºè§¦å‘é‡ç»„ï¼‰
            // 3. å¦‚æœå‡½æ•°ä¸å¯é‡å¯ï¼Œè¿”å› null
        }
        </code></pre>
        <h5>updateScope ä¸ Invalidation å…³è”</h5>
        <p><code>updateScope</code> è¿”å›çš„ Lambda ä¼šåœ¨çŠ¶æ€å˜åŒ–æ—¶è¢«è°ƒç”¨ï¼Œè§¦å‘é‡ç»„ï¼š</p>
        <pre><code>
        // updateScope çš„ä½¿ç”¨
        $composer.endRestartGroup()?.updateScope { // è¿”å› RecomposeScope
            // è¿™ä¸ª Lambda ä¼šè¢«å­˜å‚¨ï¼Œå½“ç›¸å…³çŠ¶æ€å˜åŒ–æ—¶è°ƒç”¨
            MyComposable(param1, param2, $composer, $changed or 0b11)
        }
        
        // å½“å‡½æ•°å†…è¯»å–çš„çŠ¶æ€å˜åŒ–æ—¶
        val state = remember { mutableStateOf(0) }
        Text(state.value.toString())  // è¯»å– state
        
        // state å˜åŒ–æ—¶ï¼Œä¼šè°ƒç”¨ updateScope ä¸­çš„ Lambdaï¼Œè§¦å‘é‡ç»„
        state.value = 1  // â†’ è§¦å‘é‡ç»„ â†’ è°ƒç”¨ updateScope çš„ Lambda
        </code></pre>
        <h4>4.4 ä»£ç ç¤ºä¾‹ï¼šå®Œæ•´çš„è½¬æ¢æµç¨‹å›¾è§£</h4>
        <p>è®©æˆ‘ä»¬çœ‹ä¸€ä¸ªå®Œæ•´çš„ä¾‹å­ï¼Œå±•ç¤ºä»æºç åˆ°è¿è¡Œæ—¶çš„å®Œæ•´è½¬æ¢è¿‡ç¨‹ï¼š</p>
        <pre><code>
        // è½¬æ¢å‰ï¼šåŸå§‹ä»£ç 
        @Composable
        fun ProductCard(
            product: Product,
            onAddToCart: () -&gt; Unit
        ) {
            Column {
                Text(product.name)
                Text(product.price.toString())
                Button(onClick = onAddToCart) {
                    Text("Add to Cart")
                }
            }
        }
        
        // è½¬æ¢åï¼šç¼–è¯‘å™¨ç”Ÿæˆçš„ä»£ç ï¼ˆå®Œæ•´ç‰ˆï¼‰
        fun ProductCard(
            product: Product,
            onAddToCart: () -&gt; Unit,
            $composer: Composer,
            $changed: Int,
            $default: Int = 0
        ) {
            // 1. å¼€å§‹ Restart Group
            $composer.startRestartGroup(0xABCD1234)
            
            // 2. å‚æ•°å˜åŒ–æ£€æµ‹ï¼ˆå‡è®¾ Product ç¨³å®šï¼ŒLambda ä¸ç¨³å®šï¼‰
            val changedProduct = $changed and 0b00000001 != 0
            val changedCallback = $changed and 0b00000010 != 0
            
            // 3. è·³è¿‡é€»è¾‘ï¼ˆéƒ¨åˆ†è·³è¿‡ï¼šåªæ£€æŸ¥ç¨³å®šå‚æ•°ï¼‰
            val $stable = 0b00000001  // åªæœ‰ product ç¨³å®š
            val stableChanged = $changed and $stable
            
            if (stableChanged == 0 &amp;&amp; !changedCallback &amp;&amp; $composer.skipping) {
                // ç¨³å®šå‚æ•°æ²¡å˜ï¼Œä¸”å›è°ƒæ²¡å˜ï¼ˆé€šè¿‡å¼•ç”¨æ¯”è¾ƒï¼‰ï¼Œå¯ä»¥è·³è¿‡
                $composer.skipToGroupEnd()
            } else {
                // 4. æ‰§è¡Œå‡½æ•°ä½“
                Column(
                    $composer = $composer,
                    $changed = 0,
                    content = {
                        Text(
                            text = product.name,
                            $composer = $composer,
                            $changed = if (changedProduct) 0b00000001 else 0
                        )
                        Text(
                            text = product.price.toString(),
                            $composer = $composer,
                            $changed = if (changedProduct) 0b00000001 else 0
                        )
                        Button(
                            onClick = onAddToCart,
                            $composer = $composer,
                            $changed = if (changedCallback) 0b00000010 else 0,
                            content = {
                                Text("Add to Cart", $composer, 0)
                            }
                        )
                    }
                )
            }
            
            // 5. ç»“æŸ Restart Groupï¼Œè¿”å› RecomposeScope
            $composer.endRestartGroup()?.updateScope {
                // å½“å‡½æ•°å†…è¯»å–çš„çŠ¶æ€å˜åŒ–æ—¶ï¼Œè¿™ä¸ª Lambda ä¼šè¢«è°ƒç”¨
                ProductCard(product, onAddToCart, $composer, $changed or 0b00000011)
            }
        }
        </code></pre>
        <pre><code>
        Restartable/Skippable å†³ç­–æµç¨‹
        
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  @Composable å‡½æ•°   â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚ æ£€æŸ¥å‚æ•°ç¨³å®šæ€§       â”‚
        â”‚ â€¢ æ‰€æœ‰å‚æ•°ç¨³å®šï¼Ÿ     â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”œâ”€â†’ æ˜¯ â†’ ç”Ÿæˆå®Œæ•´è·³è¿‡é€»è¾‘
                   â”‚
                   â””â”€â†’ å¦ â†’ ç”Ÿæˆéƒ¨åˆ†è·³è¿‡é€»è¾‘
                              â”‚
                              â–¼
                   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                   â”‚ ç”Ÿæˆ $changed æ£€æŸ¥   â”‚
                   â”‚ â€¢ ç¨³å®šå‚æ•°å˜åŒ–ï¼Ÿ     â”‚
                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”œâ”€â†’ æ˜¯ â†’ æ‰§è¡Œå‡½æ•°ä½“
                              â”‚
                              â””â”€â†’ å¦ â†’ è·³è¿‡æ‰§è¡Œ
        </code></pre>
        <div class="callout callout-success">
        <p class="callout-title">æ€§èƒ½ä¼˜åŒ–è¦ç‚¹</p>
        <p>âœ…</p>
        <p>è¦æœ€å¤§åŒ– Skippable çš„æ•ˆæœï¼š</p>
        <p>- ç¡®ä¿å‚æ•°ç±»å‹ç¨³å®šï¼ˆä½¿ç”¨ <code>@Stable</code> æˆ– <code>@Immutable</code>ï¼‰</p>
        <p>- é¿å…åœ¨å‚æ•°ä¸­ä½¿ç”¨ä¸ç¨³å®šçš„ç±»å‹ï¼ˆå¦‚ <code>MutableList</code>ï¼‰</p>
        <p>- å¯¹äº Lambda å‚æ•°ï¼Œè€ƒè™‘ä½¿ç”¨ <code>rememberUpdatedState</code> æˆ–å¯ç”¨ Strong Skipping Mode</p>
        </div>
        <div class="callout callout">
        <p class="callout-title">æ·±å…¥é˜…è¯»</p>
        <p>ğŸ“š</p>
        <p>- <a href="https://developer.android.com/jetpack/compose/performance/skippable" target="_blank">Compose Skippable - Android Developers</a></p>
        <p>- <a href="https://cs.android.com/androidx/platform/frameworks/support/+/androidx-main:compose/runtime/runtime/src/commonMain/kotlin/androidx/compose/runtime/RecomposeScope.kt" target="_blank">RecomposeScope.kt - Compose Runtime</a></p>
        </div>
        <h3 id="v-lambda-è®°å¿†åŒ–åŸç†">V. Lambda è®°å¿†åŒ–åŸç†</h3>
        <p>Lambda è¡¨è¾¾å¼åœ¨ Compose ä¸­éœ€è¦ç‰¹æ®Šå¤„ç†ã€‚ç†è§£ Lambda è®°å¿†åŒ–çš„åŸç†ï¼Œå¯¹äºé¿å…ä¸å¿…è¦çš„é‡ç»„å’Œç¼–å†™é«˜æ€§èƒ½ä»£ç è‡³å…³é‡è¦ã€‚</p>
        <h4>5.1 é—®é¢˜èƒŒæ™¯</h4>
        <p>åœ¨ Compose ä¸­ï¼ŒLambda è¡¨è¾¾å¼ä½œä¸ºå‚æ•°ä¼ é€’æ—¶ï¼Œä¼šé‡åˆ°ä¸€ä¸ªæ ¹æœ¬æ€§é—®é¢˜ï¼šæ¯æ¬¡é‡ç»„æ—¶ï¼ŒLambda å®ä¾‹éƒ½æ˜¯æ–°çš„ï¼Œå³ä½¿é€»è¾‘å®Œå…¨ç›¸åŒã€‚</p>
        <h5>ä¸ºä»€ä¹ˆæ™®é€š Lambda ä¼šç ´åè·³è¿‡ä¼˜åŒ–</h5>
        <p>è€ƒè™‘ä»¥ä¸‹ä»£ç ï¼š</p>
        <pre><code>
        // é—®é¢˜ç¤ºä¾‹
        @Composable
        fun MyScreen() {
            var count by remember { mutableStateOf(0) }
            
            // æ¯æ¬¡é‡ç»„æ—¶ï¼Œè¿™ä¸ª Lambda éƒ½æ˜¯æ–°å®ä¾‹ï¼
            Button(onClick = { count++ }) {  // âŒ æ–° Lambda å®ä¾‹
                Text("Count: $count")
            }
        }
        
        // ç¼–è¯‘å™¨ç”Ÿæˆçš„ä»£ç ï¼ˆç®€åŒ–ï¼‰
        fun MyScreen($composer: Composer) {
            val count = remember { mutableStateOf(0) }
            
            // æ¯æ¬¡è°ƒç”¨éƒ½åˆ›å»ºæ–°çš„ Lambda
            Button(
                onClick = { count.value++ },  // æ–°å®ä¾‹ â†’ å¼•ç”¨ä¸åŒ â†’ æ— æ³•è·³è¿‡
                $composer = $composer,
                $changed = 0b00000010  // Lambda æ€»æ˜¯"å˜åŒ–"
            )
        }
        </code></pre>
        <p>é—®é¢˜åœ¨äºï¼šå³ä½¿ Lambda çš„é€»è¾‘å®Œå…¨ç›¸åŒï¼Œæ¯æ¬¡é‡ç»„æ—¶éƒ½ä¼šåˆ›å»ºæ–°çš„å®ä¾‹ã€‚ç”±äº Lambda é»˜è®¤ä½¿ç”¨å¼•ç”¨ç›¸ç­‰æ€§æ¯”è¾ƒï¼ˆ<code>===</code>ï¼‰ï¼Œç¼–è¯‘å™¨ä¼šè®¤ä¸ºå‚æ•°"å˜åŒ–"äº†ï¼Œå¯¼è‡´æ— æ³•è·³è¿‡ã€‚</p>
        <div class="callout callout-warning">
        <p class="callout-title">Lambda çš„æ€§èƒ½é™·é˜±</p>
        <p>âš ï¸</p>
        <p>å¦‚æœ Composable å‡½æ•°æ¥å— Lambda å‚æ•°ï¼Œä¸”è¯¥å‡½æ•°æ˜¯ Skippable çš„ï¼Œé‚£ä¹ˆæ¯æ¬¡é‡ç»„æ—¶ Lambda å‚æ•°éƒ½ä¼š"å˜åŒ–"ï¼ˆå› ä¸ºæ˜¯æ–°å®ä¾‹ï¼‰ï¼Œå¯¼è‡´è·³è¿‡ä¼˜åŒ–å¤±æ•ˆã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆéœ€è¦ Lambda è®°å¿†åŒ–ã€‚</p>
        </div>
        <h5>Capture å˜é‡å¸¦æ¥çš„æŒ‘æˆ˜</h5>
        <p>å½“ Lambda æ•è·å¤–éƒ¨å˜é‡æ—¶ï¼Œé—®é¢˜æ›´åŠ å¤æ‚ï¼š</p>
        <pre><code>
        // Lambda æ•è·å¤–éƒ¨å˜é‡
        @Composable
        fun ProductList(products: List&lt;Product&gt;) {
            var selectedId by remember { mutableStateOf(-1) }
            
            products.forEach { product -&gt;
                // Lambda æ•è·äº† product å’Œ selectedId
                ProductCard(
                    product = product,
                    onClick = { selectedId = product.id }  // æ•è·äº† product å’Œ selectedId
                )
            }
        }
        </code></pre>
        <p>è¿™ä¸ª Lambda ä¸ä»…æ¯æ¬¡é‡ç»„æ—¶æ˜¯æ–°å®ä¾‹ï¼Œè¿˜æ•è·äº†å¤–éƒ¨å˜é‡ã€‚å¦‚æœ <code>selectedId</code> å˜åŒ–ï¼Œæ‰€æœ‰æ•è·äº†å®ƒçš„ Lambda éƒ½éœ€è¦æ›´æ–°ï¼Œå¯¼è‡´å¤§é‡ä¸å¿…è¦çš„é‡ç»„ã€‚</p>
        <h4>5.2 remember åŒ…è£…æœºåˆ¶</h4>
        <p>Compose Compiler ä¼šè‡ªåŠ¨ä¸ºéœ€è¦è®°å¿†åŒ–çš„ Lambda ç”Ÿæˆ <code>remember</code> åŒ…è£…ä»£ç ï¼Œå°†å…¶è½¬æ¢ä¸º <code>ComposableLambda</code> ç±»å‹ã€‚</p>
        <h5>ComposableLambda ç±»å‹</h5>
        <p><code>ComposableLambda</code> æ˜¯ Compose è¿è¡Œæ—¶æä¾›çš„ç‰¹æ®Šç±»å‹ï¼Œç”¨äºè¡¨ç¤ºéœ€è¦è®°å¿†åŒ–çš„ Lambdaï¼š</p>
        <pre><code>
        // ComposableLambda çš„å®šä¹‰ï¼ˆç®€åŒ–ï¼‰
        class ComposableLambda&lt;P, R&gt; {
            val block: (P) -&gt; R
            val changed: Int  // æ•è·å˜é‡çš„å˜åŒ–æ ‡è®°
        }
        </code></pre>
        <h5>è‡ªåŠ¨ç”Ÿæˆçš„ remember è°ƒç”¨</h5>
        <p>ç¼–è¯‘å™¨ä¼šæ£€æµ‹å“ªäº› Lambda éœ€è¦è®°å¿†åŒ–ï¼Œå¹¶è‡ªåŠ¨ç”Ÿæˆ <code>remember</code> åŒ…è£…ï¼š</p>
        <pre><code>
        // è½¬æ¢å‰ï¼šä½ å†™çš„ä»£ç 
        @Composable
        fun MyButton(onClick: () -&gt; Unit) {
            Button(onClick = onClick) {
                Text("Click me")
            }
        }
        
        // è½¬æ¢åï¼šç¼–è¯‘å™¨ç”Ÿæˆçš„ä»£ç 
        @Composable
        fun MyButton(
            onClick: () -&gt; Unit,
            $composer: Composer,
            $changed: Int
        ) {
            // ç¼–è¯‘å™¨è‡ªåŠ¨ç”Ÿæˆ remember åŒ…è£…
            val rememberedOnClick = $composer.remember(onClick) { onClick }
            
            Button(
                onClick = rememberedOnClick,
                $composer = $composer,
                $changed = 0  // ç°åœ¨å¯ä»¥è·³è¿‡äº†ï¼
            ) {
                Text("Click me", $composer, 0)
            }
        }
        </code></pre>
        <h5>Capture å˜é‡çš„è¿½è¸ª</h5>
        <p>å½“ Lambda æ•è·å¤–éƒ¨å˜é‡æ—¶ï¼Œç¼–è¯‘å™¨ä¼šè¿½è¸ªè¿™äº›å˜é‡ï¼Œå¹¶åœ¨å®ƒä»¬å˜åŒ–æ—¶æ›´æ–° Lambdaï¼š</p>
        <pre><code>
        // è½¬æ¢å‰
        @Composable
        fun Counter(initialValue: Int) {
            var count by remember { mutableStateOf(initialValue) }
            
            // Lambda æ•è·äº† count
            Button(onClick = { count++ }) {
                Text("$count")
            }
        }
        
        // è½¬æ¢åï¼ˆç®€åŒ–ï¼‰
        @Composable
        fun Counter(
            initialValue: Int,
            $composer: Composer,
            $changed: Int
        ) {
            var count by remember { mutableStateOf(initialValue) }
            
            // ç¼–è¯‘å™¨è¿½è¸ªæ•è·çš„å˜é‡ï¼ˆcountï¼‰
            val rememberedOnClick = $composer.remember(
                count  // ä¾èµ–ï¼šå½“ count å˜åŒ–æ—¶ï¼Œæ›´æ–° Lambda
            ) { { count++ } }
            
            Button(
                onClick = rememberedOnClick,
                $composer = $composer,
                $changed = 0
            ) {
                Text("$count", $composer, 0)
            }
        }
        </code></pre>
        <div class="callout callout-info">
        <p class="callout-title">ç¼–è¯‘å™¨å¦‚ä½•å†³å®šæ˜¯å¦è®°å¿†åŒ–</p>
        <p>ğŸ’¡</p>
        <p>ç¼–è¯‘å™¨ä½¿ç”¨ä»¥ä¸‹è§„åˆ™å†³å®šæ˜¯å¦è‡ªåŠ¨è®°å¿†åŒ– Lambdaï¼š</p>
        <p>- Lambda ä½œä¸ºå‚æ•°ä¼ é€’ç»™ Composable å‡½æ•°</p>
        <p>- æ¥æ”¶ Lambda çš„ Composable å‡½æ•°æ˜¯ Skippable çš„</p>
        <p>- Lambda ä¸æ˜¯å†…è”çš„ï¼ˆinline Composable ä¸éœ€è¦è®°å¿†åŒ–ï¼‰</p>
        </div>
        <h4>5.3 ä¼˜åŒ–ç­–ç•¥</h4>
        <p>è™½ç„¶ç¼–è¯‘å™¨ä¼šè‡ªåŠ¨å¤„ç†å¤§éƒ¨åˆ†æƒ…å†µï¼Œä½†äº†è§£ä¼˜åŒ–ç­–ç•¥å¯ä»¥å¸®åŠ©ä½ ç¼–å†™æ›´é«˜æ•ˆçš„ä»£ç ã€‚</p>
        <h5>Non-capturing Lambda çš„ä¼˜åŒ–</h5>
        <p>ä¸æ•è·ä»»ä½•å¤–éƒ¨å˜é‡çš„ Lambdaï¼ˆNon-capturing Lambdaï¼‰å¯ä»¥è¢«ä¼˜åŒ–ä¸ºå•ä¾‹ï¼š</p>
        <pre><code>
        // Non-capturing Lambdaï¼šå¯ä»¥ä¼˜åŒ–ä¸ºå•ä¾‹
        @Composable
        fun SimpleButton() {
            // è¿™ä¸ª Lambda ä¸æ•è·ä»»ä½•å˜é‡ï¼Œå¯ä»¥å¤ç”¨
            Button(onClick = { println("Clicked") }) {
                Text("Click")
            }
        }
        
        // ç¼–è¯‘å™¨ä¼˜åŒ–åï¼ˆæ¦‚å¿µä¸Šï¼‰
        val SINGLETON_LAMBDA = { println("Clicked") }
        
        @Composable
        fun SimpleButton($composer: Composer) {
            // ç›´æ¥ä½¿ç”¨å•ä¾‹ï¼Œæ— éœ€ remember
            Button(onClick = SINGLETON_LAMBDA, $composer, 0) {
                Text("Click", $composer, 0)
            }
        }
        </code></pre>
        <h5>Inline Composable çš„å¤„ç†</h5>
        <p>å¯¹äºå†…è”çš„ Composable Lambdaï¼ˆå¦‚ <code>Column</code>ã€<code>Row</code> çš„ content å‚æ•°ï¼‰ï¼Œç¼–è¯‘å™¨ä¼šå†…è”å±•å¼€ï¼Œä¸éœ€è¦è®°å¿†åŒ–ï¼š</p>
        <pre><code>
        // Inline Composable Lambda
        @Composable
        inline fun Column(
            content: @Composable () -&gt; Unit  // inlineï¼Œç›´æ¥å±•å¼€
        ) {
            // content() ç›´æ¥å†…è”ï¼Œæ— éœ€è®°å¿†åŒ–
        }
        
        // ä½¿ç”¨
        Column {
            Text("Hello")  // ç›´æ¥å†…è”åˆ° Column ä¸­
        }
        </code></pre>
        <h5>rememberUpdatedState çš„ä½¿ç”¨åœºæ™¯</h5>
        <p>å½“ Lambda éœ€è¦æ•è·å¯èƒ½å˜åŒ–çš„å€¼ï¼Œä½†ä½ ä¸å¸Œæœ› Lambda æœ¬èº«å˜åŒ–æ—¶ï¼Œä½¿ç”¨ <code>rememberUpdatedState</code>ï¼š</p>
        <pre><code>
        // é—®é¢˜åœºæ™¯ï¼šLambda æ•è·äº†ä¼šå˜åŒ–çš„å€¼
        @Composable
        fun MyScreen(userId: String) {
            // æ¯æ¬¡ userId å˜åŒ–ï¼Œè¿™ä¸ª Lambda éƒ½ä¼šæ˜¯æ–°å®ä¾‹
            LaunchedEffect(Unit) {
                loadUser(userId)  // æ•è·äº† userId
            }
        }
        
        // è§£å†³æ–¹æ¡ˆï¼šä½¿ç”¨ rememberUpdatedState
        @Composable
        fun MyScreen(userId: String) {
            val currentUserId by rememberUpdatedState(userId)
            
            // Lambda å®ä¾‹ä¸å˜ï¼Œä½†å†…éƒ¨ä½¿ç”¨çš„å€¼ä¼šæ›´æ–°
            LaunchedEffect(Unit) {
                loadUser(currentUserId())  // ä½¿ç”¨æœ€æ–°çš„ userId
            }
        }
        </code></pre>
        <div class="callout callout-success">
        <p class="callout-title">æœ€ä½³å®è·µ</p>
        <p>âœ…</p>
        <p>å¯¹äºéœ€è¦é•¿æœŸå­˜åœ¨çš„ Lambdaï¼ˆå¦‚ <code>LaunchedEffect</code>ã€<code>DisposableEffect</code> çš„ keyï¼‰ï¼Œå¦‚æœå®ƒä»¬æ•è·äº†å¯èƒ½å˜åŒ–çš„å€¼ï¼Œä½¿ç”¨ <code>rememberUpdatedState</code> å¯ä»¥é¿å…ä¸å¿…è¦çš„é‡æ–°åˆ›å»ºã€‚</p>
        </div>
        <h4>5.4 ä»£ç ç¤ºä¾‹ï¼šLambda è½¬æ¢å‰åå¯¹æ¯”</h4>
        <p>è®©æˆ‘ä»¬çœ‹ä¸€ä¸ªå®Œæ•´çš„ä¾‹å­ï¼Œå±•ç¤º Lambda è®°å¿†åŒ–çš„å®Œæ•´è¿‡ç¨‹ï¼š</p>
        <pre><code>
        // è½¬æ¢å‰ï¼šåŸå§‹ä»£ç 
        @Composable
        fun ProductList(products: List&lt;Product&gt;) {
            var selectedId by remember { mutableStateOf(-1) }
            
            LazyColumn {
                products.forEach { product -&gt;
                    ProductCard(
                        product = product,
                        isSelected = product.id == selectedId,
                        onClick = { selectedId = product.id }  // Lambda æ•è·äº† product å’Œ selectedId
                    )
                }
            }
        }
        
        // è½¬æ¢åï¼šç¼–è¯‘å™¨ç”Ÿæˆçš„ä»£ç ï¼ˆç®€åŒ–ç‰ˆï¼‰
        @Composable
        fun ProductList(
            products: List&lt;Product&gt;,
            $composer: Composer,
            $changed: Int
        ) {
            var selectedId by remember { mutableStateOf(-1) }
            
            LazyColumn(
                $composer = $composer,
                $changed = 0,
                content = {
                    products.forEach { product -&gt;
                        // ç¼–è¯‘å™¨ä¸ºæ¯ä¸ª Lambda ç”Ÿæˆ remember åŒ…è£…
                        val rememberedOnClick = $composer.remember(
                            product,      // ä¾èµ–ï¼šproduct å˜åŒ–æ—¶æ›´æ–°
                            selectedId    // ä¾èµ–ï¼šselectedId å˜åŒ–æ—¶æ›´æ–°
                        ) {
                            { selectedId = product.id }  // Lambda ä½“
                        }
                        
                        ProductCard(
                            product = product,
                            isSelected = product.id == selectedId,
                            onClick = rememberedOnClick,  // ä½¿ç”¨è®°å¿†åŒ–çš„ Lambda
                            $composer = $composer,
                            $changed = 0  // ç°åœ¨å¯ä»¥è·³è¿‡äº†ï¼
                        )
                    }
                }
            )
        }
        </code></pre>
        <pre><code>
        Lambda è®°å¿†åŒ–æµç¨‹
        
        åŸå§‹ Lambda
            â”‚
            â”œâ”€â†’ æ£€æŸ¥æ˜¯å¦æ•è·å˜é‡
            â”‚
            â”œâ”€â†’ æ˜¯ â†’ ç”Ÿæˆ remember åŒ…è£…
            â”‚       â”‚
            â”‚       â”œâ”€ è¿½è¸ªæ•è·çš„å˜é‡
            â”‚       â”œâ”€ å˜é‡å˜åŒ–æ—¶æ›´æ–° Lambda
            â”‚       â””â”€ è¿”å› ComposableLambda
            â”‚
            â””â”€â†’ å¦ â†’ ä¼˜åŒ–ä¸ºå•ä¾‹ï¼ˆå¦‚æœå¯èƒ½ï¼‰
                    â”‚
                    â””â”€ ç›´æ¥å¤ç”¨ï¼Œæ— éœ€è®°å¿†åŒ–
        </code></pre>
        <div class="callout callout-warning">
        <p class="callout-title">æ³¨æ„äº‹é¡¹</p>
        <p>âš ï¸</p>
        <p>è™½ç„¶ç¼–è¯‘å™¨ä¼šè‡ªåŠ¨è®°å¿†åŒ– Lambdaï¼Œä½†è¦æ³¨æ„ï¼š</p>
        <p>- è®°å¿†åŒ–ä¼šå¢åŠ å†…å­˜å¼€é”€ï¼ˆæ¯ä¸ª Lambda éƒ½éœ€è¦å­˜å‚¨ï¼‰</p>
        <p>- æ•è·çš„å˜é‡å˜åŒ–æ—¶ï¼ŒLambda ä¼šè¢«é‡æ–°åˆ›å»º</p>
        <p>- åœ¨åˆ—è¡¨ç­‰é«˜é¢‘åœºæ™¯ä¸­ï¼Œè€ƒè™‘ä½¿ç”¨ <code>key</code> æ¥ä¼˜åŒ–</p>
        </div>
        <div class="callout callout">
        <p class="callout-title">æ·±å…¥é˜…è¯»</p>
        <p>ğŸ“š</p>
        <p>- <a href="https://developer.android.com/jetpack/compose/performance/lambda-memoization" target="_blank">Lambda Memoization - Android Developers</a></p>
        <p>- <a href="https://cs.android.com/androidx/platform/frameworks/support/+/androidx-main:compose/runtime/runtime/src/commonMain/kotlin/androidx/compose/runtime/ComposableLambda.kt" target="_blank">ComposableLambda.kt - Compose Runtime</a></p>
        </div>
        <h3 id="vi-strong-skipping-mode-æ·±åº¦è§£æ">VI. Strong Skipping Mode æ·±åº¦è§£æ</h3>
        <p>Strong Skipping Mode æ˜¯ Compose 1.5.4+ å¼•å…¥çš„é‡å¤§ä¼˜åŒ–ï¼Œå®ƒæ”¾å®½äº†è·³è¿‡ä¼˜åŒ–çš„æ¡ä»¶ï¼Œå…è®¸å¯¹ä¸ç¨³å®šç±»å‹ä¹Ÿè¿›è¡Œè·³è¿‡ä¼˜åŒ–ã€‚ç†è§£è¿™ä¸ªæ¨¡å¼çš„å·¥ä½œåŸç†ï¼Œå¯¹äºå……åˆ†åˆ©ç”¨ Compose çš„æ€§èƒ½ä¼˜åŒ–è‡³å…³é‡è¦ã€‚</p>
        <h4>6.1 ä¼ ç»Ÿæ¨¡å¼çš„å±€é™æ€§</h4>
        <p>åœ¨ä¼ ç»Ÿæ¨¡å¼ä¸‹ï¼Œåªæœ‰å½“æ‰€æœ‰å‚æ•°ç±»å‹éƒ½ç¨³å®šæ—¶ï¼ŒComposable å‡½æ•°æ‰èƒ½è¢«è·³è¿‡ã€‚è¿™å¯¼è‡´äº†è®¸å¤šå®é™…åœºæ™¯ä¸­æ— æ³•äº«å—è·³è¿‡ä¼˜åŒ–çš„å¥½å¤„ã€‚</p>
        <h5>ä¸ç¨³å®šå‚æ•°å¯¼è‡´æ— æ³•è·³è¿‡</h5>
        <p>åœ¨ä¼ ç»Ÿæ¨¡å¼ä¸‹ï¼Œåªè¦æœ‰ä¸€ä¸ªå‚æ•°ä¸ç¨³å®šï¼Œæ•´ä¸ªå‡½æ•°å°±æ— æ³•è·³è¿‡ï¼š</p>
        <pre><code>
        // ä¼ ç»Ÿæ¨¡å¼ä¸‹çš„é—®é¢˜
        @Composable
        fun UserProfile(
            user: User,              // ç¨³å®š
            onEdit: () -&gt; Unit         // ä¸ç¨³å®šï¼ˆLambdaï¼‰
        ) {
            Column {
                Text(user.name)
                Button(onClick = onEdit) {
                    Text("Edit")
                }
            }
        }
        
        // ä¼ ç»Ÿæ¨¡å¼ï¼šå³ä½¿ user æ²¡å˜ï¼ŒonEdit æ˜¯æ–° Lambda å®ä¾‹ï¼Œæ— æ³•è·³è¿‡
        UserProfile(
            user = sameUser,        // ç›¸åŒå®ä¾‹
            onEdit = { edit() }  // æ–° Lambda å®ä¾‹ â†’ æ— æ³•è·³è¿‡
        )
        </code></pre>
        <h5>Lambda å‚æ•°çš„æ€§èƒ½é—®é¢˜</h5>
        <p>Lambda å‚æ•°æ˜¯æœ€å¸¸è§çš„ä¸ç¨³å®šç±»å‹ã€‚åœ¨ä¼ ç»Ÿæ¨¡å¼ä¸‹ï¼Œå³ä½¿ Lambda çš„é€»è¾‘å®Œå…¨ç›¸åŒï¼Œç”±äºæ˜¯æ–°å®ä¾‹ï¼Œä¹Ÿä¼šå¯¼è‡´æ— æ³•è·³è¿‡ï¼š</p>
        <pre><code>
        // æ¯æ¬¡é‡ç»„éƒ½åˆ›å»ºæ–°çš„ Lambda
        @Composable
        fun MyScreen() {
            var count by remember { mutableStateOf(0) }
            
            // æ¯æ¬¡é‡ç»„ï¼Œè¿™ä¸ª Lambda éƒ½æ˜¯æ–°å®ä¾‹
            Counter(
                count = count,
                onIncrement = { count++ }  // æ–°å®ä¾‹ â†’ Counter æ— æ³•è·³è¿‡
            )
        }
        </code></pre>
        <div class="callout callout-warning">
        <p class="callout-title">ä¼ ç»Ÿæ¨¡å¼çš„é™åˆ¶</p>
        <p>âš ï¸</p>
        <p>åœ¨ä¼ ç»Ÿæ¨¡å¼ä¸‹ï¼Œå³ä½¿ä½ ä½¿ç”¨äº† <code>remember</code> æ¥è®°å¿†åŒ– Lambdaï¼Œå¦‚æœæ¥æ”¶ Lambda çš„ Composable å‡½æ•°æœ¬èº«æ— æ³•è·³è¿‡ï¼ˆå› ä¸ºå…¶ä»–ä¸ç¨³å®šå‚æ•°ï¼‰ï¼Œä»ç„¶ä¼šå¯¼è‡´æ€§èƒ½é—®é¢˜ã€‚</p>
        </div>
        <h4>6.2 Strong Skipping çš„æ ¸å¿ƒæ”¹è¿›</h4>
        <p>Strong Skipping Mode é€šè¿‡æ”¾å®½è·³è¿‡æ¡ä»¶ï¼Œè§£å†³äº†ä¼ ç»Ÿæ¨¡å¼çš„å±€é™æ€§ã€‚</p>
        <h5>å¯¹ä¸ç¨³å®šç±»å‹ä½¿ç”¨å®ä¾‹ç›¸ç­‰æ€§</h5>
        <p>åœ¨ Strong Skipping æ¨¡å¼ä¸‹ï¼Œå¯¹äºä¸ç¨³å®šç±»å‹ï¼Œç¼–è¯‘å™¨ä½¿ç”¨å®ä¾‹ç›¸ç­‰æ€§ï¼ˆ<code>===</code>ï¼‰è€Œä¸æ˜¯å€¼ç›¸ç­‰æ€§æ¥åˆ¤æ–­å‚æ•°æ˜¯å¦å˜åŒ–ï¼š</p>
        <pre><code>
        // Strong Skipping æ¨¡å¼ä¸‹çš„æ¯”è¾ƒé€»è¾‘
        fun calculateChanged(
            oldUser: User,
            newUser: User,
            oldCallback: () -&gt; Unit,
            newCallback: () -&gt; Unit
        ): Int {
            var changed = 0
            
            // ç¨³å®šç±»å‹ï¼šä½¿ç”¨å€¼æ¯”è¾ƒ
            if (oldUser != newUser) {  // equals()
                changed = changed or 0b00000001
            }
            
            // ä¸ç¨³å®šç±»å‹ï¼šä½¿ç”¨å®ä¾‹æ¯”è¾ƒï¼ˆStrong Skippingï¼‰
            if (oldCallback !== newCallback) {  // ===
                changed = changed or 0b00000010
            }
            
            return changed
        }
        </code></pre>
        <p>è¿™æ„å‘³ç€ï¼Œå¦‚æœ Lambda å®ä¾‹ç›¸åŒï¼ˆå³ä½¿ç±»å‹ä¸ç¨³å®šï¼‰ï¼Œå‡½æ•°ä»ç„¶å¯ä»¥è¢«è·³è¿‡ã€‚</p>
        <h5>Lambda çš„è‡ªåŠ¨è®°å¿†åŒ–</h5>
        <p>åœ¨ Strong Skipping æ¨¡å¼ä¸‹ï¼Œç¼–è¯‘å™¨ä¼šè‡ªåŠ¨ä¸º Lambda å‚æ•°ç”Ÿæˆè®°å¿†åŒ–ä»£ç ï¼Œå³ä½¿æ¥æ”¶ Lambda çš„å‡½æ•°æœ¬èº«ä¸æ˜¯å®Œå…¨ Skippable çš„ï¼š</p>
        <pre><code>
        // Strong Skipping æ¨¡å¼ï¼šè‡ªåŠ¨è®°å¿†åŒ– Lambda
        @Composable
        fun MyScreen() {
            var count by remember { mutableStateOf(0) }
            
            // ç¼–è¯‘å™¨è‡ªåŠ¨è®°å¿†åŒ–è¿™ä¸ª Lambda
            val rememberedOnIncrement = remember { { count++ } }
            
            Counter(
                count = count,
                onIncrement = rememberedOnIncrement  // å®ä¾‹ä¸å˜ â†’ å¯ä»¥è·³è¿‡
            )
        }
        </code></pre>
        <h5>é»˜è®¤å¯ç”¨ä¸å‘åå…¼å®¹</h5>
        <p>ä» Compose 1.5.4 å¼€å§‹ï¼ŒStrong Skipping Mode é»˜è®¤å¯ç”¨ã€‚å®ƒå®Œå…¨å‘åå…¼å®¹ï¼Œä¸ä¼šç ´åç°æœ‰ä»£ç ï¼š</p>
        <ul>
        <li>ç¨³å®šç±»å‹çš„è¡Œä¸ºä¿æŒä¸å˜ï¼ˆä»ç„¶ä½¿ç”¨å€¼æ¯”è¾ƒï¼‰</li>
        <li>ä¸ç¨³å®šç±»å‹çš„è¡Œä¸ºæ”¹å˜ï¼ˆä½¿ç”¨å®ä¾‹æ¯”è¾ƒï¼‰ï¼Œä½†è¿™æ˜¯æ€§èƒ½ä¼˜åŒ–ï¼Œä¸ä¼šå½±å“æ­£ç¡®æ€§</li>
        <li>å¦‚æœç¡®å®éœ€è¦ä¼ ç»Ÿè¡Œä¸ºï¼Œå¯ä»¥é€šè¿‡ç¼–è¯‘å™¨é€‰é¡¹ç¦ç”¨</li>
        </ul>
        <div class="callout callout-info">
        <p class="callout-title">ä¸ºä»€ä¹ˆé»˜è®¤å¯ç”¨ï¼Ÿ</p>
        <p>ğŸ’¡</p>
        <p>Strong Skipping Mode æ˜¯ä¸€ä¸ªçº¯æ€§èƒ½ä¼˜åŒ–ï¼Œä¸ä¼šæ”¹å˜ç¨‹åºçš„è¯­ä¹‰ã€‚å®ƒåªæ˜¯è®©æ›´å¤šçš„å‡½æ•°å¯ä»¥äº«å—è·³è¿‡ä¼˜åŒ–ï¼Œä»è€Œæå‡æ€§èƒ½ã€‚å› æ­¤ï¼Œé»˜è®¤å¯ç”¨æ˜¯å®‰å…¨çš„ï¼Œä¸”èƒ½å¸¦æ¥æ˜¾è‘—çš„æ€§èƒ½æå‡ã€‚</p>
        </div>
        <h4>6.3 å®ç°ç»†èŠ‚</h4>
        <p>Strong Skipping Mode çš„å®ç°æ¶‰åŠç¼–è¯‘å™¨ä»£ç ç”Ÿæˆé€»è¾‘çš„ä¿®æ”¹ã€‚</p>
        <h5>æ¯”è¾ƒé€»è¾‘çš„å˜åŒ–</h5>
        <p>åœ¨ Strong Skipping æ¨¡å¼ä¸‹ï¼Œç¼–è¯‘å™¨ç”Ÿæˆçš„æ¯”è¾ƒä»£ç ä¼šåŒºåˆ†ç¨³å®šå’Œä¸ç¨³å®šç±»å‹ï¼š</p>
        <pre><code>
        // ä¼ ç»Ÿæ¨¡å¼ï¼šæ‰€æœ‰å‚æ•°éƒ½ä½¿ç”¨å€¼æ¯”è¾ƒï¼ˆå¦‚æœç¨³å®šï¼‰
        if (oldParam != newParam) {  // åªå¯¹ç¨³å®šç±»å‹æœ‰æ•ˆ
            changed = changed or mask
        }
        
        // Strong Skipping æ¨¡å¼ï¼šä¸ç¨³å®šç±»å‹ä½¿ç”¨å®ä¾‹æ¯”è¾ƒ
        if (paramType.isStable()) {
            if (oldParam != newParam) {  // å€¼æ¯”è¾ƒ
                changed = changed or mask
            }
        } else {
            if (oldParam !== newParam) {  // å®ä¾‹æ¯”è¾ƒ
                changed = changed or mask
            }
        }
        </code></pre>
        <h5>å¯¹ $changed å‚æ•°çš„å½±å“</h5>
        <p>åœ¨ Strong Skipping æ¨¡å¼ä¸‹ï¼Œ<code>$changed</code> ä½æ©ç çš„ç”Ÿæˆé€»è¾‘ä¿æŒä¸å˜ï¼Œä½†è§£é‡Šæ–¹å¼ä¸åŒï¼š</p>
        <ul>
        <li>å¯¹äºç¨³å®šç±»å‹ï¼š<code>$changed</code> è¡¨ç¤ºå€¼æ˜¯å¦å˜åŒ–</li>
        <li>å¯¹äºä¸ç¨³å®šç±»å‹ï¼š<code>$changed</code> è¡¨ç¤ºå®ä¾‹æ˜¯å¦å˜åŒ–ï¼ˆå¼•ç”¨æ˜¯å¦ç›¸åŒï¼‰</li>
        </ul>
        <pre><code>
        // $changed ä½æ©ç çš„ä½¿ç”¨ï¼ˆStrong Skippingï¼‰
        val stableChanged = $changed and $stable  // ç¨³å®šå‚æ•°çš„å˜åŒ–
        val unstableChanged = $changed and inv($stable)  // ä¸ç¨³å®šå‚æ•°çš„å˜åŒ–
        
        // è·³è¿‡é€»è¾‘ï¼šæ‰€æœ‰å‚æ•°ï¼ˆç¨³å®š+ä¸ç¨³å®šï¼‰éƒ½æ²¡å˜åŒ–
        if ($changed == 0 &amp;&amp; $composer.skipping) {
            $composer.skipToGroupEnd()
        }
        </code></pre>
        <h5>ä¸ä¼ ç»Ÿæ¨¡å¼çš„å·®å¼‚</h5>
        <tr><th>ç‰¹æ€§</th><th>ä¼ ç»Ÿæ¨¡å¼</th><th>Strong Skipping Mode</th></tr>
        <tr><td><strong>è·³è¿‡æ¡ä»¶</strong></td><td>æ‰€æœ‰å‚æ•°å¿…é¡»ç¨³å®šä¸”æœªå˜åŒ–</td><td>æ‰€æœ‰å‚æ•°ï¼ˆç¨³å®šæˆ–ä¸ç¨³å®šï¼‰å®ä¾‹æœªå˜åŒ–</td></tr>
        <tr><td><strong>ä¸ç¨³å®šç±»å‹æ¯”è¾ƒ</strong></td><td>ä¸æ¯”è¾ƒï¼Œç›´æ¥è®¤ä¸ºå˜åŒ–</td><td>ä½¿ç”¨å®ä¾‹ç›¸ç­‰æ€§ï¼ˆ===ï¼‰</td></tr>
        <tr><td><strong>Lambda å¤„ç†</strong></td><td>éœ€è¦æ‰‹åŠ¨ remember</td><td>è‡ªåŠ¨è®°å¿†åŒ–</td></tr>
        <tr><td><strong>æ€§èƒ½</strong></td><td>è¾ƒä½ï¼ˆå¾ˆå¤šå‡½æ•°æ— æ³•è·³è¿‡ï¼‰</td><td>è¾ƒé«˜ï¼ˆæ›´å¤šå‡½æ•°å¯ä»¥è·³è¿‡ï¼‰</td></tr>
        <tr><td><strong>å‘åå…¼å®¹</strong></td><td>N/A</td><td>å®Œå…¨å…¼å®¹</td></tr>
        <h4>6.4 å¯ç”¨æ–¹å¼ä¸æ³¨æ„äº‹é¡¹</h4>
        <p>Strong Skipping Mode åœ¨ Compose 1.5.4+ ä¸­é»˜è®¤å¯ç”¨ï¼Œä½†ä½ å¯ä»¥é€šè¿‡ç¼–è¯‘å™¨é€‰é¡¹æ§åˆ¶ã€‚</p>
        <h5>å¯ç”¨æ–¹å¼</h5>
        <p>åœ¨ Compose 1.5.4+ ä¸­ï¼ŒStrong Skipping Mode é»˜è®¤å¯ç”¨ï¼Œæ— éœ€é¢å¤–é…ç½®ï¼š</p>
        <pre><code>
        // build.gradle.kts
        android {
            composeOptions {
                compilerExtensionVersion = "1.5.4"  // æˆ–æ›´é«˜ç‰ˆæœ¬
            }
        }
        
        // Strong Skipping Mode é»˜è®¤å¯ç”¨ï¼Œæ— éœ€é…ç½®
        </code></pre>
        <p>å¦‚æœéœ€è¦æ˜¾å¼æ§åˆ¶ï¼Œå¯ä»¥ä½¿ç”¨ç¼–è¯‘å™¨é€‰é¡¹ï¼š</p>
        <pre><code>
        // build.gradle.ktsï¼ˆæ˜¾å¼å¯ç”¨ï¼‰
        composeCompiler {
            enableStrongSkippingMode = true  // é»˜è®¤ true
        }
        
        // å¦‚æœéœ€è¦ç¦ç”¨ï¼ˆä¸æ¨èï¼‰
        composeCompiler {
            enableStrongSkippingMode = false  // å›é€€åˆ°ä¼ ç»Ÿæ¨¡å¼
        }
        </code></pre>
        <h5>æ³¨æ„äº‹é¡¹</h5>
        <p>è™½ç„¶ Strong Skipping Mode æ˜¯å‘åå…¼å®¹çš„ï¼Œä½†éœ€è¦æ³¨æ„ä»¥ä¸‹å‡ ç‚¹ï¼š</p>
        <ol>
        <li><strong>å®ä¾‹ç›¸ç­‰æ€§å‡è®¾</strong>ï¼šStrong Skipping å‡è®¾ç›¸åŒå®ä¾‹è¡¨ç¤ºç›¸åŒå€¼ã€‚å¦‚æœä½ çš„ä»£ç ä¾èµ–å€¼ç›¸ç­‰æ€§ä½†å®ä¾‹ä¸åŒï¼Œå¯èƒ½ä¼šæœ‰é—®é¢˜ï¼ˆä½†è¿™ç§æƒ…å†µå¾ˆå°‘è§ï¼‰</li>
        <li><strong>Lambda è®°å¿†åŒ–</strong>ï¼šç¼–è¯‘å™¨ä¼šè‡ªåŠ¨è®°å¿†åŒ– Lambdaï¼Œä½†å¦‚æœä½ æ‰‹åŠ¨è®°å¿†åŒ–ï¼Œè¡Œä¸ºæ˜¯ä¸€è‡´çš„</li>
        <li><strong>æ€§èƒ½ç›‘æ§</strong>ï¼šä½¿ç”¨ç¼–è¯‘å™¨æŠ¥å‘Šæ¥éªŒè¯ Strong Skipping æ˜¯å¦ç”Ÿæ•ˆ</li>
        </ol>
        <div class="callout callout-success">
        <p class="callout-title">æœ€ä½³å®è·µ</p>
        <p>âœ…</p>
        <p>åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œä½ åº”è¯¥ä½¿ç”¨ Strong Skipping Modeï¼ˆé»˜è®¤å¯ç”¨ï¼‰ã€‚å®ƒæä¾›äº†æ›´å¥½çš„æ€§èƒ½ï¼Œä¸”ä¸ä¼šå½±å“ä»£ç çš„æ­£ç¡®æ€§ã€‚åªæœ‰åœ¨ç‰¹æ®Šæƒ…å†µä¸‹ï¼ˆå¦‚éœ€è¦ç²¾ç¡®æ§åˆ¶è·³è¿‡è¡Œä¸ºï¼‰ï¼Œæ‰è€ƒè™‘ç¦ç”¨ã€‚</p>
        </div>
        <h5>éªŒè¯ Strong Skipping æ˜¯å¦ç”Ÿæ•ˆ</h5>
        <p>å¯ä»¥é€šè¿‡ç¼–è¯‘å™¨æŠ¥å‘Šæ¥éªŒè¯ Strong Skipping Mode æ˜¯å¦ç”Ÿæ•ˆï¼š</p>
        <pre><code>
        // composables.txt ä¸­ä¼šæ˜¾ç¤ºæ˜¯å¦å¯ç”¨äº† Strong Skipping
        restartable skippable scheme("[androidx.compose.ui.UiComposable]") fun Example(
          stable name: String
          unstable callback: Function0&lt;kotlin.Unit&gt;
        )
          Strong Skipping: enabled  // æ˜¾ç¤ºæ˜¯å¦å¯ç”¨
          Skippable: true           // å³ä½¿æœ‰ä¸ç¨³å®šå‚æ•°ï¼Œä¹Ÿå¯ä»¥è·³è¿‡
        </code></pre>
        <pre><code>
        Strong Skipping Mode å·¥ä½œæµç¨‹
        
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  @Composable å‡½æ•°   â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚ æ£€æŸ¥å‚æ•°ç±»å‹         â”‚
        â”‚ â€¢ ç¨³å®šï¼Ÿ             â”‚
        â”‚ â€¢ ä¸ç¨³å®šï¼Ÿ           â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”œâ”€â†’ ç¨³å®š â†’ ä½¿ç”¨å€¼æ¯”è¾ƒ (==)
                   â”‚
                   â””â”€â†’ ä¸ç¨³å®š â†’ ä½¿ç”¨å®ä¾‹æ¯”è¾ƒ (===)
                              â”‚
                              â–¼
                   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                   â”‚ ç”Ÿæˆæ¯”è¾ƒä»£ç          â”‚
                   â”‚ â€¢ ç¨³å®šï¼šold != new   â”‚
                   â”‚ â€¢ ä¸ç¨³å®šï¼šold !== new â”‚
                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â–¼
                   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                   â”‚ æ‰€æœ‰å‚æ•°å®ä¾‹ç›¸åŒï¼Ÿ   â”‚
                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”œâ”€â†’ æ˜¯ â†’ è·³è¿‡æ‰§è¡Œ
                              â”‚
                              â””â”€â†’ å¦ â†’ æ‰§è¡Œå‡½æ•°ä½“
        </code></pre>
        <div class="callout callout">
        <p class="callout-title">æ·±å…¥é˜…è¯»</p>
        <p>ğŸ“š</p>
        <p>- <a href="https://developer.android.com/jetpack/compose/performance/strong-skipping" target="_blank">Strong Skipping Mode - Android Developers</a></p>
        <p>- <a href="https://android-developers.googleblog.com/2024/01/whats-new-in-jetpack-compose-performance.html" target="_blank">What's New in Jetpack Compose Performance - Android Developers Blog</a></p>
        </div>
        <h3 id="vii-ç¼–è¯‘å™¨æŠ¥å‘Šä¸è°ƒè¯•">VII. ç¼–è¯‘å™¨æŠ¥å‘Šä¸è°ƒè¯•</h3>
        <p>Compose Compiler æä¾›äº†ä¸°å¯Œçš„æŠ¥å‘Šå’Œè°ƒè¯•å·¥å…·ï¼Œå¸®åŠ©ä½ è¯Šæ–­æ€§èƒ½é—®é¢˜ã€ç†è§£ç¼–è¯‘å™¨è¡Œä¸ºï¼Œå¹¶ä¼˜åŒ–ä»£ç ã€‚æŒæ¡è¿™äº›å·¥å…·çš„ä½¿ç”¨ï¼Œæ˜¯æˆä¸º Compose æ€§èƒ½ä¼˜åŒ–ä¸“å®¶çš„å…³é”®ã€‚</p>
        <h4>7.1 Compose Compiler Metrics</h4>
        <p>Compose Compiler å¯ä»¥ç”Ÿæˆè¯¦ç»†çš„æŒ‡æ ‡æŠ¥å‘Šï¼ŒåŒ…æ‹¬æ¯ä¸ª Composable å‡½æ•°çš„ç¨³å®šæ€§ã€å¯è·³è¿‡æ€§ç­‰ä¿¡æ¯ã€‚</p>
        <h5>å¯ç”¨æŠ¥å‘Šç”Ÿæˆ</h5>
        <p>åœ¨ <code>build.gradle.kts</code> ä¸­é…ç½®ç¼–è¯‘å™¨é€‰é¡¹ï¼š</p>
        <pre><code>
        // build.gradle.kts
        android {
            composeOptions {
                compilerExtensionVersion = "1.5.4"
            }
        }
        
        composeCompiler {
            // å¯ç”¨æŠ¥å‘Šç”Ÿæˆ
            reportsDestination = layout.buildDirectory.dir("compose_reports")
            metricsDestination = layout.buildDirectory.dir("compose_metrics")
            
            // å¯é€‰ï¼šå¯ç”¨è¯¦ç»†æŠ¥å‘Š
            includeSourceInformation = true
        }
        </code></pre>
        <p>ç¼–è¯‘åï¼ŒæŠ¥å‘Šæ–‡ä»¶ä¼šç”Ÿæˆåœ¨ <code>build/compose_reports/</code> å’Œ <code>build/compose_metrics/</code> ç›®å½•ä¸‹ã€‚</p>
        <h5>composables.txt è§£è¯»</h5>
        <p><code>composables.txt</code> æ–‡ä»¶åŒ…å«äº†æ¯ä¸ª <code>@Composable</code> å‡½æ•°çš„è¯¦ç»†ä¿¡æ¯ï¼š</p>
        <pre><code>
        // composables.txt ç¤ºä¾‹
        restartable skippable scheme("[androidx.compose.ui.UiComposable]") fun UserProfile(
          stable user: User
          unstable onEdit: Function0&lt;kotlin.Unit&gt;
          stable count: Int
        )
          Nested classes = []
          Nested parameters = []
          Unstable parameters = [onEdit]
          Stable parameters = [user, count]
          Skippable: true
          Restartable: true
          Strong Skipping: enabled
          Source location: UserProfile.kt:15:5
        </code></pre>
        <p>å…³é”®å­—æ®µè§£è¯»ï¼š</p>
        <ul>
        <li><strong>restartable</strong>ï¼šå‡½æ•°å¯ä»¥è¢«é‡æ–°è°ƒç”¨ï¼ˆé‡ç»„ï¼‰</li>
        <li><strong>skippable</strong>ï¼šå‡½æ•°å¯ä»¥è¢«è·³è¿‡ï¼ˆå¦‚æœå‚æ•°æ²¡å˜åŒ–ï¼‰</li>
        <li><strong>stable/unstable parameters</strong>ï¼šåˆ—å‡ºç¨³å®šå’Œä¸ç¨³å®šçš„å‚æ•°</li>
        <li><strong>Strong Skipping</strong>ï¼šæ˜¯å¦å¯ç”¨äº† Strong Skipping Mode</li>
        <li><strong>Source location</strong>ï¼šæºç ä½ç½®ï¼ˆå¦‚æœå¯ç”¨äº† <code>includeSourceInformation</code>ï¼‰</li>
        </ul>
        <h5>classes.txt è§£è¯»</h5>
        <p><code>classes.txt</code> æ–‡ä»¶åŒ…å«äº†ç±»å‹ç¨³å®šæ€§ä¿¡æ¯ï¼š</p>
        <pre><code>
        // classes.txt ç¤ºä¾‹
        stable class User {
          stable name: String
          stable age: Int
          stable constructor(name: String, age: Int)
        }
        
        unstable class MutableUser {
          unstable name: String
          unstable age: Int
          unstable constructor(name: String, age: Int)
        }
        
        unstable interface ClickListener {
          unstable onClick: Function0&lt;kotlin.Unit&gt;
        }
        </code></pre>
        <p>è¿™ä¸ªæ–‡ä»¶å¸®åŠ©ä½ ç†è§£å“ªäº›ç±»å‹æ˜¯ç¨³å®šçš„ï¼Œå“ªäº›ä¸æ˜¯ï¼Œä»¥åŠä¸ºä»€ä¹ˆã€‚</p>
        <h5>ç¨³å®šæ€§æŠ¥å‘Šåˆ†æ</h5>
        <p>é€šè¿‡åˆ†ææŠ¥å‘Šï¼Œä½ å¯ä»¥ï¼š</p>
        <ol>
        <li><strong>è¯†åˆ«ä¸ç¨³å®šç±»å‹</strong>ï¼šæ‰¾å‡ºå“ªäº›ç±»å‹å¯¼è‡´å‡½æ•°æ— æ³•è·³è¿‡</li>
        <li><strong>ä¼˜åŒ–ç¨³å®šæ€§</strong>ï¼šä¸ºéœ€è¦ç¨³å®šçš„ç±»å‹æ·»åŠ  <code>@Stable</code> æˆ– <code>@Immutable</code> æ³¨è§£</li>
        <li><strong>éªŒè¯ä¼˜åŒ–æ•ˆæœ</strong>ï¼šåœ¨ä¼˜åŒ–åé‡æ–°ç”ŸæˆæŠ¥å‘Šï¼Œç¡®è®¤æ”¹è¿›</li>
        </ol>
        <div class="callout callout-info">
        <p class="callout-title">æŠ¥å‘Šåˆ†ææŠ€å·§</p>
        <p>ğŸ’¡</p>
        <p>é‡ç‚¹å…³æ³¨ï¼š</p>
        <p>- é«˜é¢‘è°ƒç”¨çš„ Composable å‡½æ•°ï¼ˆå¦‚åˆ—è¡¨é¡¹ï¼‰</p>
        <p>- åŒ…å«ä¸ç¨³å®šå‚æ•°çš„å‡½æ•°</p>
        <p>- æ ‡è®°ä¸ºä¸å¯è·³è¿‡çš„å‡½æ•°ï¼ˆ<code>Skippable: false</code>ï¼‰</p>
        </div>
        <h4>7.2 å¸¸è§é—®é¢˜è¯Šæ–­</h4>
        <p>åœ¨å®é™…å¼€å‘ä¸­ï¼Œç»å¸¸ä¼šé‡åˆ°æ€§èƒ½é—®é¢˜ã€‚ä»¥ä¸‹æ˜¯å¸¸è§é—®é¢˜çš„è¯Šæ–­å’Œè§£å†³æ–¹æ³•ã€‚</p>
        <h5>ä¸ºä»€ä¹ˆæˆ‘çš„ Composable ä¸èƒ½è·³è¿‡ï¼Ÿ</h5>
        <p>å¦‚æœ Composable å‡½æ•°æ— æ³•è·³è¿‡ï¼Œå¯èƒ½çš„åŸå› åŒ…æ‹¬ï¼š</p>
        <ol>
        <li><strong>å‚æ•°ä¸ç¨³å®š</strong>ï¼šæ£€æŸ¥ <code>composables.txt</code>ï¼ŒæŸ¥çœ‹å“ªäº›å‚æ•°è¢«æ ‡è®°ä¸ºä¸ç¨³å®š</li>
        <li><strong>æœªå¯ç”¨ Strong Skipping</strong>ï¼šç¡®è®¤ Compose Compiler ç‰ˆæœ¬ >= 1.5.4ï¼Œä¸”æœªç¦ç”¨ Strong Skipping</li>
        <li><strong>å‡½æ•°ä½“å†…è¯»å–çŠ¶æ€</strong>ï¼šå³ä½¿å‚æ•°æ²¡å˜åŒ–ï¼Œå¦‚æœå‡½æ•°ä½“å†…è¯»å–çš„çŠ¶æ€å˜åŒ–ï¼Œä»ç„¶ä¼šé‡ç»„</li>
        </ol>
        <pre><code>
        // é—®é¢˜ç¤ºä¾‹ï¼šå‚æ•°ä¸ç¨³å®š
        @Composable
        fun Problematic(data: MutableList&lt;String&gt;) {  // MutableList ä¸ç¨³å®š
            Text(data.joinToString())
        }
        
        // è§£å†³æ–¹æ¡ˆï¼šä½¿ç”¨ä¸å¯å˜ç±»å‹
        @Composable
        fun Fixed(data: List&lt;String&gt;) {  // List ç¨³å®š
            Text(data.joinToString())
        }
        </code></pre>
        <h5>å¦‚ä½•å®šä½ä¸ç¨³å®šçš„ç±»å‹ï¼Ÿ</h5>
        <p>ä½¿ç”¨ä»¥ä¸‹æ­¥éª¤å®šä½ä¸ç¨³å®šç±»å‹ï¼š</p>
        <ol>
        <li><strong>æŸ¥çœ‹ composables.txt</strong>ï¼šæ‰¾å‡ºå“ªäº›å‚æ•°è¢«æ ‡è®°ä¸ºä¸ç¨³å®š</li>
        <li><strong>æŸ¥çœ‹ classes.txt</strong>ï¼šæ£€æŸ¥è¿™äº›å‚æ•°çš„ç±»å‹å®šä¹‰</li>
        <li><strong>åˆ†æç±»å‹ç»“æ„</strong>ï¼šæ‰¾å‡ºå¯¼è‡´ä¸ç¨³å®šçš„åŸå› ï¼ˆvar å±æ€§ã€å¯å˜é›†åˆç­‰ï¼‰</li>
        <li><strong>åº”ç”¨ä¿®å¤</strong>ï¼šæ·»åŠ æ³¨è§£æˆ–ä¿®æ”¹ç±»å‹å®šä¹‰</li>
        </ol>
        <pre><code>
        // æ­¥éª¤ 1: æŸ¥çœ‹ composables.txt
        // å‘ç° onAction å‚æ•°ä¸ç¨³å®š
        unstable onAction: Function0&lt;kotlin.Unit&gt;
        
        // æ­¥éª¤ 2: æŸ¥çœ‹ classes.txt
        // å‘ç° Function0 æ¥å£é»˜è®¤ä¸ç¨³å®š
        unstable interface Function0&lt;R&gt;
        
        // æ­¥éª¤ 3: è§£å†³æ–¹æ¡ˆï¼ˆåœ¨ Strong Skipping æ¨¡å¼ä¸‹è‡ªåŠ¨å¤„ç†ï¼‰
        // æˆ–ä½¿ç”¨ remember æ‰‹åŠ¨è®°å¿†åŒ–
        val rememberedOnAction = remember { onAction }
        </code></pre>
        <h5>Lambda å¯¼è‡´é‡ç»„çš„æ’æŸ¥</h5>
        <p>Lambda å‚æ•°æ˜¯æœ€å¸¸è§çš„å¯¼è‡´æ— æ³•è·³è¿‡çš„åŸå› ã€‚æ’æŸ¥æ­¥éª¤ï¼š</p>
        <ol>
        <li><strong>ç¡®è®¤ Lambda æ˜¯å¦è¢«è®°å¿†åŒ–</strong>ï¼šæ£€æŸ¥ç¼–è¯‘å™¨æ˜¯å¦è‡ªåŠ¨è®°å¿†åŒ–ï¼Œæˆ–æ‰‹åŠ¨ä½¿ç”¨ <code>remember</code></li>
        <li><strong>æ£€æŸ¥ Lambda çš„ä¾èµ–</strong>ï¼šå¦‚æœ Lambda æ•è·äº†å¤–éƒ¨å˜é‡ï¼Œç¡®ä¿è¿™äº›å˜é‡è¢«æ­£ç¡®è¿½è¸ª</li>
        <li><strong>ä½¿ç”¨ rememberUpdatedState</strong>ï¼šå¯¹äºéœ€è¦é•¿æœŸå­˜åœ¨çš„ Lambdaï¼Œè€ƒè™‘ä½¿ç”¨ <code>rememberUpdatedState</code></li>
        </ol>
        <pre><code>
        // é—®é¢˜ï¼šLambda æ¯æ¬¡éƒ½æ˜¯æ–°å®ä¾‹
        @Composable
        fun MyScreen() {
            var count by remember { mutableStateOf(0) }
            
            // æ¯æ¬¡é‡ç»„éƒ½åˆ›å»ºæ–° Lambda
            Counter(onIncrement = { count++ })
        }
        
        // è§£å†³æ–¹æ¡ˆ 1: æ‰‹åŠ¨è®°å¿†åŒ–ï¼ˆä¼ ç»Ÿæ¨¡å¼ï¼‰
        @Composable
        fun MyScreen() {
            var count by remember { mutableStateOf(0) }
            
            val onIncrement = remember { { count++ } }
            Counter(onIncrement = onIncrement)
        }
        
        // è§£å†³æ–¹æ¡ˆ 2: Strong Skipping æ¨¡å¼è‡ªåŠ¨å¤„ç†ï¼ˆæ¨èï¼‰
        // åœ¨ Compose 1.5.4+ ä¸­ï¼Œç¼–è¯‘å™¨ä¼šè‡ªåŠ¨è®°å¿†åŒ–
        </code></pre>
        <h5>ä½¿ç”¨ Layout Inspector è°ƒè¯•</h5>
        <p>Android Studio çš„ Layout Inspector å¯ä»¥æ˜¾ç¤º Recomposition è®¡æ•°ï¼Œå¸®åŠ©ä½ æ‰¾åˆ°é¢‘ç¹é‡ç»„çš„ç»„ä»¶ï¼š</p>
        <ol>
        <li>è¿è¡Œåº”ç”¨å¹¶è¿æ¥åˆ°è®¾å¤‡/æ¨¡æ‹Ÿå™¨</li>
        <li>æ‰“å¼€ Layout Inspectorï¼ˆTools â†’ Layout Inspectorï¼‰</li>
        <li>é€‰æ‹© Compose è§†å›¾</li>
        <li>æŸ¥çœ‹ Recomposition è®¡æ•°åˆ—</li>
        </ol>
        <div class="callout callout-success">
        <p class="callout-title">è°ƒè¯•å·¥ä½œæµ</p>
        <p>âœ…</p>
        <p>æ¨èçš„è°ƒè¯•æµç¨‹ï¼š</p>
        <p>1. ä½¿ç”¨ Layout Inspector æ‰¾å‡ºé¢‘ç¹é‡ç»„çš„ç»„ä»¶</p>
        <p>2. æŸ¥çœ‹ç¼–è¯‘å™¨æŠ¥å‘Šï¼Œåˆ†æä¸ºä»€ä¹ˆæ— æ³•è·³è¿‡</p>
        <p>3. åº”ç”¨ä¼˜åŒ–ï¼ˆæ·»åŠ æ³¨è§£ã€ä¿®æ”¹ç±»å‹ç­‰ï¼‰</p>
        <p>4. é‡æ–°ç”ŸæˆæŠ¥å‘Šï¼ŒéªŒè¯ä¼˜åŒ–æ•ˆæœ</p>
        <p>5. ä½¿ç”¨ Layout Inspector ç¡®è®¤é‡ç»„æ¬¡æ•°å‡å°‘</p>
        </div>
        <h5>æ€§èƒ½åˆ†æå·¥å…·</h5>
        <p>é™¤äº†ç¼–è¯‘å™¨æŠ¥å‘Šï¼Œè¿˜å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å·¥å…·ï¼š</p>
        <ul>
        <li><strong>Android Studio Profiler</strong>ï¼šåˆ†æ CPU ä½¿ç”¨å’Œé‡ç»„æ€§èƒ½</li>
        <li><strong>Compose Recomposition è®¡æ•°å™¨</strong>ï¼šåœ¨ä»£ç ä¸­æ·»åŠ è®¡æ•°å™¨ï¼Œè¿½è¸ªé‡ç»„æ¬¡æ•°</li>
        <li><strong>Compose æ€§èƒ½ç›‘æ§åº“</strong>ï¼šä½¿ç”¨ç¬¬ä¸‰æ–¹åº“æ¥ç›‘æ§å’ŒæŠ¥å‘Šæ€§èƒ½æŒ‡æ ‡</li>
        </ul>
        <pre><code>
        // æ·»åŠ é‡ç»„è®¡æ•°å™¨ï¼ˆè°ƒè¯•ç”¨ï¼‰
        @Composable
        fun TrackedComponent(content: @Composable () -&gt; Unit) {
            val recompositionCount = remember { mutableStateOf(0) }
            recompositionCount.value++
            
            // åœ¨ Logcat ä¸­è¾“å‡ºé‡ç»„æ¬¡æ•°
            SideEffect {
                Log.d("Recomposition", "Count: ${recompositionCount.value}")
            }
            
            content()
        }
        </code></pre>
        <div class="callout callout">
        <p class="callout-title">æ·±å…¥é˜…è¯»</p>
        <p>ğŸ“š</p>
        <p>- <a href="https://developer.android.com/jetpack/compose/performance/debugging" target="_blank">Debug Compose Performance - Android Developers</a></p>
        <p>- <a href="https://developer.android.com/jetpack/compose/performance/investigate-recomposition" target="_blank">Investigate Recomposition - Android Developers</a></p>
        </div>
        <h3 id="viii-æ€»ç»“ä¸æœ€ä½³å®è·µ">VIII. æ€»ç»“ä¸æœ€ä½³å®è·µ</h3>
        <p>é€šè¿‡æœ¬æ–‡ï¼Œæˆ‘ä»¬æ·±å…¥æ¢ç´¢äº† Compose Compiler çš„å†…éƒ¨æœºåˆ¶ã€‚ç°åœ¨è®©æˆ‘ä»¬æ€»ç»“æ ¸å¿ƒåŸç†ï¼Œå¹¶æä¾›å®ç”¨çš„æœ€ä½³å®è·µæŒ‡å—ã€‚</p>
        <h4>æ ¸å¿ƒåŸç†å›é¡¾</h4>
        <p>Compose Compiler çš„æ ¸å¿ƒå·¥ä½œæµç¨‹å¯ä»¥æ€»ç»“ä¸ºä»¥ä¸‹å‡ ä¸ªå…³é”®æ­¥éª¤ï¼š</p>
        <pre><code>
        Compose Compiler æ ¸å¿ƒæµç¨‹
        
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  1. IR è½¬æ¢                              â”‚
        â”‚  â€¢ æ³¨å…¥ $composer å’Œ $changed å‚æ•°      â”‚
        â”‚  â€¢ æ·»åŠ  startRestartGroup/endRestartGroup â”‚
        â”‚  â€¢ ç”Ÿæˆ Group Key                        â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  2. ç¨³å®šæ€§æ¨æ–­                            â”‚
        â”‚  â€¢ åˆ†æç±»å‹ç»“æ„                          â”‚
        â”‚  â€¢ ç”Ÿæˆ $stable ä½æ©ç                   â”‚
        â”‚  â€¢ æ ‡è®°ç¨³å®š/ä¸ç¨³å®šå‚æ•°                   â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  3. è·³è¿‡é€»è¾‘ç”Ÿæˆ                          â”‚
        â”‚  â€¢ æ£€æŸ¥å‚æ•°å˜åŒ–ï¼ˆ$changed ä½æ©ç ï¼‰       â”‚
        â”‚  â€¢ ç”Ÿæˆè·³è¿‡ä»£ç                          â”‚
        â”‚  â€¢ æ”¯æŒ Strong Skipping Mode            â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  4. Lambda å¤„ç†                          â”‚
        â”‚  â€¢ è‡ªåŠ¨è®°å¿†åŒ– Lambda                    â”‚
        â”‚  â€¢ è¿½è¸ªæ•è·å˜é‡                         â”‚
        â”‚  â€¢ ä¼˜åŒ– Non-capturing Lambda            â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  5. ä»£ç ç”Ÿæˆ                              â”‚
        â”‚  â€¢ ç”Ÿæˆå­—èŠ‚ç                            â”‚
        â”‚  â€¢ è¿è¡Œæ—¶ä¼˜åŒ–                           â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        </code></pre>
        <h4>æ€§èƒ½ä¼˜åŒ– Checklist</h4>
        <p>ä½¿ç”¨ä»¥ä¸‹æ¸…å•æ¥ç¡®ä¿ä½ çš„ Compose ä»£ç è¾¾åˆ°æœ€ä½³æ€§èƒ½ï¼š</p>
        <h5>ç±»å‹ç¨³å®šæ€§</h5>
        <ul>
        <li>[ ] ä¸ºä¸å¯å˜æ•°æ®ç±»æ·»åŠ  <code>@Stable</code> æˆ– <code>@Immutable</code> æ³¨è§£</li>
        <li>[ ] ä½¿ç”¨ä¸å¯å˜é›†åˆï¼ˆ<code>List</code> è€Œé <code>MutableList</code>ï¼‰</li>
        <li>[ ] é¿å…åœ¨ç¨³å®šç±»å‹ä¸­ä½¿ç”¨ <code>var</code> å±æ€§</li>
        </ul>
        <h5>å‚æ•°è®¾è®¡</h5>
        <ul>
        <li>[ ] å°½å¯èƒ½ä½¿ç”¨ç¨³å®šç±»å‹ä½œä¸ºå‚æ•°</li>
        <li>[ ] å°†å¤æ‚å¯¹è±¡æ‹†åˆ†ä¸ºåŸºæœ¬ç±»å‹å‚æ•°ï¼ˆå¦‚æœå¯èƒ½ï¼‰</li>
        <li>[ ] é¿å…ä¼ é€’ä¸ç¨³å®šçš„å®¹å™¨ç±»å‹</li>
        </ul>
        <h5>Lambda ä¼˜åŒ–</h5>
        <ul>
        <li>[ ] å¯ç”¨ Strong Skipping Modeï¼ˆCompose 1.5.4+ é»˜è®¤å¯ç”¨ï¼‰</li>
        <li>[ ] å¯¹äºé•¿æœŸå­˜åœ¨çš„ Lambdaï¼Œä½¿ç”¨ <code>rememberUpdatedState</code></li>
        <li>[ ] é¿å…åœ¨ Lambda ä¸­æ•è·é¢‘ç¹å˜åŒ–çš„å€¼</li>
        </ul>
        <h5>çŠ¶æ€ç®¡ç†</h5>
        <ul>
        <li>[ ] ä½¿ç”¨ <code>remember</code> ç¼“å­˜è®¡ç®—ç»“æœ</li>
        <li>[ ] å°†çŠ¶æ€æå‡åˆ°åˆé€‚çš„å±‚çº§</li>
        <li>[ ] ä½¿ç”¨ <code>derivedStateOf</code> æ´¾ç”ŸçŠ¶æ€</li>
        </ul>
        <h5>åˆ—è¡¨ä¼˜åŒ–</h5>
        <ul>
        <li>[ ] ä½¿ç”¨ <code>key</code> ä¸ºåˆ—è¡¨é¡¹æä¾›ç¨³å®šæ ‡è¯†</li>
        <li>[ ] ä½¿ç”¨ <code>LazyColumn</code>/<code>LazyRow</code> è¿›è¡Œè™šæ‹ŸåŒ–</li>
        <li>[ ] é¿å…åœ¨åˆ—è¡¨é¡¹ä¸­ä½¿ç”¨ä¸ç¨³å®šçš„å‚æ•°</li>
        </ul>
        <h5>è°ƒè¯•å’Œç›‘æ§</h5>
        <ul>
        <li>[ ] å®šæœŸæŸ¥çœ‹ç¼–è¯‘å™¨æŠ¥å‘Šï¼ˆcomposables.txt, classes.txtï¼‰</li>
        <li>[ ] ä½¿ç”¨ Layout Inspector ç›‘æ§é‡ç»„æ¬¡æ•°</li>
        <li>[ ] ä½¿ç”¨ Profiler åˆ†ææ€§èƒ½ç“¶é¢ˆ</li>
        </ul>
        <h4>å¸¸è§é™·é˜±ä¸è§£å†³æ–¹æ¡ˆ</h4>
        <tr><th>å¸¸è§é™·é˜±</th><th>é—®é¢˜</th><th>è§£å†³æ–¹æ¡ˆ</th></tr>
        <tr><td><strong>å¯å˜é›†åˆä½œä¸ºå‚æ•°</strong></td><td>MutableList ç­‰ç±»å‹ä¸ç¨³å®šï¼Œå¯¼è‡´æ— æ³•è·³è¿‡</td><td>ä½¿ç”¨ä¸å¯å˜é›†åˆï¼ˆListï¼‰æˆ–æ·»åŠ  @Stable æ³¨è§£</td></tr>
        <tr><td><strong>Lambda æ¯æ¬¡éƒ½æ˜¯æ–°å®ä¾‹</strong></td><td>å¯¼è‡´æ¥æ”¶ Lambda çš„å‡½æ•°æ— æ³•è·³è¿‡</td><td>å¯ç”¨ Strong Skipping Mode æˆ–æ‰‹åŠ¨ remember</td></tr>
        <tr><td><strong>æ¡ä»¶è¯­å¥ä¸­çš„ Composable</strong></td><td>ä½ç½®å˜åŒ–å¯¼è‡´çŠ¶æ€é”™ä¹±</td><td>ä½¿ç”¨ key æ˜ç¡®æ ‡è¯†ï¼Œæˆ–æå–åˆ°ç‹¬ç«‹å‡½æ•°</td></tr>
        <tr><td><strong>å¿˜è®°ä½¿ç”¨ remember</strong></td><td>æ¯æ¬¡é‡ç»„éƒ½é‡æ–°è®¡ç®—ï¼Œæ€§èƒ½å·®</td><td>å¯¹è®¡ç®—ç»“æœä½¿ç”¨ remember ç¼“å­˜</td></tr>
        <tr><td><strong>ä¸ç¨³å®šçš„æ•°æ®ç±»</strong></td><td>åŒ…å« var å±æ€§æˆ–å¯å˜é›†åˆ</td><td>æ”¹ä¸º val å±æ€§ï¼Œä½¿ç”¨ä¸å¯å˜é›†åˆï¼Œæ·»åŠ  @Stable</td></tr>
        <h4>æ€§èƒ½ä¼˜åŒ–ç¤ºä¾‹</h4>
        <p>è®©æˆ‘ä»¬çœ‹ä¸€ä¸ªå®Œæ•´çš„ä¼˜åŒ–ç¤ºä¾‹ï¼š</p>
        <pre><code>
        // âŒ ä¼˜åŒ–å‰ï¼šæ€§èƒ½é—®é¢˜
        @Composable
        fun ProductList(products: MutableList&lt;Product&gt;) {  // ä¸ç¨³å®š
            LazyColumn {
                products.forEach { product -&gt;
                    // æ²¡æœ‰ keyï¼Œä½ç½®è®°å¿†åŒ–å¯èƒ½å‡ºé”™
                    ProductCard(
                        product = product,
                        onClick = { select(product) }  // æ–° Lambda å®ä¾‹
                    )
                }
            }
        }
        
        class Product {
            var name: String = ""  // var å¯¼è‡´ä¸ç¨³å®š
            var price: Double = 0.0
        }
        
        // âœ… ä¼˜åŒ–åï¼šé«˜æ€§èƒ½
        @Stable  // æ·»åŠ æ³¨è§£
        data class Product(
            val name: String,      // val å±æ€§
            val price: Double,
            val id: Long
        )
        
        @Composable
        fun ProductList(products: List&lt;Product&gt;) {  // ä¸å¯å˜é›†åˆ
            LazyColumn {
                products.forEach { product -&gt;
                    key(product.id) {  // ä½¿ç”¨ key
                        // Strong Skipping Mode è‡ªåŠ¨è®°å¿†åŒ– Lambda
                        ProductCard(
                            product = product,
                            onClick = { select(product) }
                        )
                    }
                }
            }
        }
        </code></pre>
        <h4>æ¨èé˜…è¯»èµ„æº</h4>
        <h5>å®˜æ–¹æ–‡æ¡£</h5>
        <ul>
        <li><a href="https://developer.android.com/jetpack/compose/performance" target="_blank">Compose Performance - Android Developers</a></li>
        <li><a href="https://developer.android.com/jetpack/compose/mental-model" target="_blank">Thinking in Compose - Android Developers</a></li>
        <li><a href="https://developer.android.com/jetpack/compose/performance/stability" target="_blank">Compose Stability - Android Developers</a></li>
        </ul>
        <h5>æºç å‚è€ƒ</h5>
        <ul>
        <li><a href="https://cs.android.com/androidx/platform/frameworks/support/+/androidx-main:compose/compiler/" target="_blank">Compose Compiler Source Code</a></li>
        <li><a href="https://cs.android.com/androidx/platform/frameworks/support/+/androidx-main:compose/runtime/" target="_blank">Compose Runtime Source Code</a></li>
        </ul>
        <h5>æ·±åº¦æ–‡ç« </h5>
        <ul>
        <li><a href="https://jorgecastillo.dev/book/" target="_blank">Jetpack Compose Internals - Jorge Castillo</a></li>
        <li><a href="https://medium.com/androiddevelopers/under-the-hood-of-jetpack-compose-part-2-of-2-37b2c20c852" target="_blank">Under the hood of Jetpack Compose - Android Developers Blog</a></li>
        </ul>
        <h4>æ€»ç»“</h4>
        <p>é€šè¿‡æœ¬æ–‡ï¼Œæˆ‘ä»¬æ·±å…¥ç†è§£äº† Compose Compiler çš„å·¥ä½œåŸç†ï¼š</p>
        <ul>
        <li><strong>IR è½¬æ¢</strong>ï¼šç¼–è¯‘å™¨åœ¨ IR å±‚é¢è½¬æ¢ä»£ç ï¼Œæ³¨å…¥å¿…è¦çš„å‚æ•°å’Œé€»è¾‘</li>
        <li><strong>ç¨³å®šæ€§æ¨æ–­</strong>ï¼šç¼–è¯‘å™¨åˆ†æç±»å‹ç»“æ„ï¼Œæ¨æ–­ç¨³å®šæ€§ï¼Œç”Ÿæˆä½æ©ç </li>
        <li><strong>è·³è¿‡ä¼˜åŒ–</strong>ï¼šåŸºäºå‚æ•°å˜åŒ–æ£€æµ‹ï¼Œæ™ºèƒ½è·³è¿‡ä¸å¿…è¦çš„é‡ç»„</li>
        <li><strong>Lambda è®°å¿†åŒ–</strong>ï¼šè‡ªåŠ¨å¤„ç† Lambda å‚æ•°ï¼Œé¿å…ä¸å¿…è¦çš„é‡ç»„</li>
        <li><strong>Strong Skipping Mode</strong>ï¼šæ”¾å®½è·³è¿‡æ¡ä»¶ï¼Œæå‡æ€§èƒ½</li>
        </ul>
        <p>ç†è§£è¿™äº›åº•å±‚æœºåˆ¶ï¼Œä¸ä»…èƒ½å¸®åŠ©ä½ å†™å‡ºæ›´é«˜æ•ˆçš„ Compose ä»£ç ï¼Œè¿˜èƒ½åœ¨é‡åˆ°æ€§èƒ½é—®é¢˜æ—¶å¿«é€Ÿå®šä½å’Œè§£å†³ã€‚è®°ä½ï¼š</p>
        <div class="callout callout-success">
        <p class="callout-title">å…³é”®è¦ç‚¹</p>
        <p>âœ…</p>
        <p>- ç¨³å®šæ€§æ˜¯æ€§èƒ½ä¼˜åŒ–çš„åŸºç¡€ï¼šç¡®ä¿å…³é”®è·¯å¾„ä¸Šçš„ç±»å‹ç¨³å®š</p>
        <p>- åˆ©ç”¨ç¼–è¯‘å™¨æŠ¥å‘Šï¼šå®šæœŸæ£€æŸ¥ï¼ŒæŒç»­ä¼˜åŒ–</p>
        <p>- å¯ç”¨ Strong Skipping Modeï¼šäº«å—æ›´å¥½çš„æ€§èƒ½ï¼ˆé»˜è®¤å¯ç”¨ï¼‰</p>
        <p>- éµå¾ªæœ€ä½³å®è·µï¼šä½¿ç”¨ä¸å¯å˜ç±»å‹ã€rememberã€key ç­‰</p>
        </div>
        <p>å¸Œæœ›æœ¬æ–‡èƒ½å¸®åŠ©ä½ æ·±å…¥ç†è§£ Compose Compilerï¼Œå†™å‡ºæ›´é«˜æ•ˆã€æ›´ä¼˜é›…çš„ Compose ä»£ç ï¼</p>
        
        <div class="reference">
            <div class="reference-title">ğŸ“š å®˜æ–¹å‚è€ƒ</div>
            <a href="https://developer.android.com/jetpack/compose/mental-model" target="_blank">Thinking in Compose - Android Developers</a><br>
            <a href="https://cs.android.com/androidx/platform/frameworks/support/+/androidx-main:compose/compiler/compiler-hosted/" target="_blank">Compose Compiler Source Code</a>
        </div>
    </article>

    <footer class="footer">
        <p>&copy; 2024 Fidroid. <a href="../index.html">è¿”å›é¦–é¡µ</a></p>
    </footer>
</body>
</html>
